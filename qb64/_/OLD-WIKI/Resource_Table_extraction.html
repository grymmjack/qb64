
<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from www.qb64.org/wiki/Resource_Table_extraction by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 07 Aug 2021 12:44:03 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>Resource Table extraction - QB64 Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":!1,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"YOWkV1pP-65vp3So6Lul2gAAANY","wgCSPNonce":!1,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Resource_Table_extraction","wgTitle":"Resource Table extraction","wgCurRevisionId":17958,"wgRevisionId":17958,"wgArticleId":599,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Resource_Table_extraction","wgRelevantArticleId":599,"wgIsProbablyEditable":!1,"wgRelevantPageIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[]};RLSTATE={"site.styles":"ready","noscript"
:"ready","user.styles":"ready","user":"ready","user.options":"loading","skins.vector.styles.legacy":"ready","mediawiki.toc.styles":"ready"};RLPAGEMODULES=["site","mediawiki.page.startup","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.js"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@1hzgi",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});});</script>
<link rel="stylesheet" href="loadd8b0.css?lang=en&amp;modules=mediawiki.toc.styles%7Cskins.vector.styles.legacy&amp;only=styles&amp;skin=vector"/>
<script async="" src="load52c0.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="generator" content="MediaWiki 1.35.2"/>
<link rel="shortcut icon" href="https://www.qb64.org/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="QB64 Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api-result251f.xml?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="QB64 Wiki Atom feed" href="feeda295.xml?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/wiki/resources/lib/html5shiv/html5shiv.js"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Resource_Table_extraction rootpage-Resource_Table_extraction skin-vector action-view skin-vector-legacy">
<div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Resource Table extraction</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From QB64 Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p>The following information was supplied by Michael Calkins in a member's request to find a way to extract icons from EXE files. There is no warranty implied and users should use the information and code at their own risk! We are not responsible for any damages!
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#COFF_Specifications"><span class="tocnumber">1</span> <span class="toctext">COFF Specifications</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Revision_2"><span class="tocnumber">2</span> <span class="toctext">Revision 2</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Revision_3"><span class="tocnumber">3</span> <span class="toctext">Revision 3</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Extract_Icon"><span class="tocnumber">4</span> <span class="toctext">Extract Icon</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Extract_Resources"><span class="tocnumber">5</span> <span class="toctext">Extract Resources</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#References"><span class="tocnumber">6</span> <span class="toctext">References</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="COFF_Specifications">COFF Specifications</span></h2>
<p>There are 3 layers to the resource tables, Type, Name, and Language, The Microsoft PE and COFF specifications can be found here: 
</p>
<center><a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/windows/hardware/gg463119">http://msdn.microsoft.com/en-us/windows/hardware/gg463119</a></center>
<p><br />
</p>
<center><b>Image Extraction Procedure</b></center>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> nam <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> * 8
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> fil <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> k <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ul <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> coff <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> SectionTable <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ImageBase <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> rsrc <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> pe32plus <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> SizeOfOptionalHeader <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> NumberOfSections <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> NumberOfRvaAndSizes <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

<a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a>
<a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "Name of the PE image to open? "; fil
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="FILEEXISTS.html" title="FILEEXISTS"><span style="color:#87cefa;">_FILEEXISTS</span></a>(fil) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "File not found.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a> fil <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> <a href="BINARY-2.html" class="mw-redirect" title="BINARY"><span style="color:#87cefa;">BINARY</span></a> <a href="ACCESS.html" class="mw-redirect" title="ACCESS"><span style="color:#87cefa;">ACCESS</span></a> <a href="READ.html" title="READ"><span style="color:#87cefa;">READ</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> 1
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + 0, w
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> w &lt;&gt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5A4D <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No MZ signature.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>3C, dw
coff = dw + 4
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, dw + 1, dw
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw &lt;&gt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4550&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No PE signature.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 2, NumberOfSections
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> NumberOfSections = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No sections.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "NumberOfSections:"; NumberOfSections
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> secsva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> secsfp(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 16, SizeOfOptionalHeader
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> SizeOfOptionalHeader = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No optional header.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "SizeOfOptionalHeader:", <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(4); word$(SizeOfOptionalHeader)
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20, w
<a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> w
 <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10B: pe32plus = 0: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "PE32"
 <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20B: pe32plus = -1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "PE32+"
 <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Unknown Magic.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 28 + (-4 <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> pe32plus), ImageBase
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ImageBase:", "", dword$(ImageBase)
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 92 + (16 <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> pe32plus), NumberOfRvaAndSizes
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> NumberOfRvaAndSizes &lt; 3 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No resource table.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "NumberOfRvaAndSizes:"; NumberOfRvaAndSizes
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 112 + (16 <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> pe32plus), rsrc
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Rva of resource table:", dword$(rsrc)
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 4 + 112 + (16 <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> pe32plus), dw
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Size of resource table:", dword$(dw)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (rsrc = 0) <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> (dw = 0) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No resource table.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
SectionTable = coff + 20 + SizeOfOptionalHeader
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "section", "va", "file ptr"
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> w = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + SectionTable + (40 * w), nam
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + SectionTable + 12 + (40 * w), ul
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + SectionTable + 20 + (40 * w), dw
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> nam, dword$(ul), dword$(dw)
 secsva(w) = ul
 secsfp(w) = dw
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Proceed? ";
DO
 k = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> k = "n" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> k: <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> k = "y"
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> k
processtable rva2fp(rsrc), rva2fp(rsrc), 0
<a href="SYSTEM.html" title="SYSTEM"><span style="color:#87cefa;">SYSTEM</span></a>

<a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> processtable (bs <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, addr <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, level <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> k <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numnamest8 <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dat <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> siz <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> so <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> sc <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numnames <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numids <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ln <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> x <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> y <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> b <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>

<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 12, numnames
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 14, numids
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> nams(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numnames + (numnames &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> namsrva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numnames + (numnames &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ids(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids + (numids &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> idsrva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids + (numids &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

'get named entries
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numnames - 1
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + (x * 8), dw
 dw = rva2fp(dw)
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + dw, ln
 <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> y = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> ln - 1
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , w
  <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> w
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7E: nams(x) = nams(x) + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(w)
   <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: nams(x) = nams(x) + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1A)
  <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> y = 68 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
 <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + 4 + (x * 8), namsrva(x)
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>

'get numbered entries:
numnamest8 = numnames * 8
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids - 1
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + numnamest8 + (x * 8), ids(x)
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + 4 + numnamest8 + (x * 8), idsrva(x)
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>

'display:
<a href="VIEW_PRINT.html" title="VIEW PRINT"><span style="color:#87cefa;">VIEW PRINT</span></a>
DO
 <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a> 0 'qb64 bug? not locating to 1,1?
 <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 1, 1
 <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> level
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 0: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "1st level - Type";
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "2nd level - Name";
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 2: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "3rd level - Language";
  <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="LTRIM%24.html" title="LTRIM$"><span style="color:#87cefa;">LTRIM$</span></a>(<a href="STR%24.html" title="STR$"><span style="color:#87cefa;">STR$</span></a>(level)) + "th level";
 <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "", "file ptr: "; dword$(addr); ". Press 'D' to dump."
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> numnames; "names in this level, in this branch."
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> numids; "IDs in this level, in this branch."
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (numnames <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> numids) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> level <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
   <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press any key to go up one level."
   <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>: <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
   <a href="EXIT_SUB.html" title="EXIT SUB"><span style="color:#87cefa;">EXIT SUB</span></a>
  <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
   <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
 <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "names are unicode. For simplicity, non ASCII chars will be shown as " + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1A) + "."
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> level <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "BKSP or ESC to go up one level."
 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "BKSP or ESC to exit."
 <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "UP, DOWN, PGUP, PGDN, HOME, <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> to navigate list."
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ENTER to select."
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(80, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>C4);
 <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 22, 1
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(80, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>C4);
 sc = 0
 so = 0
 DO
  <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
  <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 8, 1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(sc)
  <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> 11
   <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 10 + x, 1
   <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> x + so = sc <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 15, 1 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
   <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (x + so) &lt; numnames <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> nams(x + so); <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(70 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(nams(x + so)));
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(bs + (namsrva(x + so) <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF&amp;));
    <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
    <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 7, 18
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> namsrva(x + so) <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(descend)";
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(extract)";
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="ELSEIF.html" title="ELSEIF"><span style="color:#87cefa;">ELSEIF</span></a> (x + so) &lt; (numnames + numids) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ID: " + dword$(ids(x + so - numnames)); <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(56);
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(bs + (idsrva(x + so - numnames)));
    <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
    <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 7, 18
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> idsrva(x + (so - numnames)) <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(descend)";
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(extract)";
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(80);
   <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
  DO
   k = <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>
  <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(k)
  <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> k
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> "d", "D"
    dump addr
    <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4800) 'up
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &gt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     sc = sc - 1
     <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; so <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = sc
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5000) 'down
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; (numnames + numids - 1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     sc = sc + 1
     <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &gt; (so + 11) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
      so = sc - 11
      <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &gt; sc <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0 'unsigned
     <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4700) 'home
    sc = 0
    so = 0
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4F00) 'end
    sc = numnames + numids - 1
    so = sc - 11
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4900) 'pgup
    sc = sc - 12
    so = so - 12
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> sc = 0
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5100) 'pgdn
    sc = sc + 12
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &gt; (numnames + numids - 1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> sc = numnames + numids - 1
    so = sc - 11
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>8), <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1B) 'bksp, esc
    <a href="EXIT_SUB.html" title="EXIT SUB"><span style="color:#87cefa;">EXIT SUB</span></a>
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>D) 'enter
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; numnames <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     dw = namsrva(sc)
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     dw = idsrva(sc - numnames)
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     'the spec says its an rfa, but it seems to be an offset in the section/table
     processtable bs, bs + (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF&amp;), level + 1
     <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     'the spec says its an rfa, but it seems to be an offset in the section/table
     dw = bs + dw
     <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + dw, dat
     <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + 4 + dw, siz
     <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 24, 1
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(siz) + " bytes.";
     <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 23, 1
     <a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "(leave blank to cancel) Output file? "; k
     <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(k) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
      <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="FILEEXISTS.html" title="FILEEXISTS"><span style="color:#87cefa;">_FILEEXISTS</span></a>(k) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
       <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
       <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "File already exists.";
      <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
       <a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a> k <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> <a href="BINARY-2.html" class="mw-redirect" title="BINARY"><span style="color:#87cefa;">BINARY</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> 2
       <a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> 1, 1 + rva2fp(dat)
       <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = 1 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> siz
        <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , b
        <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> 2, , b
       <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
       <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> 2
       <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
       <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Done.";
      <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
      <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>: <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
     <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
     <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
 <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="END_SUB.html" class="mw-redirect" title="END SUB"><span style="color:#87cefa;">END SUB</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> word$ (w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(w))
word = "0x" + <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(4 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> dword$ (dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(dw))
dword = "0x" + <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(8 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> rva2fp~&amp; (rva <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> w = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> rva &lt; secsva(w) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
w = w - 1
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> w &gt; NumberOfSections - 1 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(rva), w: <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>
rva2fp = rva + (secsfp(w) - secsva(w))
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> dump (addr <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ul <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> b <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>

<a href="VIEW_PRINT.html" title="VIEW PRINT"><span style="color:#87cefa;">VIEW PRINT</span></a>
ul = addr
DO
 <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
 <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a> 0
 <a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> 1, 1 + ul
 <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = ul <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> (ul <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>FFFFFFF0) + <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>15F
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (1 + ul) &gt; <a href="LOF.html" title="LOF"><span style="color:#87cefa;">LOF</span></a>(1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , b
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
   t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(dw))
   <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7
   <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(8 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t; <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(2);
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 3 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 2
  <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> , 14 + ((dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F) * 3)
  t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(b))
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> b &lt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "0" + t; <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> t;
  <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> , 65 + (dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F)
  <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> b
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 7, 9 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>D, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1F: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> ".";
   <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(b);
  <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
 <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
 <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7
 <a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "(leave blank to cancel) Address: 0x"; t
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="LTRIM%24.html" title="LTRIM$"><span style="color:#87cefa;">LTRIM$</span></a>(t) = "" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
 ul = <a href="VAL.html" title="VAL"><span style="color:#87cefa;">VAL</span></a>("&amp;h" + t + "&amp;") <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="END_SUB.html" class="mw-redirect" title="END SUB"><span style="color:#87cefa;">END SUB</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Public domain October 2011 by Michael Calkins based on the Microsoft PE and COFF spec, Revision 8.2 - September 21, 2010</span></center>
<p><br />
</p>
<dl><dd>If you open <i>c:\windows\system32\shell32.dll</i>, and save the first item (descend the first entry, then the first entry of the next level, etc), it's an .AVI file of a flashlight searching a folder. If you go down the first entry of the first level, but the last entry of the second level, it's an .AVI of a globe throwing a page at a folder. Save both files as AVI to view the video.</dd></dl>
<dl><dd>I wouldn't consider the program finished. There's some double checking, tweaking, and optimizing that could be done. For example, the dump sub could probably use an extra variable, and could probably use some increased functionality. I wrote it to help me debug the part that reads the resource tables. As I say in the comments, the part that gives the address of either the "leaf" or the next table lower seems to be relative to the start of the main table or section, not an actual RVA.</dd></dl>
<dl><dd>With things like:</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:10px; white-space: pre; font-family: courier; background-color: white; color: darkgreen;">                GET 1, 1 + coff + 20 + 28 + (-4 AND pe32plus), ImageBase </p>
<dl><dd>That could obviously be optimized by combining the 1 + 20 + 28. By leaving it uncombined, though, it documents itself better in terms of helping the human reader match it up with the specification. 1 because QBASIC's GET/PUT/SEEK idiotically starts at 1 instead of 0. Coff because we want an offset from the start of the coff header, 20 to skip the 20 byte coff main header, 28 because that's the offset of ImageBase in the optional header, and (-4 AND pe32plus) because the offset is 24 if the Magic is PE32+. Either QB64 or GCC will probably optimize it anyway, I would think.</dd></dl>
<dl><dd>In the Section table, the name of the field is VirtualAddress, but the description seems to say that it is an RVA. My program assumes that it is an RVA. The rva2fp function finds which section a given RVA is in, and then uses the difference between the RVA and the file pointer for that section to turn the given RVA into a file pointer.</dd></dl>
<dl><dd>Regards, Michael Calkins</dd></dl>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Revision_2">Revision 2</span></h2>
<dl><dd>I've made a few minor changes to the program. It will show you the first 400 bytes when you choose to export the data. Also, by moving the initialization of sc and so outside the loop, you will now come back to the correct entry upon ascending a level. I experimented with code to PSET the data, but it is commented out.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'october 2011, michael calkins
'my code is public domain, but it's based on Microsoft's spec, so I'm not sure
'what kind of patents or copyrights apply.
'based on the Microsoft PE and COFF spec, Revision 8.2 - September 21, 2010
'<a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/windows/hardware/gg463119.aspx">http://msdn.microsoft.com/en-us/windows/hardware/gg463119.aspx</a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> nam <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> * 8
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> fil <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> k <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ul <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> coff <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> SectionTable <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ImageBase <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> rsrc <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> pe32plus <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> SizeOfOptionalHeader <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> NumberOfSections <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> NumberOfRvaAndSizes <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

<a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a>
<a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "Name of the PE image to open? "; fil
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="FILEEXISTS.html" title="FILEEXISTS"><span style="color:#87cefa;">_FILEEXISTS</span></a>(fil) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "File not found.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a> fil <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> <a href="BINARY-2.html" class="mw-redirect" title="BINARY"><span style="color:#87cefa;">BINARY</span></a> <a href="ACCESS.html" class="mw-redirect" title="ACCESS"><span style="color:#87cefa;">ACCESS</span></a> <a href="READ.html" title="READ"><span style="color:#87cefa;">READ</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> 1
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + 0, w
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> w &lt;&gt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5A4D <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No MZ signature.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>3C, dw
coff = dw + 4
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, dw + 1, dw
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw &lt;&gt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4550&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No PE signature.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 2, NumberOfSections
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> NumberOfSections = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No sections.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "NumberOfSections:"; NumberOfSections
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> secsva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> secsfp(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 16, SizeOfOptionalHeader
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> SizeOfOptionalHeader = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No optional header.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "SizeOfOptionalHeader:", <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(4); word$(SizeOfOptionalHeader)
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20, w
<a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> w
 <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10B: pe32plus = 0: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "PE32"
 <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20B: pe32plus = -1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "PE32+"
 <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Unknown Magic.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 28 + (-4 <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> pe32plus), ImageBase
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ImageBase:", "", dword$(ImageBase)
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 92 + (16 <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> pe32plus), NumberOfRvaAndSizes
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> NumberOfRvaAndSizes &lt; 3 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No resource table.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "NumberOfRvaAndSizes:"; NumberOfRvaAndSizes
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 112 + (16 <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> pe32plus), rsrc
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Rva of resource table:", dword$(rsrc)
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 4 + 112 + (16 <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> pe32plus), dw
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Size of resource table:", dword$(dw)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (rsrc = 0) <a href="OR.html" title="OR"><span style="color:#87cefa;">OR</span></a> (dw = 0) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No resource table.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
SectionTable = coff + 20 + SizeOfOptionalHeader
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "section", "va", "file ptr"
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> w = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + SectionTable + (40 * w), nam
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + SectionTable + 12 + (40 * w), ul
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + SectionTable + 20 + (40 * w), dw
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> nam, dword$(ul), dword$(dw)
 secsva(w) = ul
 secsfp(w) = dw
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Proceed? ";
DO
 k = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> k = "n" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> k: <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> k = "y"
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> k
processtable rva2fp(rsrc), rva2fp(rsrc), 0
<a href="SYSTEM.html" title="SYSTEM"><span style="color:#87cefa;">SYSTEM</span></a>

<a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> processtable (bs <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, addr <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, level <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> k <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numnamest8 <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dat <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> siz <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> so <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> sc <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numnames <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numids <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ln <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> x <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> y <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> b <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>

<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 12, numnames
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 14, numids
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> nams(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numnames + (numnames &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> namsrva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numnames + (numnames &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ids(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids + (numids &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> idsrva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids + (numids &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

'get named entries
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numnames - 1
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + (x * 8), dw
 dw = rva2fp(dw)
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + dw, ln
 <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> y = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> ln - 1
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , w
  <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> w
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7E: nams(x) = nams(x) + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(w)
   <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: nams(x) = nams(x) + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1A)
  <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> y = 68 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
 <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + 4 + (x * 8), namsrva(x)
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>

'get numbered entries:
numnamest8 = numnames * 8
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids - 1
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + numnamest8 + (x * 8), ids(x)
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + 4 + numnamest8 + (x * 8), idsrva(x)
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>

'display:
<a href="VIEW_PRINT.html" title="VIEW PRINT"><span style="color:#87cefa;">VIEW PRINT</span></a>
sc = 0
so = 0
DO
 <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a> 0 'qb64 bug? not locating to 1,1?
 <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 1, 1
 <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> level
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 0: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "1st level - Type";
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "2nd level - Name";
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 2: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "3rd level - Language";
  <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="LTRIM%24.html" title="LTRIM$"><span style="color:#87cefa;">LTRIM$</span></a>(<a href="STR%24.html" title="STR$"><span style="color:#87cefa;">STR$</span></a>(level)) + "th level";
 <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "", "file ptr: "; dword$(addr); ". Press 'D' to dump."
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> numnames; "names in this level, in this branch."
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> numids; "IDs in this level, in this branch."
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (numnames <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> numids) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> level <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
   <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press any key to go up one level."
   <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>: <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
   <a href="EXIT_SUB.html" title="EXIT SUB"><span style="color:#87cefa;">EXIT SUB</span></a>
  <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
   <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
 <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "names are unicode. For simplicity, non ASCII chars will be shown as " + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1A) + "."
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> level <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "BKSP or ESC to go up one level."
 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "BKSP or ESC to exit."
 <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "UP, DOWN, PGUP, PGDN, HOME, <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> to navigate list."
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ENTER to select."
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(80, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>C4);
 <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 22, 1
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(80, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>C4);
 DO
  <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
  <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 8, 1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(sc)
  <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> 11
   <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 10 + x, 1
   <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> x + so = sc <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 15, 1 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
   <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (x + so) &lt; numnames <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> nams(x + so); <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(70 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(nams(x + so)));
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(bs + (namsrva(x + so) <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF&amp;));
    <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
    <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 7, 18
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> namsrva(x + so) <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(descend)";
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(extract)";
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="ELSEIF.html" title="ELSEIF"><span style="color:#87cefa;">ELSEIF</span></a> (x + so) &lt; (numnames + numids) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ID: " + dword$(ids(x + so - numnames)); <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(56);
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(bs + (idsrva(x + so - numnames)));
    <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
    <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 7, 18
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> idsrva(x + (so - numnames)) <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(descend)";
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(extract)";
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(80);
   <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
  DO
   k = <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>
  <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(k)
  <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> k
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> "d", "D"
    dump addr
    <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4800) 'up
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &gt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     sc = sc - 1
     <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; so <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = sc
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5000) 'down
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; (numnames + numids - 1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     sc = sc + 1
     <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &gt; (so + 11) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
      so = sc - 11
      <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &gt; sc <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0 'unsigned
     <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4700) 'home
    sc = 0
    so = 0
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4F00) 'end
    sc = numnames + numids - 1
    so = sc - 11
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4900) 'pgup
    sc = sc - 12
    so = so - 12
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> sc = 0
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5100) 'pgdn
    sc = sc + 12
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &gt; (numnames + numids - 1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> sc = numnames + numids - 1
    so = sc - 11
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>8), <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1B) 'bksp, esc
    <a href="EXIT_SUB.html" title="EXIT SUB"><span style="color:#87cefa;">EXIT SUB</span></a>
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>D) 'enter
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; numnames <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     dw = namsrva(sc)
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     dw = idsrva(sc - numnames)
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     'the spec says its an rva, but it seems to be an offset in the section/table
     processtable bs, bs + (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF&amp;), level + 1
     <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     'the spec says its an rva, but it seems to be an offset in the section/table
     dw = bs + dw
     <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + dw, dat
     <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + 4 + dw, siz
     <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a>
     <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 1, 1 'qb64 seems to default to line 2
     <a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> 1, 1 + rva2fp(dat)
     <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = 1 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> siz
      <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw &gt; 400 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
      <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , b
      <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> b
       <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 7, 9 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>D, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1F: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> ".";
       <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(b);
      <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
     <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
     <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 24, 1
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(siz) + " bytes.";
     <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 23, 1
     <a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "(leave blank to cancel) Output file? "; k

     '     <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> k = "v" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     '      <a href="INPUT.html" title="INPUT"><span style="color:#87cefa;">INPUT</span></a> "width in pixels"; w
     '      <a href="SCREEN.html" title="SCREEN"><span style="color:#87cefa;">SCREEN</span></a> 13
     '      <a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> 1, 1 + rva2fp(dat)
     '      <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = 1 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> siz
     '       <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw \ w &gt;= 200 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
     '       <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , b
     '      <a href="PSET.html" title="PSET"><span style="color:#87cefa;">PSET</span></a> (dw <a href="MOD.html" title="MOD"><span style="color:#87cefa;">MOD</span></a> w, dw \ w), b
     '      <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
     '      <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>: <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
     '      <a href="SCREEN.html" title="SCREEN"><span style="color:#87cefa;">SCREEN</span></a> 0
     '      <a href="WIDTH.html" title="WIDTH"><span style="color:#87cefa;">WIDTH</span></a> 80, 25
     '      <a href="VIEW_PRINT.html" title="VIEW PRINT"><span style="color:#87cefa;">VIEW PRINT</span></a>
     '      <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a>
     '     <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

     <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(k) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
      <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="FILEEXISTS.html" title="FILEEXISTS"><span style="color:#87cefa;">_FILEEXISTS</span></a>(k) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
       <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
       <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "File already exists.";
      <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
       <a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a> k <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> <a href="BINARY-2.html" class="mw-redirect" title="BINARY"><span style="color:#87cefa;">BINARY</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> 2
       <a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> 1, 1 + rva2fp(dat)
       <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = 1 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> siz
        <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , b
        <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> 2, , b
       <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
       <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> 2
       <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
       <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Done.";
      <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
      <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>: <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
     <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
     <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
 <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="END_SUB.html" class="mw-redirect" title="END SUB"><span style="color:#87cefa;">END SUB</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> word$ (w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(w))
word = "0x" + <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(4 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> dword$ (dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(dw))
dword = "0x" + <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(8 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> rva2fp~&amp; (rva <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> w = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> rva &lt; secsva(w) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
w = w - 1
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> w &gt; NumberOfSections - 1 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(rva), w: <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>
rva2fp = rva + (secsfp(w) - secsva(w))
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> dump (addr <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ul <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> b <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>

<a href="VIEW_PRINT.html" title="VIEW PRINT"><span style="color:#87cefa;">VIEW PRINT</span></a>
ul = addr
DO
 <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
 <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a> 0
 <a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> 1, 1 + ul
 <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = ul <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> (ul <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>FFFFFFF0) + <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>15F
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (1 + ul) &gt; <a href="LOF.html" title="LOF"><span style="color:#87cefa;">LOF</span></a>(1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , b
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
   t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(dw))
   <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7
   <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(8 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t; <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(2);
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 3 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 2
  <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> , 14 + ((dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F) * 3)
  t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(b))
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> b &lt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "0" + t; <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> t;
  <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> , 65 + (dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F)
  <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> b
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 7, 9 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>D, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1F: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> ".";
   <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(b);
  <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
 <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
 <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7
 <a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "(leave blank to cancel) Address: 0x"; t
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="LTRIM%24.html" title="LTRIM$"><span style="color:#87cefa;">LTRIM$</span></a>(t) = "" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
 ul = <a href="VAL.html" title="VAL"><span style="color:#87cefa;">VAL</span></a>("&amp;h" + t + "&amp;") <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="END_SUB.html" class="mw-redirect" title="END SUB"><span style="color:#87cefa;">END SUB</span></a>
</p>
<dl><dd>The .ICO format:</dd></dl>
<center><a rel="nofollow" class="external free" href="http://en.wikipedia.org/wiki/ICO_(file_format)">http://en.wikipedia.org/wiki/ICO_%28file_format%29</a>
<p><a rel="nofollow" class="external free" href="http://www.iconolog.org/info/icoFormat.html">http://www.iconolog.org/info/icoFormat.html</a>
</p>
<a rel="nofollow" class="external free" href="http://en.wikipedia.org/wiki/BMP_file_format">http://en.wikipedia.org/wiki/BMP_file_format</a> </center>
<p><br />
</p>
<dl><dd>Note that the BMP file header is excluded, but the DIB information header is included. My observations from using Resource Hacker on <i>c:\windows\notepad.exe</i>:</dd></dl>
<dl><dd>I've downloaded Resource Hacker. Note that if you export the first icon of \windows\notepad.exe as a binary file, it is identical to the file exported from my program (verifiable with fc /b). However, if you export it as an icon file, Resource Hacker adds 22 bytes to the beginning of it, a 6 byte ICONDIR structure, and a 16 byte ICONDIRENTRY structure. Resource Hacker is getting this information from the Icon Group resource.</dd></dl>
<dl><dd>If you export the Icon Group resource as a binary file, you will see that it starts with an ICONDIR structure specifying 9 images. It is followed by an array of 9 structures, 14 bytes each. The first 12 bytes are the same as an ICONDIRENTRY structure. (with a 2x Height difference). The last element, which would be a dword offset in a ICONDIRENTRY structure is instead a word index identifying the particular icon.</dd></dl>
<dl><dd>You can see what I mean: Use Resource Hacker to export the Icon Group as a binary file, named rhig.bin:</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:10px; white-space: pre; font-family: courier; background-color: white; color: darkgreen;">                          edit /78 rhig.bin </p>
<dl><dd>Delete the first 6 bytes, and save it as rhigmod.bin.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:10px; white-space: pre; font-family: courier; background-color: white; color: darkgreen;">                          edit /14 rhigmod.bin </p>
<dl><dd>and you can clearly see the array.</dd></dl>
<dl><dd>Note that, according to:</dd></dl>
<center><a rel="nofollow" class="external free" href="http://www.iconolog.org/info/icoFormat.html">http://www.iconolog.org/info/icoFormat.html</a></center>
<dl><dd>There is supposed to be a 2x Height difference between the ICONDIRENTRY structure in the icon file, and the DIB header within the icon file, with the DIB header having 2x the Height. However, when Resource Hacker exported the Icon file, it put 2x the Height in the ICONDIRENTRY structure also, doubling it from the Icon Group data. Icons seem to be Type ID 0x3, and Icon Groups seem to be Type ID 0xe. This seems consistent with:</dd></dl>
<center><a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/ms648009(v=VS.85).aspx">http://msdn.microsoft.com/en-us/library/ms648009(v=VS.85).aspx</a></center>
<dl><dd>I'll probably write some code in the next day or two to automate the process of extracting icons from a PE. My observations would need to be double checked before being relied upon. (as always)</dd></dl>
<dl><dd>Regards, Michael Calkins</dd></dl>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Revision_3">Revision 3</span></h2>
<dl><dd>The addresses of the strings were also offsets from the start of the main table. So now, it should correctly display the names of named entries. It now displays the names of known Type IDs. It can now accept the PE file name as a command line parameter, so that you can press up, enter, from the cmd prompt to restart it without having to type the name again.</dd></dl>
<dl><dd>I've moved the first horizontal line down 1 line. There is a minor optimization in that there is one less call to rva2fp.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'revision 20120316, michael calkins
'october 2011, michael calkins
'my code is public domain, but it's based on Microsoft's spec, so I'm not sure
'what kind of patents or copyrights apply.
'based on the Microsoft PE and COFF spec, Revision 8.2 - September 21, 2010
'<a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/windows/hardware/gg463119.aspx">http://msdn.microsoft.com/en-us/windows/hardware/gg463119.aspx</a>

'bug fixes on 2012 03 16:
' changed NumberOfRvaAndSizes to an _unsigned long
' added <a href="CONTROLCHR.html" title="CONTROLCHR"><span style="color:#87cefa;">_CONTROLCHR</span></a> OFF to the dump sub, and replaced the select case

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> nam <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> * 8
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> fil <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> k <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ul <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> coff <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> SectionTable <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ImageBase <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> rsrc <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> pe32plus <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> SizeOfOptionalHeader <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> NumberOfSections <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> NumberOfRvaAndSizes <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

<a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a>
fil = <a href="COMMAND%24.html" title="COMMAND$"><span style="color:#87cefa;">COMMAND$</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(fil) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "Name of the PE image to open? "; fil
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="FILEEXISTS.html" title="FILEEXISTS"><span style="color:#87cefa;">_FILEEXISTS</span></a>(fil) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "File not found.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a> fil <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> <a href="BINARY-2.html" class="mw-redirect" title="BINARY"><span style="color:#87cefa;">BINARY</span></a> <a href="ACCESS.html" class="mw-redirect" title="ACCESS"><span style="color:#87cefa;">ACCESS</span></a> <a href="READ.html" title="READ"><span style="color:#87cefa;">READ</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> 1
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + 0, w
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> w &lt;&gt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5A4D <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No MZ signature.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>3C, dw
coff = dw + 4
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, dw + 1, dw
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw &lt;&gt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4550&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No PE signature.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 2, NumberOfSections
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> NumberOfSections = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No sections.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "NumberOfSections:"; NumberOfSections
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> secsva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> secsfp(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 16, SizeOfOptionalHeader
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> SizeOfOptionalHeader = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No optional header.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "SizeOfOptionalHeader:", <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(4); word$(SizeOfOptionalHeader)
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20, w
<a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> w
 <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10B: pe32plus = 0: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "PE32"
 <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20B: pe32plus = -1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "PE32+"
 <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Unknown Magic.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 28 + (-4 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> pe32plus), ImageBase
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ImageBase:", "", dword$(ImageBase)
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 92 + (16 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> pe32plus), NumberOfRvaAndSizes
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> NumberOfRvaAndSizes &lt; 3 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No resource table.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "NumberOfRvaAndSizes:"; NumberOfRvaAndSizes
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 112 + (16 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> pe32plus), rsrc
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Rva of resource table:", dword$(rsrc)
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 4 + 112 + (16 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> pe32plus), dw
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Size of resource table:", dword$(dw)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (rsrc = 0) <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> (dw = 0) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No resource table.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
SectionTable = coff + 20 + SizeOfOptionalHeader
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "section", "va", "file ptr"
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> w = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + SectionTable + (40 * w), nam
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + SectionTable + 12 + (40 * w), ul
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + SectionTable + 20 + (40 * w), dw
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> nam, dword$(ul), dword$(dw)
 secsva(w) = ul
 secsfp(w) = dw
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Proceed? ";
DO
 k = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> k = "n" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> k: <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> k = "y"
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> k
dw = rva2fp(rsrc)
processtable dw, dw, 0
<a href="SYSTEM.html" title="SYSTEM"><span style="color:#87cefa;">SYSTEM</span></a>

<a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> processtable (bs <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, addr <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, level <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> k <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numnamest8 <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dat <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> siz <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> so <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> sc <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numnames <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numids <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ln <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> x <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> y <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> b <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>

<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 12, numnames
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 14, numids
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> nams(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numnames + (numnames &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> namsrva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numnames + (numnames &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ids(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids + (numids &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> idsrva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids + (numids &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

'get named entries
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numnames - 1
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + (x * 8), dw
 'the spec says its an rva, but it seems to be an offset in the section/table
 'low 31 bits are an offset from bs
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + bs + (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF), ln
 <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> y = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> ln - 1
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , w
  <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> w
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7E: nams(x) = nams(x) + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(w)
   <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: nams(x) = nams(x) + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1A)
  <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> y = 68 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
 <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + 4 + (x * 8), namsrva(x)
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>

'get numbered entries:
numnamest8 = numnames * 8
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids - 1
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + numnamest8 + (x * 8), ids(x)
 <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + 4 + numnamest8 + (x * 8), idsrva(x)
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>

'display:
<a href="VIEW_PRINT.html" title="VIEW PRINT"><span style="color:#87cefa;">VIEW PRINT</span></a>
sc = 0
so = 0
DO
 <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a> 0 'qb64 bug? not locating to 1,1?
 <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 1, 1
 <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> level
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 0: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "1st level - Type";
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "2nd level - Name";
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 2: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "3rd level - Language";
  <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="LTRIM%24.html" title="LTRIM$"><span style="color:#87cefa;">LTRIM$</span></a>(<a href="STR%24.html" title="STR$"><span style="color:#87cefa;">STR$</span></a>(level)) + "th level";
 <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "", "file ptr: "; dword$(addr); ". Press 'D' to dump."
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> numnames; "names in this level, in this branch."
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> numids; "IDs in this level, in this branch."
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (numnames <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> numids) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> level <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
   <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press any key to go up one level."
   <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>: <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
   <a href="EXIT_SUB.html" title="EXIT SUB"><span style="color:#87cefa;">EXIT SUB</span></a>
  <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
   <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
 <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "names are unicode. For simplicity, non ASCII chars will be shown as " + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1A) + "."
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> level <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "BKSP or ESC to go up one level."
 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "BKSP or ESC to exit."
 <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "UP, DOWN, PGUP, PGDN, HOME, <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> to navigate list."
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ENTER to select."
 <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 9, 1
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(80, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>C4);
 <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 22, 1
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(80, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>C4);
 DO
  <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
  <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 8, 1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(sc)
  <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> 11
   <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 10 + x, 1
   <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> x + so = sc <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 15, 1 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
   <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (x + so) &lt; numnames <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> nams(x + so); <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(70 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(nams(x + so)));
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(bs + (namsrva(x + so) <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF&amp;));
    <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
    <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 7, 18
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> namsrva(x + so) <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(descend)";
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(extract)";
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="ELSEIF.html" title="ELSEIF"><span style="color:#87cefa;">ELSEIF</span></a> (x + so) &lt; (numnames + numids) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ID: " + dword$(ids(x + so - numnames));
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> level = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> " (RT_";
     'derived from:
     ' <a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/ms648009(v=VS.85).aspx">http://msdn.microsoft.com/en-us/library/ms648009(v=VS.85).aspx</a>
     <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> ids(x + so - numnames)
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 9: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ACCELERATOR";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 21: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ANICURSOR";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 22: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ANIICON";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 2: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "BITMAP";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "CURSOR";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 5: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "DIALOG";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 17: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "DLGINCLUDE";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 8: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "FONT";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 7: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "FONTDIR";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 12: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "GROUP_CURSOR";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 14: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "GROUP_ICON";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 23: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "HTML";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 3: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ICON";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 24: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "MANIFEST";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 4: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "MENU";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 11: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "MESSAGETABLE";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 19: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "PLUGPLAY";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 10: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "RCDATA";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 6: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "<a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 16: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "VERSION";
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 20: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "VXD";
     <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> ")";
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(71 - <a href="POS.html" title="POS"><span style="color:#87cefa;">POS</span></a>(0));
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(bs + (idsrva(x + so - numnames)));
    <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
    <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 7, 18
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> idsrva(x + (so - numnames)) <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(descend)";
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(extract)";
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(80);
   <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
  DO
   k = <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>
  <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(k)
  <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> k
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> "d", "D"
    dump addr
    <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4800) 'up
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &gt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     sc = sc - 1
     <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; so <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = sc
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5000) 'down
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; (numnames + numids - 1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     sc = sc + 1
     <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &gt; (so + 11) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
      so = sc - 11
      <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &gt; sc <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0 'unsigned
     <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4700) 'home
    sc = 0
    so = 0
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4F00) 'end
    sc = numnames + numids - 1
    so = sc - 11
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4900) 'pgup
    sc = sc - 12
    so = so - 12
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> sc = 0
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5100) 'pgdn
    sc = sc + 12
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &gt; (numnames + numids - 1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> sc = numnames + numids - 1
    so = sc - 11
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>8), <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1B) 'bksp, esc
    <a href="EXIT_SUB.html" title="EXIT SUB"><span style="color:#87cefa;">EXIT SUB</span></a>
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>D) 'enter
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; numnames <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     dw = namsrva(sc)
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     dw = idsrva(sc - numnames)
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     'the spec says its an rva, but it seems to be an offset in the section/table
     processtable bs, bs + (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF&amp;), level + 1
     <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     'the spec says its an rva, but it seems to be an offset in the section/table
     dw = bs + dw
     <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + dw, dat
     <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + 4 + dw, siz
     <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a>
     <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 1, 1 'qb64 seems to default to line 2
     <a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> 1, 1 + rva2fp(dat)
     <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = 1 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> siz
      <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw &gt; 400 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
      <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , b
      <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> b
       <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 7, 9 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>D, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1F: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> ".";
       <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(b);
      <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
     <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
     <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 24, 1
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(siz) + " bytes.";
     <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 23, 1
     <a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "(leave blank to cancel) Output file? "; k
     <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(k) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
      <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="FILEEXISTS.html" title="FILEEXISTS"><span style="color:#87cefa;">_FILEEXISTS</span></a>(k) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
       <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
       <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "File already exists.";
      <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
       <a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a> k <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> <a href="BINARY-2.html" class="mw-redirect" title="BINARY"><span style="color:#87cefa;">BINARY</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> 2
       <a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> 1, 1 + rva2fp(dat)
       <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = 1 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> siz
        <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , b
        <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> 2, , b
       <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
       <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> 2
       <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
       <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Done.";
      <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
      <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>: <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
     <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
     <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
 <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="END_SUB.html" class="mw-redirect" title="END SUB"><span style="color:#87cefa;">END SUB</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> word$ (w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(w))
word = "0x" + <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(4 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> dword$ (dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(dw))
dword = "0x" + <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(8 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> rva2fp~&amp; (rva <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> w = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> rva &lt; secsva(w) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
w = w - 1
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> w &gt; NumberOfSections - 1 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(rva), w: <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>
rva2fp = rva + (secsfp(w) - secsva(w))
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> dump (addr <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ul <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> b <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>

<a href="CONTROLCHR.html" title="CONTROLCHR"><span style="color:#87cefa;">_CONTROLCHR</span></a> OFF
<a href="VIEW_PRINT.html" title="VIEW PRINT"><span style="color:#87cefa;">VIEW PRINT</span></a>
ul = addr
DO
 <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
 <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a> 0
 <a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> 1, 1 + ul
 <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = ul <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> (ul <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>FFFFFFF0) + <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>15F
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (1 + ul) &gt; <a href="LOF.html" title="LOF"><span style="color:#87cefa;">LOF</span></a>(1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , b
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
   t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(dw))
   <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7
   <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(8 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t; <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(2);
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 3 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 2
  <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> , 14 + ((dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F) * 3)
  t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(b))
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> b &lt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "0" + t; <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> t;
  <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> , 65 + (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F)
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(b);
 <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
 <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7
 <a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "(leave blank to cancel) Address: 0x"; t
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="LTRIM%24.html" title="LTRIM$"><span style="color:#87cefa;">LTRIM$</span></a>(t) = "" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
 ul = <a href="VAL.html" title="VAL"><span style="color:#87cefa;">VAL</span></a>("&amp;h" + t + "&amp;") <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="END_SUB.html" class="mw-redirect" title="END SUB"><span style="color:#87cefa;">END SUB</span></a> <i> </i>
</p>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Extract_Icon">Extract Icon</span></h2>
<dl><dd>Here is a program to extract an icon from a PE file. You specify the PE file, the index of the icon group (the first is 0), the maximum width and colors, and the output file. It will try to find the best matching icon, and extract the icon from the first language. I had earlier said that Resource Hacker gets the information for the ICO header from the icon group data. It could, but it could also get the data from the DIB header. Resource Hacker seems to use several fields that are reserved according to:</dd></dl>
<center><a rel="nofollow" class="external free" href="http://www.iconolog.org/info/icoFormat.html">http://www.iconolog.org/info/icoFormat.html</a></center>
<dl><dd>I use some of those fields in the icon group data to select the best icon from the group.</dd></dl>
<dl><dd><i>Notepad.exe</i> has 1 group of 9 icons: 48, 32, and 16 pixels; 32, 8, and 4 bpp each. The 4 bpp icons are the old fashioned ones.&#160;:-) I like both the old and new. <i>C:\Windows\System32\shell32.dll</i> and <i>pifmgr.dll</i> have numerous icons.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'revision date, last person to revise
'revision 20111101, michael calkins
'(derivitives may list sources of derivision)

'october 2011, michael calkins
'my code is public domain, but it's based on Microsoft's spec, so I'm not sure
'what kind of patents or copyrights apply.
'based on the Microsoft PE and COFF spec, Revision 8.2 - September 21, 2010
'[<a rel="nofollow" class="external text" href="http://msdn.microsoft.com/en-us/windows/hardware/gg463119.aspx%7C"><span style="color:#87cefa;">http://msdn.microsoft.com/en-us/windows/hardware/gg463119.aspx</span></a>]


<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> fil <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> n <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> gi <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> wi <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> bpp <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

fil = "\windows\notepad.exe"

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(fil) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> fil
gi = 0 'first icon group is normally 0 in most EXE or DLL files      
wi = 32 '16 to 256 max width     '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; change settings for other sizes      
bpp = 8 '4 to 32 bit max color   '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; 4 bit may use older style images
mode = 0 ' 0 = icon, 1 = bitmap
del$ = "delme.ico" 'change file extension to .BMP with mode 1 for bitmaps

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="FILEEXISTS.html" title="FILEEXISTS"><span style="color:#87cefa;">_FILEEXISTS</span></a>(del$) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="KILL.html" title="KILL"><span style="color:#87cefa;">KILL</span></a> del$ 'this file will be erased.
n = geticon(fil, del$, gi, wi, bpp, mode)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> n <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "error:"; n, geticonerror(n)
  <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
  <a href="SHELL.html" title="SHELL"><span style="color:#87cefa;">SHELL</span></a> <a href="DONTWAIT.html" title="DONTWAIT"><span style="color:#87cefa;">_DONTWAIT</span></a> "mspaint " + del$
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="SYSTEM.html" title="SYSTEM"><span style="color:#87cefa;">SYSTEM</span></a>
'               ---------------------------------------------------

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> geticon&amp; (fin <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, fout <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, gi <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, wi <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, co <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, m <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
'function extracts the best matching icon from a specified icon group from
'a specified PE image, and saves it to a specified file in a specified format.
'extracts the first language.

'fil = input file name
'fout = output file name
'gi = the number of the Icon Group (0 is first)
'wi = the preferred width (width is given priority over color)
'co = the preferred bits per pixel
'm = mode (0 for .ico, nonzero for .bmp)

'returns 0 for success, nonzero for error.

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> coff <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> SectionTable <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> pe32plus <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> bs <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> addr <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> nfin <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> nfout <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numnamest8 <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dat <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> siz <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> rva <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> fp <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> bc <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> bw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> SizeOfOptionalHeader <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> NumberOfSections <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> NumberOfRvaAndSizes <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numnames <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numids <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> x <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> y <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> z <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> b <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="FILEEXISTS.html" title="FILEEXISTS"><span style="color:#87cefa;">_FILEEXISTS</span></a>(fin) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 1: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
nfin = <a href="FREEFILE.html" title="FREEFILE"><span style="color:#87cefa;">FREEFILE</span></a>
<a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a> fin <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> <a href="BINARY-2.html" class="mw-redirect" title="BINARY"><span style="color:#87cefa;">BINARY</span></a> <a href="ACCESS.html" class="mw-redirect" title="ACCESS"><span style="color:#87cefa;">ACCESS</span></a> <a href="READ.html" title="READ"><span style="color:#87cefa;">READ</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> nfin
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + 0, w
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> w &lt;&gt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5A4D <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 2: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>3C, dw
coff = dw + 4
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, dw + 1, dw
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw &lt;&gt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4550&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 3: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + coff + 2, NumberOfSections
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> NumberOfSections = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 4: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> secsva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> secsfp(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + coff + 16, SizeOfOptionalHeader
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> SizeOfOptionalHeader = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 5: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + coff + 20, w
<a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> w
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10B: pe32plus = 0
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20B: pe32plus = -1
  <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: geticon = 6: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + coff + 20 + 92 + (16 <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> pe32plus), NumberOfRvaAndSizes
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> NumberOfRvaAndSizes &lt; 3 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 7: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + coff + 20 + 112 + (16 <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> pe32plus), bs
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + coff + 20 + 4 + 112 + (16 <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> pe32plus), dw
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (bs = 0) <a href="OR.html" title="OR"><span style="color:#87cefa;">OR</span></a> (dw = 0) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 8: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
SectionTable = coff + 20 + SizeOfOptionalHeader
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> w = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + SectionTable + 12 + (40 * w), secsva(w)
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + SectionTable + 20 + (40 * w), secsfp(w)
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>

rva = bs
<a href="GOSUB.html" title="GOSUB"><span style="color:#87cefa;">GOSUB</span></a> rva2fp
bs = fp

addr = bs
'group icon, first level
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 12, numnames
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 14, numids
numnamest8 = numnames * 8
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids - 1
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 16 + numnamest8 + (x * 8), dw
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>E <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 16 + 4 + numnamest8 + (x * 8), dw: <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> x = numids <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 9: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 10: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>

addr = bs + (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF&amp;)
'group icon, second level
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 12, numnames
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 14, numids
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> gi &gt;= numnames + numids <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 11: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 16 + 4 + (gi * 8), dw
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 12: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>

addr = bs + (dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF&amp;)
'group icon, third level
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 12, numnames
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 14, numids
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> 0 = (numnames + numids) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 13: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 16 + 4, dw
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 14: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>

'search for best icon within icon group
dw = bs + dw
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + dw, rva
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + 4 + dw, siz
<a href="GOSUB.html" title="GOSUB"><span style="color:#87cefa;">GOSUB</span></a> rva2fp
dat = fp
<a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> nfin, 1 + dat
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> siz &lt; 6 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 15: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + dat, dw
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw &lt;&gt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10000 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 16: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + dat + 4, y
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> y = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 17: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> siz &lt; (6 + (y * 14)) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 18: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
bc = 0
bw = 0
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> y - 1
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + dat + 6 + (x * 14), b
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> b = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> b = 255
  'best width, then best color
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (b &gt;= bw) <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> (b &lt;= wi) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + dat + 6 + (x * 14) + 6, w
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> ((w &gt; bc) <a href="OR.html" title="OR"><span style="color:#87cefa;">OR</span></a> (b &gt; bw)) <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> (w &lt;= co) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
      bc = w
      bw = b
      <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + dat + 6 + (x * 14) + 12, z
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> bc = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 19: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>

addr = bs
'icon, first level
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 12, numnames
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 14, numids
numnamest8 = numnames * 8
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids - 1
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 16 + numnamest8 + (x * 8), dw
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>3 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 16 + 4 + numnamest8 + (x * 8), dw: <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> x = numids <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 20: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 21: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>

addr = bs + (dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF&amp;)
'icon, second level
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 12, numnames
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 14, numids
numnamest8 = numnames * 8
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids - 1
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 16 + numnamest8 + (x * 8), dw
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw = z <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 16 + 4 + numnamest8 + (x * 8), dw: <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> x = numids <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 22: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 23: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>

addr = bs + (dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF&amp;)
'icon, third level
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 12, numnames
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 14, numids
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> 0 = (numnames + numids) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 24: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + addr + 16 + 4, dw
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 25: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>

'extract icon
dw = bs + dw
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + dw, rva
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + 4 + dw, siz
<a href="GOSUB.html" title="GOSUB"><span style="color:#87cefa;">GOSUB</span></a> rva2fp
dat = fp
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="FILEEXISTS.html" title="FILEEXISTS"><span style="color:#87cefa;">_FILEEXISTS</span></a>(fout) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 26: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
nfout = <a href="FREEFILE.html" title="FREEFILE"><span style="color:#87cefa;">FREEFILE</span></a>
<a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a> fout <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> <a href="BINARY-2.html" class="mw-redirect" title="BINARY"><span style="color:#87cefa;">BINARY</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> nfout
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + dat + 4, dw 'width, start 4 bytes into BMP header
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw &lt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>100 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> wide = dw <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> wide = wi
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, , dw 'double height
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw &lt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1FF <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> high = dw \ 2 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> high = wi
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, 1 + dat + 14, w 'bpp
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> w &lt;= <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> bpp = w <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> bpp = co

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> m <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  'Create bitmap format pre-header info of 14 bytes
  w = <a href="CVI.html" title="CVI"><span style="color:#87cefa;">CVI</span></a>("BM")
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, 1, w 'magic 
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> bpp &lt;= 8 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> pal = (2 ^ bpp) * 4: pb = bpp / 8 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> pal = 0: pb = 3
  dw = 54 + (wide * high * pb) + pal 'file size
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , dw 'file size
  dw = 0
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , dw '2 reserved  
  dw = 54 + pal 'bitmap header offset + palette if used
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , dw 'data offset
<a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
  'Create icon format Icon header and Entry header
  w = 0
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, 1, w 'reserved
  w = 1 '1 = icon, 2 = cursor(this could be set by mode value)
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , w 'resource id 
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , w 'icon count is always one in this procedure 
  b = wide
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , b 'width in Entry header
  b = high
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , b 'height
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> bpp &lt; 8 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> b = 2 ^ bpp <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> b = 0
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , b 'num of colors
  b = 0: w = 0
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , b 'reserved
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , w 'column hot spot for cursor
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , w 'row hot spot for cursor
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , siz 'size of data
  dw = 22 'offset of bmp header is 6 + 16 bytes
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , dw
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> nfin, 1 + dat 'seek start of bmp 40 byte header
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> m <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, , dw
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , dw 'header size
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, , dw
  dw = wide
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , dw 'width
  dw = high
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , dw 'height
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, , dw 'ignore double height
  siz = (wide * high * pb) + 28 + pal 'stop at <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> mask
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = 1 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> siz 'GET remaining image data including 
  <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> nfin, , b '     'BMP header, palette and mask(s)
  <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> nfout, , b
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a> dw
<a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfout
<a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin

geticon = 0
<a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>

rva2fp: 'call with rva returns fp modifies w

<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> w = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> rva &lt; secsva(w) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
w = w - 1
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> w &gt; NumberOfSections - 1 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> geticon = 27: <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> nfin: <a href="EXIT_FUNCTION.html" title="EXIT FUNCTION"><span style="color:#87cefa;">EXIT FUNCTION</span></a>
fp = rva + (secsfp(w) - secsva(w))
<a href="RETURN.html" title="RETURN"><span style="color:#87cefa;">RETURN</span></a>

<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> geticonerror$ (n <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
'revision date, last person to revise revision 20111031, michael calkins
'(derivitives may list sources of derivision) october 2011, public domain, michael calkins
<a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> n
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 0: geticonerror = "success"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 1: geticonerror = "input file not found"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 2: geticonerror = "MZ signature not found"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 3: geticonerror = "PE signature not found"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 4: geticonerror = "no sections found"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 5: geticonerror = "optional header not found"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 6: geticonerror = "unknown PE optional header"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 7: geticonerror = "no resource table"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 8: geticonerror = "no resource table"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 9: geticonerror = "icon groups not found"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 10: geticonerror = "icon group: 1st level entry is a leaf"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 11: geticonerror = "specified icon group not found"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 12: geticonerror = "icon group: 2nd level entry is a leaf"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 13: geticonerror = "no language for specified icon group"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 14: geticonerror = "icon group: 3rd level entry is not a leaf"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 15: geticonerror = "icon group data is too small"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 16: geticonerror = "icon group data is not as expected"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 17: geticonerror = "no icons in group"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 18: geticonerror = "icon array is too small"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 19: geticonerror = "could not find an icon matching the specifications"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 20: geticonerror = "icons not found"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 21: geticonerror = "icon: 1st level entry is a leaf"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 22: geticonerror = "target icon not found"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 23: geticonerror = "icon: 2nd level entry is a leaf"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 24: geticonerror = "no language for target icon"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 25: geticonerror = "icon: 3rd level is not a leaf"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 26: geticonerror = "output file already exists"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 27: geticonerror = "could not convert rva to fp"
  <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: geticonerror = "unknown error"
<a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a> <i> </i>
</p>
<dl><dd><i>Note:</i> Change the file name to .BMP and mode to 1 to extract the icon as a bitmap for QB64 to use. QB64 cannot load icons!</dd></dl>
<dl><dd>Have fun, and don't forget to double check it before relying on it. I appreciate bug reports, but I'm not responsible for errors.</dd></dl>
<dl><dd>Regards, Michael Calkins</dd></dl>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Extract_Resources">Extract Resources</span></h2>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'revision 20120316, michael calkins
'october 2011, michael calkins
'my code is public domain, but it's based on Microsoft's spec, so I'm not sure
'what kind of patents or copyrights apply.
'based on the Microsoft PE and COFF spec, Revision 8.2 - September 21, 2010
'<a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/windows/hardware/gg463119.aspx">http://msdn.microsoft.com/en-us/windows/hardware/gg463119.aspx</a>

'bug fixes on 2012 03 16:
' changed NumberOfRvaAndSizes to an _unsigned long
' added <a href="CONTROLCHR.html" title="CONTROLCHR"><span style="color:#87cefa;">_CONTROLCHR</span></a> OFF to the dump sub, and replaced the select case

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> nam <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> * 8
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> fil <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> k <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ul <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> coff <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> SectionTable <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ImageBase <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> rsrc <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> pe32plus <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> SizeOfOptionalHeader <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> NumberOfSections <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> NumberOfRvaAndSizes <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

<a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a>
fil = <a href="COMMAND%24.html" title="COMMAND$"><span style="color:#87cefa;">COMMAND$</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(fil) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "Name of the PE image to open? "; fil
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="FILEEXISTS.html" title="FILEEXISTS"><span style="color:#87cefa;">_FILEEXISTS</span></a>(fil) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "File not found.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a> fil <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> <a href="BINARY-2.html" class="mw-redirect" title="BINARY"><span style="color:#87cefa;">BINARY</span></a> <a href="ACCESS.html" class="mw-redirect" title="ACCESS"><span style="color:#87cefa;">ACCESS</span></a> <a href="READ.html" title="READ"><span style="color:#87cefa;">READ</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> 1
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + 0, w
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> w &lt;&gt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5A4D <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No MZ signature.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>3C, dw
coff = dw + 4
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, dw + 1, dw
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw &lt;&gt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4550&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No PE signature.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 2, NumberOfSections
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> NumberOfSections = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No sections.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "NumberOfSections:"; NumberOfSections
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> secsva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> secsfp(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 16, SizeOfOptionalHeader
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> SizeOfOptionalHeader = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No optional header.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "SizeOfOptionalHeader:", <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(4); word$(SizeOfOptionalHeader)
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20, w
<a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> w
    <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10B: pe32plus = 0: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "PE32"
    <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20B: pe32plus = -1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "PE32+"
    <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Unknown Magic.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 28 + (-4 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> pe32plus), ImageBase
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ImageBase:", "", dword$(ImageBase)
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 92 + (16 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> pe32plus), NumberOfRvaAndSizes
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> NumberOfRvaAndSizes &lt; 3 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No resource table.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "NumberOfRvaAndSizes:"; NumberOfRvaAndSizes
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 112 + (16 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> pe32plus), rsrc
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Rva of resource table:", dword$(rsrc)
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + coff + 20 + 4 + 112 + (16 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> pe32plus), dw
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Size of resource table:", dword$(dw)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (rsrc = 0) <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> (dw = 0) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No resource table.": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
SectionTable = coff + 20 + SizeOfOptionalHeader
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "section", "va", "file ptr"
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> w = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1
    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + SectionTable + (40 * w), nam
    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + SectionTable + 12 + (40 * w), ul
    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + SectionTable + 20 + (40 * w), dw
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> nam, dword$(ul), dword$(dw)
    secsva(w) = ul
    secsfp(w) = dw
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Proceed? ";
DO
    k = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> k = "n" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> k: <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> k = "y"
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> k
dw = rva2fp(rsrc)
processtable dw, dw, 0
<a href="SYSTEM.html" title="SYSTEM"><span style="color:#87cefa;">SYSTEM</span></a>

<a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> processtable (bs <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, addr <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, level <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> k <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numnamest8 <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dat <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> siz <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> so <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> sc <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numnames <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numids <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ln <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> x <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> y <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> b <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>

<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 12, numnames
<a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 14, numids
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> nams(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numnames + (numnames &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> namsrva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numnames + (numnames &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ids(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids + (numids &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> idsrva(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids + (numids &gt; 0)) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

'get named entries
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numnames - 1
    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + (x * 8), dw
    'the spec says its an rva, but it seems to be an offset in the section/table
    'low 31 bits are an offset from bs
    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + bs + (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF), ln
    <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> y = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> ln - 1
        <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , w
        <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> w
            <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7E: nams(x) = nams(x) + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(w)
            <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: nams(x) = nams(x) + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1A)
        <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
        <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> y = 68 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
    <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + 4 + (x * 8), namsrva(x)
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>

'get numbered entries:
numnamest8 = numnames * 8
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numids - 1
    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + numnamest8 + (x * 8), ids(x)
    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + addr + 16 + 4 + numnamest8 + (x * 8), idsrva(x)
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>

'display:
<a href="VIEW_PRINT.html" title="VIEW PRINT"><span style="color:#87cefa;">VIEW PRINT</span></a>
sc = 0
so = 0
DO
    <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a> 0 'qb64 bug? not locating to 1,1?
    <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 1, 1
    <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> level
        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 0: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "1st level - Type";
        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "2nd level - Name";
        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 2: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "3rd level - Language";
        <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="LTRIM%24.html" title="LTRIM$"><span style="color:#87cefa;">LTRIM$</span></a>(<a href="STR%24.html" title="STR$"><span style="color:#87cefa;">STR$</span></a>(level)) + "th level";
    <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "", "file ptr: "; dword$(addr); ". Press 'D' to dump."
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> numnames; "names in this level, in this branch."
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> numids; "IDs in this level, in this branch."
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (numnames <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> numids) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
        <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> level <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
            <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press any key to go up one level."
            <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>: <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
            <a href="EXIT_SUB.html" title="EXIT SUB"><span style="color:#87cefa;">EXIT SUB</span></a>
        <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
            <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
        <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "names are unicode. For simplicity, non ASCII chars will be shown as " + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1A) + "."
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> level <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
        <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "BKSP or ESC to go up one level."
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
        <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "BKSP or ESC to exit."
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "UP, DOWN, PGUP, PGDN, HOME, <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> to navigate list."
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ENTER to select."
    <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 9, 1
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(80, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>C4);
    <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 22, 1
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(80, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>C4);
    DO
        <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
        <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 8, 1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(sc)
        <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> x = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> 11
            <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 10 + x, 1
            <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> x + so = sc <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 15, 1 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
            <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (x + so) &lt; numnames <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
                <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> nams(x + so); <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(70 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(nams(x + so)));
                <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(bs + (namsrva(x + so) <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF&amp;));
                <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
                <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 7, 18
                <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> namsrva(x + so) <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
                    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(descend)";
                <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
                    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(extract)";
                <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
            <a href="ELSEIF.html" title="ELSEIF"><span style="color:#87cefa;">ELSEIF</span></a> (x + so) &lt; (numnames + numids) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
                <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ID: " + dword$(ids(x + so - numnames));
                <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> level = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
                    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> " (RT_";
                    'derived from:
                    ' <a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/ms648009(v=VS.85).aspx">http://msdn.microsoft.com/en-us/library/ms648009(v=VS.85).aspx</a>
                    <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> ids(x + so - numnames)
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 9: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ACCELERATOR";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 21: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ANICURSOR";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 22: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ANIICON";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 2: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "BITMAP";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "CURSOR";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 5: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "DIALOG";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 17: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "DLGINCLUDE";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 8: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "FONT";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 7: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "FONTDIR";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 12: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "GROUP_CURSOR";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 14: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "GROUP_ICON";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 23: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "HTML";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 3: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ICON";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 24: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "MANIFEST";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 4: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "MENU";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 11: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "MESSAGETABLE";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 19: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "PLUGPLAY";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 10: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "RCDATA";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 6: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "STRING";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 16: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "VERSION";
                        <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 20: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "VXD";
                    <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
                    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> ")";
                <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
                <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(71 - <a href="POS.html" title="POS"><span style="color:#87cefa;">POS</span></a>(0));
                <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(bs + (idsrva(x + so - numnames)));
                <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
                <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 7, 18
                <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> idsrva(x + (so - numnames)) <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
                    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(descend)";
                <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
                    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "(extract)";
                <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
            <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
                <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(80);
            <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
        <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
        DO
            k = <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>
        <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(k)
        <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> k
            <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> "d", "D"
                dump addr
                <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
            <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4800) 'up
                <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &gt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
                    sc = sc - 1
                    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; so <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = sc
                <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
            <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5000) 'down
                <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; (numnames + numids - 1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
                    sc = sc + 1
                    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &gt; (so + 11) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
                        so = sc - 11
                        <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &gt; sc <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0 'unsigned
                    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
                <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
            <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4700) 'home
                sc = 0
                so = 0
            <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4F00) 'end
                sc = numnames + numids - 1
                so = sc - 11
                <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0
            <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4900) 'pgup
                sc = sc - 12
                so = so - 12
                <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> sc = 0
                <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0
            <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="MKI%24.html" title="MKI$"><span style="color:#87cefa;">MKI$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5100) 'pgdn
                sc = sc + 12
                <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &gt; (numnames + numids - 1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> sc = numnames + numids - 1
                so = sc - 11
                <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> so &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> so = 0
            <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>8), <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1B) 'bksp, esc
                <a href="EXIT_SUB.html" title="EXIT SUB"><span style="color:#87cefa;">EXIT SUB</span></a>
            <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>D) 'enter
                <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> sc &lt; numnames <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
                    dw = namsrva(sc)
                <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
                    dw = idsrva(sc - numnames)
                <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
                <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
                    'the spec says its an rva, but it seems to be an offset in the section/table
                    processtable bs, bs + (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF&amp;), level + 1
                    <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
                <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
                    'the spec says its an rva, but it seems to be an offset in the section/table
                    dw = bs + dw
                    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + dw, dat
                    <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, 1 + 4 + dw, siz
                    <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a>
                    <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 1, 1 'qb64 seems to default to line 2
                    <a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> 1, 1 + rva2fp(dat)
                    <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = 1 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> siz
                        <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> dw &gt; 400 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
                        <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , b
                        <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> b
                            <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 7, 9 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>D, <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1F: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> ".";
                            <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(b);
                        <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
                    <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
                    <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 24, 1
                    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(siz) + " bytes.";
                    <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 23, 1
                    <a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "(leave blank to cancel) Output file? "; k
                    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(k) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
                        <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="FILEEXISTS.html" title="FILEEXISTS"><span style="color:#87cefa;">_FILEEXISTS</span></a>(k) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
                            <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
                            <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "File already exists.";
                        <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
                            <a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a> k <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> <a href="BINARY-2.html" class="mw-redirect" title="BINARY"><span style="color:#87cefa;">BINARY</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> 2
                            <a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> 1, 1 + rva2fp(dat)
                            <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = 1 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> siz
                                <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , b
                                <a href="PUT.html" title="PUT"><span style="color:#87cefa;">PUT</span></a> 2, , b
                            <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
                            <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> 2
                            <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
                            <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Done.";
                        <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
                        <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>: <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
                    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
                    <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
                <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
        <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
    <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="END_SUB.html" class="mw-redirect" title="END SUB"><span style="color:#87cefa;">END SUB</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> word$ (w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(w))
word = "0x" + <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(4 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> dword$ (dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(dw))
dword = "0x" + <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(8 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> rva2fp~&amp; (rva <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> w <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> w = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> NumberOfSections - 1
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> rva &lt; secsva(w) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
w = w - 1
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> w &gt; NumberOfSections - 1 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dword$(rva), w: <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>
rva2fp = rva + (secsfp(w) - secsva(w))
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> dump (addr <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dw <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ul <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> b <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>

<a href="CONTROLCHR.html" title="CONTROLCHR"><span style="color:#87cefa;">_CONTROLCHR</span></a> OFF
<a href="VIEW_PRINT.html" title="VIEW PRINT"><span style="color:#87cefa;">VIEW PRINT</span></a>
ul = addr
DO
    <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 0
    <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a> 0
    <a href="SEEK.html" title="SEEK"><span style="color:#87cefa;">SEEK</span></a> 1, 1 + ul
    <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> dw = ul <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> (ul <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>FFFFFFF0) + <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>15F
        <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (1 + ul) &gt; <a href="LOF.html" title="LOF"><span style="color:#87cefa;">LOF</span></a>(1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT.html" title="EXIT"><span style="color:#87cefa;">EXIT</span></a> <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>
        <a href="GET.html" title="GET"><span style="color:#87cefa;">GET</span></a> 1, , b
        <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
            t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(dw))
            <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7
            <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(8 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t; <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(2);
        <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
        <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 3 <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 2
        <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> , 14 + ((dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F) * 3)
        t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(b))
        <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> b &lt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "0" + t; <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> t;
        <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> , 65 + (dw <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F)
        <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(b);
    <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
    <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7
    <a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "(leave blank to cancel) Address: 0x"; t
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="LTRIM%24.html" title="LTRIM$"><span style="color:#87cefa;">LTRIM$</span></a>(t) = "" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
    ul = <a href="VAL.html" title="VAL"><span style="color:#87cefa;">VAL</span></a>("&amp;h" + t + "&amp;") <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFFFFFF
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="END_SUB.html" class="mw-redirect" title="END SUB"><span style="color:#87cefa;">END SUB</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Michael Calkins</span></center>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="References">References</span></h2>
<p><i>See also:</i>
</p>
<ul><li><a href="Icons_and_Cursors.html" title="Icons and Cursors">Icons and Cursors</a></li>
<li><a href="Bitmaps.html" title="Bitmaps">Bitmaps</a>, <a href="ICON.html" title="ICON">_ICON</a>, <a href="%24EXEICON.html" title="$EXEICON">$EXEICON</a></li>
<li><a href="SaveIcon32.html" title="SaveIcon32">SaveIcon32</a> <span style="color:gray">(create icons from any image)</span></li></ul>
<p><br />
</p>
<hr />
<center><i>Navigation:</i>
<dl><dd><a href="Keyword_Reference_-_Alphabetical.html" title="Keyword Reference - Alphabetical">Keyword Reference - Alphabetical</a></dd>
<dd><a href="Keyword_Reference_-_By_usage.html" title="Keyword Reference - By usage">Keyword Reference - By Usage</a></dd>
<dd><a href="Main_Page.html" title="Main Page">Main Wiki Page</a></dd></dl></center>
<!-- 
NewPP limit report
Cached time: 20210706152943
Cache expiry: 86400
Dynamic content: false
Complications: []
CPU time usage: 1.890 seconds
Real time usage: 2.804 seconds
Preprocessor visited node count: 28766/1000000
Post‐expand include size: 163298/2097152 bytes
Template argument size: 30515/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  773.026      1 -total
 50.15%  387.654   3184 Template:Cl
  0.79%    6.127      1 Template:PageNavigation
  0.72%    5.556      1 Template:Text
  0.59%    4.549      5 Template:CodeStart
  0.50%    3.865      5 Template:CodeEnd
  0.42%    3.226      2 Template:Small
  0.41%    3.149      3 Template:WhiteStart
  0.40%    3.079      3 Template:WhiteEnd
-->

<!-- Saved in parser cache with key i4224360_mw2-mw_:pcache:idhash:599-0!canonical and timestamp 20210706152941 and revision id 17958
 -->
</div></div><div class="printfooter">Retrieved from "<a dir="ltr" href="indexe5e0.html?title=Resource_Table_extraction&amp;oldid=17958">http://www.qb64.org/wiki/index.php?title=Resource_Table_extraction&amp;oldid=17958</a>"</div>
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-personal" class="vector-menu" aria-labelledby="p-personal-label" role="navigation" 
	 >
	<h3 id="p-personal-label">
		<span>Personal tools</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="vector-menu-content-list"><li id="pt-login"><a href="index3111.html?title=Special:UserLogin&amp;returnto=Resource+Table+extraction" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li></ul>
		
	</div>
</nav>


		<div id="left-navigation">
			<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-namespaces" class="vector-menu vector-menu-tabs vectorTabs" aria-labelledby="p-namespaces-label" role="navigation" 
	 >
	<h3 id="p-namespaces-label">
		<span>Namespaces</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="vector-menu-content-list"><li id="ca-nstab-main" class="selected"><a href="Resource_Table_extraction.html" title="View the content page [c]" accesskey="c">Page</a></li><li id="ca-talk" class="new"><a href="Talk_Resource_Table_extraction.html?title=Talk:Resource_Table_extraction&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></li></ul>
		
	</div>
</nav>


			<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-variants" class="vector-menu-empty emptyPortlet vector-menu vector-menu-dropdown vectorMenu" aria-labelledby="p-variants-label" role="navigation" 
	 >
	<input type="checkbox" class="vector-menu-checkbox vectorMenuCheckbox" aria-labelledby="p-variants-label" />
	<h3 id="p-variants-label">
		<span>Variants</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="menu vector-menu-content-list"></ul>
		
	</div>
</nav>


		</div>
		<div id="right-navigation">
			<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-views" class="vector-menu vector-menu-tabs vectorTabs" aria-labelledby="p-views-label" role="navigation" 
	 >
	<h3 id="p-views-label">
		<span>Views</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="vector-menu-content-list"><li id="ca-view" class="collapsible selected"><a href="Resource_Table_extraction.html">Read</a></li><li id="ca-viewsource" class="collapsible"><a href="indexcf9f.html?title=Resource_Table_extraction&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li id="ca-history" class="collapsible"><a href="index0486.html?title=Resource_Table_extraction&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></li></ul>
		
	</div>
</nav>


			<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-cactions" class="vector-menu-empty emptyPortlet vector-menu vector-menu-dropdown vectorMenu" aria-labelledby="p-cactions-label" role="navigation" 
	 >
	<input type="checkbox" class="vector-menu-checkbox vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
	<h3 id="p-cactions-label">
		<span>More</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="menu vector-menu-content-list"></ul>
		
	</div>
</nav>


			<div id="p-search" role="search">
	<h3 >
		<label for="searchInput">Search</label>
	</h3>
	<form action="https://www.qb64.org/wiki/index.php" id="searchform">
		<div id="simpleSearch">
			<input type="search" name="search" placeholder="Search QB64 Wiki" title="Search QB64 Wiki [f]" accesskey="f" id="searchInput"/>
			<input type="hidden" name="title" value="Special:Search">
			<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/>
			<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>
		</div>
	</form>
</div>

		</div>
	</div>
	
<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a  title="Visit the main page" class="mw-wiki-logo" href="Main_Page.html"></a>
	</div>
	<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-navigation" class="vector-menu vector-menu-portal portal portal-first" aria-labelledby="p-navigation-label" role="navigation" 
	 >
	<h3 id="p-navigation-label">
		<span>Navigation</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="vector-menu-content-list"><li id="n-mainpage-description"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main page</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="SNDCOPY.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help-mediawiki"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents">Help about MediaWiki</a></li></ul>
		
	</div>
</nav>


	<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-tb" class="vector-menu vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation" 
	 >
	<h3 id="p-tb-label">
		<span>Tools</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Resource_Table_extraction.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Resource_Table_extraction.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="indexe5e0.html?title=Resource_Table_extraction&amp;oldid=17958" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="indexfad1.html?title=Resource_Table_extraction&amp;action=info" title="More information about this page">Page information</a></li></ul>
		
	</div>
</nav>


	
</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info" >
		<li id="footer-info-lastmod"> This page was last edited on 22 January 2020, at 03:52.</li>
	</ul>
	<ul id="footer-places" >
		<li id="footer-places-privacy"><a href="My_wiki_Privacy_policy.html" title="My wiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="My_wiki_About.html" title="My wiki:About">About QB64 Wiki</a></li>
		<li id="footer-places-disclaimer"><a href="My_wiki_General_disclaimer.html" title="My wiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
	</ul>
	<div style="clear: both;"></div>
</footer>



<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"1.890","walltime":"2.804","ppvisitednodes":{"value":28766,"limit":1000000},"postexpandincludesize":{"value":163298,"limit":2097152},"templateargumentsize":{"value":30515,"limit":2097152},"expansiondepth":{"value":3,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":0,"limit":5000000},"timingprofile":["100.00%  773.026      1 -total"," 50.15%  387.654   3184 Template:Cl","  0.79%    6.127      1 Template:PageNavigation","  0.72%    5.556      1 Template:Text","  0.59%    4.549      5 Template:CodeStart","  0.50%    3.865      5 Template:CodeEnd","  0.42%    3.226      2 Template:Small","  0.41%    3.149      3 Template:WhiteStart","  0.40%    3.079      3 Template:WhiteEnd"]},"cachereport":{"timestamp":"20210706152943","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":1462});});</script></body>
<!-- Mirrored from www.qb64.org/wiki/Resource_Table_extraction by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 07 Aug 2021 12:44:08 GMT -->
</html>
