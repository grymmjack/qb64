$Debug
_CONTROLCHR OFF
SCREEN _NEWIMAGE(800, 600, 32)
_TITLE "DDPATTERN"

CONST NUM_PATTERNS_IN_FILE  = 30
CONST NUM_COLORS_IN_PALETTE = 15
CONST NUM_ROWS_IN_PATTERN   = 8
CONST NUM_COLS_IN_PATTERN   = 8

TYPE DAZZLEDRAW_PATTERN_STRUCT
    HEADER    AS STRING * 76
    PATTERN1  AS STRING * 64
    PATTERN2  AS STRING * 64
    PATTERN3  AS STRING * 64
    PATTERN4  AS STRING * 64
    PATTERN5  AS STRING * 64
    PATTERN6  AS STRING * 64
    PATTERN7  AS STRING * 64
    PATTERN8  AS STRING * 64
    PATTERN9  AS STRING * 64
    PATTERN10 AS STRING * 64
    PATTERN11 AS STRING * 64
    PATTERN12 AS STRING * 64
    PATTERN13 AS STRING * 64
    PATTERN14 AS STRING * 64
    PATTERN15 AS STRING * 64
    PATTERN16 AS STRING * 64
    PATTERN17 AS STRING * 64
    PATTERN18 AS STRING * 64
    PATTERN19 AS STRING * 64
    PATTERN20 AS STRING * 64
    PATTERN21 AS STRING * 64
    PATTERN22 AS STRING * 64
    PATTERN23 AS STRING * 64
    PATTERN24 AS STRING * 64
    PATTERN25 AS STRING * 64
    PATTERN26 AS STRING * 64
    PATTERN27 AS STRING * 64
    PATTERN28 AS STRING * 64
    PATTERN29 AS STRING * 64
    PATTERN30 AS STRING * 64
END TYPE

TYPE APPLE2_COLOR_PALETTE
    BLACK   AS _UNSIGNED LONG
    GRAY_1  AS _UNSIGNED LONG
    D_BLUE  AS _UNSIGNED LONG
    PURPLE  AS _UNSIGNED LONG
    RED     AS _UNSIGNED LONG
    ORANGE  AS _UNSIGNED LONG
    PINK    AS _UNSIGNED LONG
    YELLOW  AS _UNSIGNED LONG
    GRAY_2  AS _UNSIGNED LONG
    D_GREEN AS _UNSIGNED LONG
    BROWN   AS _UNSIGNED LONG
    L_GREEN AS _UNSIGNED LONG
    AQUA    AS _UNSIGNED LONG
    M_BLUE  AS _UNSIGNED LONG
    L_BLUE  AS _UNSIGNED LONG
    WHITE   AS _UNSIGNED LONG
END TYPE

DIM SHARED DAZZLEDRAW_PATTERNS_DATA AS DAZZLEDRAW_PATTERN_STRUCT
DIM SHARED APPLE2_COLOR_S AS APPLE2_COLOR_PALETTE
DIM SHARED APPLE2_COLOR_N(0 TO NUM_COLORS_IN_PALETTE) AS _UNSIGNED LONG

DIM f AS LONG
DIM ptrn_file AS STRING

APPLE2_COLOR_S.BLACK   = _RGB(0, 0, 0)
APPLE2_COLOR_S.GRAY_1  = _RGB(82, 82, 82)
APPLE2_COLOR_S.D_BLUE  = _RGB(0, 0, 163)
APPLE2_COLOR_S.PURPLE  = _RGB(206, 47, 214)
APPLE2_COLOR_S.RED     = _RGB(206, 8, 45)
APPLE2_COLOR_S.ORANGE  = _RGB(255, 101, 0)
APPLE2_COLOR_S.PINK    = _RGB(255, 158, 154)
APPLE2_COLOR_S.YELLOW  = _RGB(255, 255, 0)
APPLE2_COLOR_S.GRAY_2  = _RGB(173, 173, 173)
APPLE2_COLOR_S.D_GREEN = _RGB(5, 99, 43)
APPLE2_COLOR_S.BROWN   = _RGB(157, 100, 0)
APPLE2_COLOR_S.L_GREEN = _RGB(24, 222, 0)
APPLE2_COLOR_S.AQUA    = _RGB(57, 255, 142)
APPLE2_COLOR_S.M_BLUE  = _RGB(40, 42, 255)
APPLE2_COLOR_S.L_BLUE  = _RGB(96, 155, 255)
APPLE2_COLOR_S.WHITE   = _RGB(255, 255, 255)

APPLE2_COLOR_N(0)  = _RGB(0, 0, 0)
APPLE2_COLOR_N(1)  = _RGB(82, 82, 82)
APPLE2_COLOR_N(2)  = _RGB(0, 0, 163)
APPLE2_COLOR_N(3)  = _RGB(206, 47, 214)
APPLE2_COLOR_N(4)  = _RGB(206, 8, 45)
APPLE2_COLOR_N(5)  = _RGB(255, 101, 0)
APPLE2_COLOR_N(6)  = _RGB(255, 158, 154)
APPLE2_COLOR_N(7)  = _RGB(255, 255, 0)
APPLE2_COLOR_N(8)  = _RGB(173, 173, 173)
APPLE2_COLOR_N(9)  = _RGB(5, 99, 43)
APPLE2_COLOR_N(10) = _RGB(157, 100, 0)
APPLE2_COLOR_N(11) = _RGB(24, 222, 0)
APPLE2_COLOR_N(12) = _RGB(57, 255, 142)
APPLE2_COLOR_N(13) = _RGB(40, 42, 255)
APPLE2_COLOR_N(14) = _RGB(96, 155, 255)
APPLE2_COLOR_N(15) = _RGB(255, 255, 255)

ptrn_file$ = "./DEF1.bin"
f& = FREEFILE

OPEN ptrn_file$ FOR BINARY AS f&
GET f&, , DAZZLEDRAW_PATTERNS_DATA
CLOSE f&

render_dazzledraw_pattern DAZZLEDRAW_PATTERNS_DATA.PATTERN1$, 1, 1, 8, 8

SUB render_dazzledraw_pattern (pattern$, x%, y%, w%, h%)
    DIM AS INTEGER cols, rows, start_x, end_x, start_y, end_y, pixel, pixel_color
    DIM AS STRING char
    DIM AS _UNSIGNED LONG pattern_color
    DIM color_byte AS _UNSIGNED _BYTE

    pixel% = 1
    FOR rows% = 1 TO NUM_ROWS_IN_PATTERN
        FOR cols% = 1 TO NUM_COLS_IN_PATTERN
            start_x%        = x% + (w% * cols%)
            end_x%          = start_x% + w%
            start_y%        = y% + (h% * rows%)
            end_y%          = start_y% + h%
            color_byte~%%   = ASC(MID$(pattern$, pixel%, 1))
            char$           = MID$(pattern$, pixel%, 1)
            pixel_color%    = color_byte~%%
            pattern_color~& = APPLE2_COLOR_N(pixel_color%)
            LINE (start_x%, start_y%)-(end_x%, end_y%), pattern_color~&, BF
            pixel% = pixel% + 1
        NEXT cols%
    NEXT rows%
END SUB
