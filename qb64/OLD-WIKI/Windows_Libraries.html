
<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from www.qb64.org/wiki/Windows_Libraries by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 07 Aug 2021 12:43:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>Windows Libraries - QB64 Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":!1,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"YOWkUVpP-65vp3So6LuluwAAANY","wgCSPNonce":!1,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Windows_Libraries","wgTitle":"Windows Libraries","wgCurRevisionId":23678,"wgRevisionId":23678,"wgArticleId":756,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Windows_Libraries","wgRelevantArticleId":756,"wgIsProbablyEditable":!1,"wgRelevantPageIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[]};RLSTATE={"site.styles":"ready","noscript":"ready","user.styles":
"ready","user":"ready","user.options":"loading","skins.vector.styles.legacy":"ready","mediawiki.toc.styles":"ready"};RLPAGEMODULES=["site","mediawiki.page.startup","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.js"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@1hzgi",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});});</script>
<link rel="stylesheet" href="loadd8b0.css?lang=en&amp;modules=mediawiki.toc.styles%7Cskins.vector.styles.legacy&amp;only=styles&amp;skin=vector"/>
<script async="" src="load52c0.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="generator" content="MediaWiki 1.35.2"/>
<link rel="shortcut icon" href="https://www.qb64.org/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="QB64 Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api-result251f.xml?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="QB64 Wiki Atom feed" href="feeda295.xml?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/wiki/resources/lib/html5shiv/html5shiv.js"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Windows_Libraries rootpage-Windows_Libraries skin-vector action-view skin-vector-legacy">
<div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Windows Libraries</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From QB64 Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p>QB64 can support the <b>specific Windows Operating System Libraries</b> on your PC. They should be located in the <b>System32</b> folder. Use <a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY">DECLARE LIBRARY</a> with the appropriate <a href="ALIAS.html" class="mw-redirect" title="ALIAS">ALIAS</a>. Loaded DLL files are NOT required to be named in the Declaration!
</p>
<center> <b>Note: C++ Header files should be placed in the QB64 folder and are not required after a program is compiled.</b></center>
<center><b>Note: QB64 requires all DLL files to either be with the program or in the C:\WINDOWS\SYSTEM32 folder!</b></center>
<center>Maximum Windows path: MAX_PATH = drive letter + ":\" + 256 + CHR$(0) = 260 characters.</center>
<p><br />
</p>
<table align="Right">
<tbody><tr>
<td><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Computer_Date.2FTime"><span class="tocnumber">1</span> <span class="toctext">Computer Date/Time</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Borderless_Window"><span class="tocnumber">2</span> <span class="toctext">Borderless Window</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Color_Dialog_Box"><span class="tocnumber">3</span> <span class="toctext">Color Dialog Box</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Desktop_Size"><span class="tocnumber">4</span> <span class="toctext">Desktop Size</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Directory_Environment"><span class="tocnumber">5</span> <span class="toctext">Directory Environment</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Disk_Drives"><span class="tocnumber">6</span> <span class="toctext">Disk Drives</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#File_Attributes"><span class="tocnumber">7</span> <span class="toctext">File Attributes</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#File_Open_and_Save_Dialog"><span class="tocnumber">8</span> <span class="toctext">File Open and Save Dialog</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#File_Times"><span class="tocnumber">9</span> <span class="toctext">File Times</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Focus"><span class="tocnumber">10</span> <span class="toctext">Focus</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Folder_Dialog_Box"><span class="tocnumber">11</span> <span class="toctext">Folder Dialog Box</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Font_Dialog_Box"><span class="tocnumber">12</span> <span class="toctext">Font Dialog Box</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Registered_Fonts"><span class="tocnumber">13</span> <span class="toctext">Registered Fonts</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Game_Pad"><span class="tocnumber">14</span> <span class="toctext">Game Pad</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#Hot_Keys_.28maximize.29"><span class="tocnumber">15</span> <span class="toctext">Hot Keys (maximize)</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#Keyboard_Lock_Settings"><span class="tocnumber">16</span> <span class="toctext">Keyboard Lock Settings</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#Message_Box"><span class="tocnumber">17</span> <span class="toctext">Message Box</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#Mouse_Area"><span class="tocnumber">18</span> <span class="toctext">Mouse Area</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Open_another_Program"><span class="tocnumber">19</span> <span class="toctext">Open another Program</span></a></li>
<li class="toclevel-1 tocsection-20"><a href="#Play_WAV_Sounds"><span class="tocnumber">20</span> <span class="toctext">Play WAV Sounds</span></a></li>
<li class="toclevel-1 tocsection-21"><a href="#Run_One_Instance"><span class="tocnumber">21</span> <span class="toctext">Run One Instance</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="#Send_Keys"><span class="tocnumber">22</span> <span class="toctext">Send Keys</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#System_Metrics"><span class="tocnumber">23</span> <span class="toctext">System Metrics</span></a></li>
<li class="toclevel-1 tocsection-24"><a href="#Top_Most_Window"><span class="tocnumber">24</span> <span class="toctext">Top Most Window</span></a></li>
<li class="toclevel-1 tocsection-25"><a href="#Video_File_Player"><span class="tocnumber">25</span> <span class="toctext">Video File Player</span></a></li>
<li class="toclevel-1 tocsection-26"><a href="#Web_Page_Download"><span class="tocnumber">26</span> <span class="toctext">Web Page Download</span></a></li>
<li class="toclevel-1 tocsection-27"><a href="#Windows_API"><span class="tocnumber">27</span> <span class="toctext">Windows API</span></a></li>
<li class="toclevel-1 tocsection-28"><a href="#Window_Focus"><span class="tocnumber">28</span> <span class="toctext">Window Focus</span></a></li>
<li class="toclevel-1 tocsection-29"><a href="#Windows_Menu"><span class="tocnumber">29</span> <span class="toctext">Windows Menu</span></a></li>
<li class="toclevel-1 tocsection-30"><a href="#Windows_Notification"><span class="tocnumber">30</span> <span class="toctext">Windows Notification</span></a></li>
<li class="toclevel-1 tocsection-31"><a href="#Windows_Ports"><span class="tocnumber">31</span> <span class="toctext">Windows Ports</span></a></li>
<li class="toclevel-1 tocsection-32"><a href="#Windows_Sounds"><span class="tocnumber">32</span> <span class="toctext">Windows Sounds</span></a></li>
<li class="toclevel-1 tocsection-33"><a href="#Window_Transparency"><span class="tocnumber">33</span> <span class="toctext">Window Transparency</span></a></li>
<li class="toclevel-1 tocsection-34"><a href="#Windows_User"><span class="tocnumber">34</span> <span class="toctext">Windows User</span></a></li>
<li class="toclevel-1 tocsection-35"><a href="#Windows_Version"><span class="tocnumber">35</span> <span class="toctext">Windows Version</span></a></li>
<li class="toclevel-1 tocsection-36"><a href="#Reference"><span class="tocnumber">36</span> <span class="toctext">Reference</span></a></li>
</ul>
</div>

</td></tr></tbody></table>
<p style="padding: 1em; line-height:100%; margin-left:10px; white-space: pre; font-family: courier; background-color: white; color: darkgreen;">
<b>                         Windows API Data Structures</b>

<b>Name            Description             Bits             QB64 Type</b>
bit            8 bits in one byte         1                <a href="BIT.html" title="BIT">_BIT</a>
nybble         2 nybbles in one byte      4                <a href="BIT.html" title="BIT">_BIT</a> * 4
byte           1 byte (2 nybbles)         8                <a href="BYTE.html" title="BYTE">_BYTE</a>
Boolean        1 byte (signed/unsigned)   8                <a href="BYTE.html" title="BYTE">_BYTE</a> 
CharA(FunctA)  <a href="ASCII.html" title="ASCII">ASCII</a> character            8(<a href="LEN.html" title="LEN">LEN</a>(buffer))   <a href="BYTE.html" title="BYTE">_BYTE</a>
WORD           2 bytes                   16                <a href="INTEGER.html" title="INTEGER">INTEGER</a>
CharW(FunctW)  <a href="Unicode.html" title="Unicode">Unicode</a> wide character    16(<a href="LEN.html" title="LEN">LEN</a>(buffer)\2) <a href="INTEGER.html" title="INTEGER">INTEGER</a>
DWORD          4 bytes                   32                <a href="LONG.html" title="LONG">LONG</a>
QWORD          8 bytes                   64                <a href="INTEGER64.html" title="INTEGER64">_INTEGER64</a>
LP or hwnd     Short or Long Pointer     ANY <a href="INTEGER.html" title="INTEGER">INTEGER</a>       <a href="OFFSET.html" title="OFFSET">_OFFSET</a>
 
                  Void * in C code is also an <a href="OFFSET.html" title="OFFSET">_OFFSET</a>
</p>
<center><b><a rel="nofollow" class="external text" href="http://msdn.microsoft.com/en-us/library/aa383751(v=vs.85).aspx">Windows Data Types</a></b></center>
<center><b><a rel="nofollow" class="external text" href="http://doc.pcsoft.fr/en-US/?6510001">Windows 32 API constant values</a></b></center>
<p><br />
</p>
<h2><span id="Computer_Date/Time"></span><span class="mw-headline" id="Computer_Date.2FTime">Computer Date/Time</span></h2>
<p><b>NOTE: You might need to run this program as Administrator</b>
</p>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'=============
'DATE&amp;TIME.BAS
'=============
'A <a href="DATE%24.html" title="DATE$"><span style="color:#87cefa;">DATE$</span></a> and <a href="TIME%24.html" title="TIME$"><span style="color:#87cefa;">TIME$</span></a> alternative.
'Gets &amp; Sets System DATE &amp; TIME using Windows API.
'Coded for QB64 by Dav FEB/2012

'======================================================================
'NOTE: THIS DEMO WILL ATTEMPT TO CHANGE YOUR SYSTEM DATE FOR 5 SECONDS.
'     AFTER 5 SECONDS IT WILL ATTEMPT TO RESTORE ORIGINAL DATE SETTING.
'======================================================================

<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> SYSTEMTIME
    wYear <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
    wMonth <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
    wDayOfWeek <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
    wDay <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
    wHour <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
    wMinute <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
    wSecond <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
    wMilliseconds <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "Kernel32"
'== NOTE: SetSystemTime&amp; returns Zero if it Fails.
'== NOTE: GetSystemTime does not return a value.
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SetSystemTime&amp; (lpSystemTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> SYSTEMTIME)
    <a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> GetSystemTime (lpSystemTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> SYSTEMTIME)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

' Holds current values...
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> CurrentTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> SYSTEMTIME

' For the new values to set...
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> NewTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> SYSTEMTIME

' Get &amp; Show current System Date/Time
GetSystemTime CurrentTime

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "--------------------------------"
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Current System DATE &amp; TIME is..."
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "DATE:"; CurrentTime.wMonth; "-"; CurrentTime.wDay; "-"; CurrentTime.wYear
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "TIME:"; CurrentTime.wHour; ":"; CurrentTime.wMinute; ":"; CurrentTime.wSecond
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "--------------------------------"


'=== Now Set new DATE only
'=== <a href="NOT.html" title="NOT"><span style="color:#87cefa;">NOT</span></a>ICE we're using CurrentTime TIME value's '&lt;==
'=== So we're just changing the DATE, not the TIME here...

NewTime.wYear = 2011     'move date back to prevent trial version expiration!
NewTime.wMonth = 12
NewTime.wDayOfWeek = -1
NewTime.wDay = 25
NewTime.wHour = CurrentTime.wHour '&lt;==
NewTime.wMinute = CurrentTime.wMinute '&lt;==
NewTime.wSecond = CurrentTime.wSecond '&lt;==
NewTime.wMilliseconds = CurrentTime.wMilliseconds '&lt;==

' Set the new values
x = SetSystemTime&amp;(NewTime)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> x = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Failed to change DATE/TIME!": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>

' Grab new System DATE settings...
' Temporary holding space...for TIME...
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> CurrentTime2 <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> SYSTEMTIME

GetSystemTime CurrentTime2

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "--------------------------------"
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Now the NEW System DATE is..."
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "DATE:"; CurrentTime2.wMonth; "-"; CurrentTime2.wDay; "-"; CurrentTime2.wYear
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "--------------------------------"
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Waiting 5 seconds! Check computer date in taskbar....."


<a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a> 5

'=== Now set everything back to what it was at the beginning.
'=== Using TIME values from CurrentTime2 so we don't lose any
'=== seconds from SLEEPing....

' Grab current values again, keeps the running TIME...
GetSystemTime CurrentTime2

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Resetting DATE back..."

NewTime.wYear = CurrentTime.wYear
NewTime.wMonth = CurrentTime.wMonth
NewTime.wDayOfWeek = -1
NewTime.wDay = CurrentTime.wDay
NewTime.wHour = CurrentTime2.wHour '&lt;==
NewTime.wMinute = CurrentTime2.wMinute '&lt;==
NewTime.wSecond = CurrentTime2.wSecond '&lt;==
NewTime.wMilliseconds = CurrentTime2.wMilliseconds '&lt;==

' Set the DATE &amp; TIME values back

x = SetSystemTime&amp;(NewTime):
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> x = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Failed to change DATE/TIME!": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>

' Now let's get &amp; show Current values, see if it worked...

GetSystemTime CurrentTime

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "--------------------------------"
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Now the System DATE &amp; TIME is..."
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "DATE:"; CurrentTime.wMonth; "-"; CurrentTime.wDay; "-"; CurrentTime.wYear
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "TIME:"; CurrentTime.wHour; ":"; CurrentTime.wMinute; ":"; CurrentTime.wSecond
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "--------------------------------"

<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code by Dav</span></center>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<p><br />
</p>
<h2><span class="mw-headline" id="Borderless_Window">Borderless Window</span></h2>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;">
'============
'NOBORDER.BAS
'============

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE CUSTOMTYPE LIBRARY</span></a>
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindow&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> ClassName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, WindowName$)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "User32"
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetWindowLongA&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nIndex <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SetWindowLongA&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nIndex <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwNewLong <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SetWindowPos&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hWndInsertAfter <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> x <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> y <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> cx <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> cy <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> wFlags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

GWL_STYLE = -16
WS_BORDER = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>800000

<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> "No Border"
hwnd&amp; = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindow(0, "No Border" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0))

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press any key for no border...": A$ = <a href="INPUT%24.html" title="INPUT$"><span style="color:#87cefa;">INPUT$</span></a>(1)

winstyle&amp; = GetWindowLongA&amp;(hwnd&amp;, GWL_STYLE)
a&amp; = SetWindowLongA&amp;(hwnd&amp;, GWL_STYLE, winstyle&amp; <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="NOT.html" title="NOT"><span style="color:#87cefa;">NOT</span></a> WS_BORDER)
a&amp; = SetWindowPos&amp;(hwnd&amp;, 0, 0, 0, 0, 0, 39)

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press any key to get back border...": <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>

winstyle&amp; = GetWindowLongA&amp;(hwnd&amp;, GWL_STYLE)
a&amp; = SetWindowLongA&amp;(hwnd&amp;, GWL_STYLE, winstyle&amp; <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> WS_BORDER)
a&amp; = SetWindowPos&amp;(hwnd&amp;, 0, 0, 0, 0, 0, 39)

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "The end" <i> </i>
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code by Dav</span></center>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Color_Dialog_Box">Color Dialog Box</span></h2>
<center>The Color Dialog Box can set custom colors and alpha saturation levels.</center>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
' Color Dialog flag constants (use + or <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> to use more than 1 flag)
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CC_RGBINIT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1&amp; '           Sets the initial color (don't know how to set it)
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CC_FULLOPEN = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2&amp; '          Opens all dialog sections such as the custom color selector
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CC_PREVENTFULLOPEN = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4&amp; '   Prevents the user from opening the custom color selector
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CC_SHOWHELP = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>8&amp; '          Shows the help button (USELESS!)
'----------------------------------------------------------------------------------------
<a href="%24IF.html" title="$IF"><span style="color:#87cefa;">$IF</span></a> 32BIT <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> '                Checking for 32 bit IDE
<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> COLORDIALOGTYPE
  lStructSize <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '         Length of this <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> structure
  hwndOwner <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '           Dialog owner's handle
  hInstance <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '           ?
  rgbResult <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '           The RGB color the user selected
  lpCustColors <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '     Pointer to an array of 16 custom colors (will be changed by user)
  flags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '               Dialog flags
  lCustData <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '           Custom data
  lpfnHook <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '            Hook
  lpTemplateName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '   Custom template
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>
<a href="%24ELSE.html" class="mw-redirect" title="$ELSE"><span style="color:#87cefa;">$ELSE</span></a> '                         If the IDE is 64 bit then...
<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> COLORDIALOGTYPE
  lStructSize <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '   Length of this <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> structure
  hwndOwner <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '     Dialog owner's handle
  hInstance <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '     ?
  rgbResult <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '     The RGB color the user selected
  lpCustColors <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '     Pointer to an array of 16 custom colors (will be changed by user)
  flags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '         Dialog flags
  lCustData <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '     Custom data
  lpfnHook <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '      Hook
  lpTemplateName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '   Custom template
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>
<a href="%24END_IF.html" class="mw-redirect" title="$END IF"><span style="color:#87cefa;">$END IF</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ColorString <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> * 64
ColorString = "FFFFFFFFFF" 'not sure how this works?

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "comdlg32"
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> ChooseColorA&amp; (DIALOGPARAMS <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> COLORDIALOGTYPE) '    Yet the also famous color dialog box
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a>
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindow&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> ClassName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, WindowName$) ' To get hWnd handle, or use <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a>
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="SCREEN.html" title="SCREEN"><span style="color:#87cefa;">SCREEN</span></a> <a href="NEWIMAGE.html" title="NEWIMAGE"><span style="color:#87cefa;">_NEWIMAGE</span></a>(640, 480, 12) '32 or 16 or 256 color screen modes
<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> "Color Common Dialog demo" 'set Title of program
hWnd&amp; = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindow(0, "Color Common Dialog demo" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)) 'get window handle using <a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> string

clr~&amp; = ChooseColor&amp;(<a href="RGB32.html" title="RGB32"><span style="color:#87cefa;">_RGB32</span></a>(0, 0, 0), ColorString$, Cancel, CC_FULLOPEN, hWnd&amp;)

<a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a> , clr~&amp; 'make background chosen color
<a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 10, 31
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> Cancel &lt;&gt; -1 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> <a href="RGB.html" title="RGB"><span style="color:#87cefa;">_RGB</span></a>(255, 255, 255) 'white text
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Color:"; clr~&amp;; "<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>" + <a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(clr~&amp;) '  use last color chosen
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> ColorString$ '              display user custom color values chosen
<a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "No color was chosen!"
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> ChooseColor&amp; (InitialColor&amp;, CustomColors$, Cancel, Flags&amp;, hWnd&amp;)
' Parameters:
'  InitialColor&amp;  - The initial color used, will take effect if CC_RGBINIT flag is specified
'  CustomColors$  - A 64-byte string where the user's custom colors will be stored (4 bytes per color in RGB0 format).
'  Cancel         - Variable where the cancel flag will be stored.
'  Flags&amp;         - Dialog flags
'  hWnd&amp;          - Your program's window handle that should be aquired by the FindWindow function.

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ColorCall <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> COLORDIALOGTYPE

ColorCall.rgbResult = <a href="RGB32.html" title="RGB32"><span style="color:#87cefa;">_RGB32</span></a>(<a href="BLUE32.html" title="BLUE32"><span style="color:#87cefa;">_BLUE32</span></a>(InitialColor&amp;), <a href="GREEN32.html" title="GREEN32"><span style="color:#87cefa;">_GREEN32</span></a>(InitialColor&amp;), <a href="RED32.html" title="RED32"><span style="color:#87cefa;">_RED32</span></a>(InitialColor&amp;))
ColorCall.lStructSize = <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(ColorCall)
ColorCall.hwndOwner = hWnd&amp;
ColorCall.flags = Flags&amp;
ColorCall.lpCustColors = <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(CustomColors$)

' Do dialog call
Result = ChooseColorA(ColorCall)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> Result <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  rgbResult&amp; = ColorCall.rgbResult
  ' Swap RED and BLUE color intensity values using <a href="RGB.html" title="RGB"><span style="color:#87cefa;">_RGB</span></a>
  ChooseColor&amp; = <a href="RGB.html" title="RGB"><span style="color:#87cefa;">_RGB</span></a>(<a href="BLUE32.html" title="BLUE32"><span style="color:#87cefa;">_BLUE32</span></a>(rgbResult&amp;), <a href="GREEN32.html" title="GREEN32"><span style="color:#87cefa;">_GREEN32</span></a>(rgbResult&amp;), <a href="RED32.html" title="RED32"><span style="color:#87cefa;">_RED32</span></a>(rgbResult&amp;))
<a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
  Cancel = -1
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Adapted from code by Jobert14</span></center>
<dl><dd><i>Note:</i> The ChooseColor value is converted using <a href="RGB32.html" title="RGB32">_RGB32</a> with the Blue and Red values being swapped.</dd></dl>
<p><br />
</p>
<center><b>Converting 32 bit Dialog Box Color values for 4 or 8 BPP Screen modes</b></center>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: courier; background-color: lightgrey; color: black;"> <i> </i>
<a href="SCREEN.html" title="SCREEN"><span style="color:blue;">SCREEN</span></a> <a href="NEWIMAGE.html" title="NEWIMAGE"><span style="color:blue;">_NEWIMAGE</span></a>(640, 480, 12) 'change from screen 12 to 32 to see the difference
rgbresult&amp; = <a href="%26H.html" title="&amp;H"><span style="color:blue;">&amp;H</span></a>8080FF 'Dialog box long color reverse <a href="HEX%24.html" title="HEX$"><span style="color:blue;">HEX$</span></a> return value
clr~&amp; = <a href="RGB.html" title="RGB"><span style="color:blue;">_RGB</span></a>(<a href="BLUE32.html" title="BLUE32"><span style="color:blue;">_BLUE32</span></a>(rgbresult&amp;), <a href="GREEN32.html" title="GREEN32"><span style="color:blue;">_GREEN32</span></a>(rgbresult&amp;), <a href="RED32.html" title="RED32"><span style="color:blue;">_RED32</span></a>(rgbresult&amp;)) 'swap red and blue
<a href="COLOR.html" title="COLOR"><span style="color:blue;">COLOR</span></a> clr~&amp;: <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> clr~&amp;, <a href="HEX%24.html" title="HEX$"><span style="color:blue;">HEX$</span></a>(clr~&amp;) '_UNSIGNED LONG color values<i> </i>
</p>
<dl><dd><i>Note:</i> The <a href="RGB.html" title="RGB">_RGB</a> value returned is full <a href="ALPHA.html" title="ALPHA">_ALPHA</a>. Use _ALPHA or <a href="RGBA.html" title="RGBA">_RGBA</a> to set the transparency in a program.</dd></dl>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<p><br />
</p>
<h2><span class="mw-headline" id="Desktop_Size">Desktop Size</span></h2>
<dl><dd>Returns the Left, Top, Right and Bottom coordinates of the current desktop area.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SystemParametersInfoW&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> uiAction~&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> uiParam~&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> pvParam%&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> fWinlni~&amp;)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SPI_GETWORKAREA = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30

<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> RECT
    left <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    top <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    right <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    bottom <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> Rec <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> RECT

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> 0 = SystemParametersInfoW(SPI_GETWORKAREA, 0, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(Rec), 0) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    'function failed. You may call kernel32's GetLastError for more info.
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "failed."
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> Rec.left
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> Rec.top
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> Rec.right
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> Rec.bottom
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
scr&amp; = <a href="SCREENIMAGE.html" title="SCREENIMAGE"><span style="color:#87cefa;">_SCREENIMAGE</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="WIDTH_(function).html" title="WIDTH (function)"><span style="color:#87cefa;">_WIDTH</span></a>(scr&amp;)
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="HEIGHT.html" title="HEIGHT"><span style="color:#87cefa;">_HEIGHT</span></a>(scr&amp;)
<a href="FREEIMAGE.html" title="FREEIMAGE"><span style="color:#87cefa;">_FREEIMAGE</span></a> scr&amp;

<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Directory_Environment">Directory Environment</span></h2>
<dl><dd>Returns various system environment settings including the current program's EXE name.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"><i> </i>                                 
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a>   'Directory Information using KERNEL32 provided by Dav
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> WINDirectory <a href="ALIAS.html" class="mw-redirect" title="ALIAS"><span style="color:#87cefa;">ALIAS</span></a> GetWindowsDirectoryA (lpBuffer <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nSize <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SYSDirectory <a href="ALIAS.html" class="mw-redirect" title="ALIAS"><span style="color:#87cefa;">ALIAS</span></a> GetSystemDirectoryA (lpBuffer <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nSize <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> CURDirectory <a href="ALIAS.html" class="mw-redirect" title="ALIAS"><span style="color:#87cefa;">ALIAS</span></a> GetCurrentDirectoryA (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nBufferLen <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, lpBuffer <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>)
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> TempPath <a href="ALIAS.html" class="mw-redirect" title="ALIAS"><span style="color:#87cefa;">ALIAS</span></a> GetTempPathA (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nBufferLen <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, lpBuffer <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>)
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetModuleFileNameA (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hModule <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, lpFileName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nSize <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>) 
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

'=== SHOW WINDOWS DIRECTORY
WinDir$ = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(144)
Result = WINDirectory(WinDir$, <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(WinDir$))
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> Result <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "<a href="WINDOW.html" title="WINDOW"><span style="color:#87cefa;">WINDOW</span></a>S DIRECTORY: "; <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(WinDir$, Result)

'=== SHOW SYSTEM DIRECTORY
SysDir$ = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(144)
Result = SYSDirectory(SysDir$, <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(SysDir$))
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> Result <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "<a href="SYSTEM.html" title="SYSTEM"><span style="color:#87cefa;">SYSTEM</span></a> DIRECTORY: "; <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(SysDir$, Result)

'=== SHOW CURRENT DIRECTORY
CurDir$ = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(255)
Result = CURDirectory(<a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(CurDir$), CurDir$)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> Result <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "CURRENT DIRECTORY: "; <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(CurDir$, Result)

'=== SHOW TEMP DIRECTORY
TempDir$ = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(100)
Result = TempPath(<a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(TempDir$), TempDir$)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> Result <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "TEMP DIRECTORY: "; <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(TempDir$, Result)

'=== SHOW CURRENT PROGRAM
FileName$ = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(256)
Result = GetModuleFileNameA(0, FileName$, <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(FileName$))
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> Result <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "CURRENT PROGRAM: "; <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(FileName$, Result)
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Windows APIs courtesy of Dav</span></center>
<p><br />
</p>
<dl><dd>Returns the DOS 8.3 path and file name. The DLL used is in the QB64 folder.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;">
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a>   'Directory Information using KERNEL32
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetShortPathNameA (lpLongPath <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, lpShortPath <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> cBufferLen <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

'=== SHOW SHORT PATH NAME
FileOrPath$ = "c:\qb64\SDL_image.dll"  '&lt;&lt; change to a relevant path or file name on computer
ShortPathName$ = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(260)
Result = GetShortPathNameA(FileOrPath$ + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0), ShortPathName$, <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(ShortPathName$))
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> Result <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "SHORT PATH NAME: " + ShortPathName$ <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "NOT Found!"
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Courtesy of Dav</span></center>
<h2><span class="mw-headline" id="Disk_Drives">Disk Drives</span></h2>
<p>Uses Kernel32 API to lists all available drives on system. Shows the drives type: HD/CD/DVD/RAM/NET/Removable/Unknown
</p>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REMOVABLE = 2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FIXED = 3
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REMOTE = 4
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CDROM = 5
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> RAMDISK = 6

<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a>
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetDriveTypeA&amp; (nDrive <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetLogicalDriveStringsA (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nBuff <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, lpbuff <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> DList <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, DL <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> i <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, typ <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

i = GetLogicalDriveStringsA(0, DList) 'zero returns the drive string byte size
DList = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(i) 'set drive string length. Each drive is followed by CHR$(0)
i = GetLogicalDriveStringsA(i, DList) 'the byte size returns a string that long
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> DList

<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> n = 65 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> 90
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(DList, <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(n)) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    DL = <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(n) + ":\" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
    typ = GetDriveTypeA(DL)
    <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> typ
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REMOVABLE: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> DL + "Removable"
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> FIXED: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> DL + "Fixed"
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REMOTE: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> DL + "Remote"
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> CDROM: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> DL + "CDROM"
      <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> RAMDISK: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> DL + "RAM"
    <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Adapted from code by Dav</span></center>
<dl><dd><i>Note:</i> The length of the string returned by <i>GetLogicalDriveStringsA</i> can be divided by 4 to tell the number of physical and ram drives.</dd></dl>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="File_Attributes">File Attributes</span></h2>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"><a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a>
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetFileAttributes&amp; (f$)
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SetFileAttributes&amp; (f$, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> attrib&amp;)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> INVALID_FILE_ATTRIBUTES = -1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FILE_ATTRIBUTE_<a href="READ.html" title="READ"><span style="color:#87cefa;">READ</span></a>ONLY = 1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FILE_ATTRIBUTE_HIDDEN = 2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FILE_ATTRIBUTE_<a href="SYSTEM.html" title="SYSTEM"><span style="color:#87cefa;">SYSTEM</span></a> = 4
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FILE_ATTRIBUTE_DIRECTORY = 16
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FILE_ATTRIBUTE_ARCHIVE = 32

file$ = "temp.txt"

a = GetFileAttributes(file$)
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> a 'if no file, then you'll see a -1 here

<a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a> file$ <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> <a href="OUTPUT.html" class="mw-redirect" title="OUTPUT"><span style="color:#87cefa;">OUTPUT</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> #1
<a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> #1

a = GetFileAttributes(file$)
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> a 'a new file, it prints 32 for me here

x = SetFileAttributes(file$, 1) 'set the read only flag
a = GetFileAttributes(file$)
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> a 'notice, it prints 1 here and not 32.  We didn't add a flag, we changed it completel
</p>
<p><br />
</p>
<h2><span class="mw-headline" id="File_Open_and_Save_Dialog">File Open and Save Dialog</span></h2>
<center><b>Open and Save Dialog Boxes get file names</b></center>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
' Dialog flag constants (use + or <a href="OR.html" title="OR"><span style="color:#87cefa;">OR</span></a> to use more than 1 flag value)
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_ALLOWMULTISELECT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>200&amp; '  Allows the user to select more than one file, not recommended!
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_CREATEPROMPT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2000&amp; '     Prompts if a file not found should be created(GetOpenFileName only).
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_EXTENSIONDIFFERENT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>400&amp; 'Allows user to specify file extension other than default extension.
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_FILEMUSTEXIST = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1000&amp; '    Chechs File name exists(GetOpenFileName only).
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_HIDEREADONLY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4&amp; '        Hides read-only checkbox(GetOpenFileName only)
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_NOCHANGEDIR = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>8&amp; '         Restores the current directory to original value if user changed
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_NODEREFERENCELINKS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>100000&amp; 'Returns path and file name of selected shortcut(.LNK) file instead of file referenced.
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_NONETWORKBUTTON = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20000&amp; ' Hides and disables the Network button.
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_NOREADONLYRETURN = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>8000&amp; ' Prevents selection of read-only files, or files in read-only subdirectory.
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_NOVALIDATE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>100&amp; '        Allows invalid file name characters.
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_OVERWRITEPROMPT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2&amp; '     Prompts if file already exists(GetSaveFileName only)
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_PATHMUSTEXIST = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>800&amp; '     Checks Path name exists (set with OFN_FILEMUSTEXIST).
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_READONLY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1&amp; '            Checks read-only checkbox. Returns if checkbox is checked
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_SHAREAWARE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4000&amp; '       Ignores sharing violations in networking
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OFN_SHOWHELP = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10&amp; '           Shows the help button (useless!)
'--------------------------------------------------------------------------------------------

<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> FILEDIALOGTYPE
    <a href="%24IF.html" title="$IF"><span style="color:#87cefa;">$IF</span></a> 32BIT <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>

    lStructSize <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '        For the DLL call
    hwndOwner <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '          Dialog will hide behind window when not set correctly
    hInstance <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '          Handle to a module that contains a dialog box template.
    lpstrFilter <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '     Pointer of the string of file filters
    lpstrCustFilter <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
    nMaxCustFilter <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    nFilterIndex <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '       One based starting filter index to use when dialog is called
    lpstrFile <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '       String full of 0's for the selected file name
    nMaxFile <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '           Maximum length of the string stuffed with 0's minus 1
    lpstrFileTitle <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '  Same as lpstrFile
    nMaxFileTitle <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '      Same as nMaxFile
    lpstrInitialDir <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> ' Starting directory
    lpstrTitle <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '      Dialog title
    flags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '              Dialog flags
    nFileOffset <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a> '     Zero-based offset from path beginning to file name string pointed to by lpstrFile
    nFileExtension <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a> '  Zero-based offset from path beginning to file extension string pointed to by lpstrFile.
    lpstrDefExt <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '     Default/selected file extension
    lCustData <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    lpfnHook <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    lpTemplateName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
    <a href="%24ELSE.html" class="mw-redirect" title="$ELSE"><span style="color:#87cefa;">$ELSE</span></a>
        lStructSize <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '           For the DLL call
        hwndOwner <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '          Dialog will hide behind window when not set correctly
        hInstance <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '          Handle to a module that contains a dialog box template.
        lpstrFilter <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '        Pointer of the string of file filters
        lpstrCustFilter <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
        nMaxCustFilter <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '       LONG tu a o radek niz =&gt; je vyber pripony
        nFilterIndex <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '         One based starting filter index to use when dialog is called    TOTO nefunguje
        lpstrFile <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '          String full of 0's for the selected file name
        nMaxFile <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '              Maximum length of the string stuffed with 0's minus 1       zmena z offset
        lpstrFileTitle <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '     Same as lpstrFile
        nMaxFileTitle <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> _<a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">INTEGER64</span></a> '      Same as nMaxFile
        lpstrInitialDir <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '    Starting directory
        lpstrTitle <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '         Dialog title
        flags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '                 Dialog flags
        nFileOffset <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '     Zero-based offset from path beginning to file name string pointed to by lpstrFile
        nFileExtension <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a> '  Zero-based offset from path beginning to file extension string pointed to by lpstrFile.
        lpstrDefExt <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '        Default/selected file extension
        lCustData <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a>
        lpfnHook <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a>
        lpTemplateName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
   <a href="%24END_IF.html" class="mw-redirect" title="$END IF"><span style="color:#87cefa;">$END IF</span></a>
<a href="END_TYPE.html" title="END TYPE"><span style="color:#87cefa;">END TYPE</span></a>

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "comdlg32"    ' Library declarations using _OFFSET types
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetOpenFileNameA&amp; (DIALOGPARAMS <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> FILEDIALOGTYPE) ' The Open file dialog
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetSaveFileNameA&amp; (DIALOGPARAMS <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> FILEDIALOGTYPE) ' The Save file dialog
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> "FileOpen Common Dialog demo" 'set Title of program 
hWnd&amp; = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'get window handle

' Do the Open File dialog call!
Filter$ = "Batch files (*.bat)|*.BAT|JPEG images (*.jpg)|*.JPG|All files (*.*)|*.*"
Flags&amp; = OFN_FILEMUSTEXIST + OFN_NOCHANGEDIR + OFN_READONLY  '    add flag constants here
OFile$ = GetOpenFileName$("YEAH! Common Dialogs in QB64!!!", ".\", Filter$, 1, Flags&amp;, hWnd&amp;)

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> OFile$ = "" <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">THEN</span></a>   ' Display Open dialog results
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Shame on you! You didn't pick any file..."
<a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "You picked this file: "
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> OFile$
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> (Flags&amp; <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> OFN_READONLY) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Read-only checkbox checked." 'read-only value in return
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">END IF</span></a>

<a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 5 ' Do the Save File dialog call!
Filter$ = "Basic files (*.bas)|*.BAS|All files (*.*)|*.*"
Flags&amp; = OFN_OVERWRITEPROMPT + OFN_NOCHANGEDIR '   add flag constants here
SFile$ = GetSaveFileName$("Save will not create a file!!!", ".\", Filter$, 1, Flags&amp;, hWnd&amp;)

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> SFile$ = "" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>     ' Display Save dialog results
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "You didn't save the file..."
<a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "You saved this file: "
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> SFile$
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">END IF</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> 

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetOpenFileName$ (Title$, InitialDir$, Filter$, FilterIndex&amp;, Flags&amp;&amp;, hWnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER64.html" title="INTEGER64"><span style="color:#87cefa;">_INTEGER64</span></a>)
    '  Title$      - The dialog title.
    '  InitialDir$ - If this left blank, it will use the directory where the last opened file is
    '  located. Specify ".\" if you want to always use the current directory.
    '  Filter$     - File filters separated by pipes (|) in the same format as using VB6 common dialogs.
    '  FilterIndex - The initial file filter to use. Will be altered by user during the call.
    '  Flags&amp;      - Dialog flags. Will be altered by the user during the call.
    '  hWnd&amp;       - Your program's window handle that should be aquired by the FindWindow function.
    '
    ' Returns: Blank when cancel is clicked otherwise, the file name selected by the user.
    ' FilterIndex and Flags&amp; will be changed depending on the user's selections.
 
    hWnd = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> OpenCall <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> FILEDIALOGTYPE ' Needed for dialog call
Title$ = Title$ + CHR$(0)
fFilter$ = Filter$
<a href="FOR.html" class="mw-redirect" title="FOR"><span style="color:#87cefa;">FOR</span></a> R = 1 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(fFilter$) ' Replace the pipes with character zero
<a href="IF.html" class="mw-redirect" title="IF"><span style="color:#87cefa;">IF</span></a> MID$(fFilter$, R, 1) = "|" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> MID$(fFilter$, R, 1) = CHR$(0)
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a> R
fFilter$ = fFilter$ + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
 
lpstrFile$ = <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(2048, 0) ' For the returned file name
lpstrDefExt$ = <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(10, 0) ' Extension will not be added when this is not specified
OpenCall.lStructSize = <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(OpenCall)
OpenCall.hwndOwner = hWnd&amp;&amp;
OpenCall.lpstrFilter = <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>(fFilter$)
OpenCall.nFilterIndex = FilterIndex&amp;
OpenCall.lpstrFile = <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>(lpstrFile$)
OpenCall.nMaxFile = <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(lpstrFile$) - 1
OpenCall.lpstrFileTitle = OpenCall.lpstrFile
OpenCall.nMaxFileTitle = OpenCall.nMaxFile
OpenCall.lpstrInitialDir = <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>(InitialDir$)
OpenCall.lpstrTitle = <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>(Title$)
OpenCall.lpstrDefExt = <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>(lpstrDefExt$)
OpenCall.flags = Flags&amp;&amp;
 
Result = GetOpenFileNameA&amp;&amp;(OpenCall) '            Do Open File dialog call!

<a href="IF.html" class="mw-redirect" title="IF"><span style="color:#87cefa;">IF</span></a> Result <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> ' Trim the remaining zeros
GetOpenFileName$ = <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(lpstrFile$, <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(lpstrFile$, <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)) - 1)
Flags&amp; = OpenCall.flags
FilterIndex = OpenCall.nFilterIndex
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
 
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>
 
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetSaveFileName$ (Title$, InitialDir$, Filter$, FilterIndex&amp;, Flags&amp;, hWnd&amp;&amp;)
'  Title$      - The dialog title.
'  InitialDir$ - If this left blank, it will use the directory where the last opened file is
'     located. Specify ".\" if you want to always use the current directory.
'  Filter$     - File filters separated by pipes (|) in the same format as VB6 common dialogs.
'  FilterIndex - The initial file filter to use. Will be altered by user during the call.
'  Flags&amp;      - Dialog flags. Will be altered by the user during the call.
'  hWnd&amp;       - Your program's window handle that should be aquired by the FindWindow function.
 
' Returns: Blank when cancel is clicked otherwise, the file name entered by the user.
' FilterIndex and Flags&amp; will be changed depending on the user's selections.
 
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> SaveCall <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> FILEDIALOGTYPE ' Needed for dialog call
Title$ = Title$ + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
fFilter$ = Filter$
<a href="FOR.html" class="mw-redirect" title="FOR"><span style="color:#87cefa;">FOR</span></a> R = 1 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(fFilter$) ' Replace the pipes with zeros
<a href="IF.html" class="mw-redirect" title="IF"><span style="color:#87cefa;">IF</span></a> <a href="MID%24.html" title="MID$"><span style="color:#87cefa;">MID$</span></a>(fFilter$, R, 1) = "|" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="MID%24.html" title="MID$"><span style="color:#87cefa;">MID$</span></a>(fFilter$, R, 1) = <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a> R
fFilter$ = fFilter$ + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
 
lpstrFile$ = <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(2048, 0) ' For the returned file name
lpstrDefExt$ = <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(10, 0) ' Extension will not be added when this is not specified

SaveCall.lStructSize = <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(SaveCall)
SaveCall.hwndOwner = hWnd&amp;&amp;
SaveCall.lpstrFilter = <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>(fFilter$)
SaveCall.nFilterIndex = FilterIndex&amp;
SaveCall.lpstrFile = <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>(lpstrFile$)
SaveCall.nMaxFile = <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(lpstrFile$) - 1
SaveCall.lpstrFileTitle = SaveCall.lpstrFile
SaveCall.nMaxFileTitle = SaveCall.nMaxFile
SaveCall.lpstrInitialDir = <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>(InitialDir$)
SaveCall.lpstrTitle = <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>(Title$)
SaveCall.lpstrDefExt = <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>(lpstrDefExt$)
SaveCall.flags = Flags&amp;
Result&amp; = GetSaveFileNameA&amp;&amp;(SaveCall) ' Do dialog call!
 
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> Result&amp; <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">THEN</span></a> ' Trim the remaining zeros
rem  print _trim$(lpstrfile$), ffilter$, filterindex
GetSaveFileName$ = <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(lpstrFile$, <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(lpstrFile$, <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)) - 1)
Flags&amp;&amp; = SaveCall.flags
FilterIndex&amp; = SaveCall.nFilterIndex
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">END IF</span></a>

<a href="%24IF.html" title="$IF"><span style="color:#87cefa;">$IF</span></a> 64BIT <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
count = filterindex&amp;
s$ = filter$

<a href="FOR.html" class="mw-redirect" title="FOR"><span style="color:#87cefa;">FOR</span></a> d = 1 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> count
    separator = <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(s$, "*")
    s$ = <a href="RIGHT%24.html" title="RIGHT$"><span style="color:#87cefa;">RIGHT$</span></a>(s$, <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(s$) - separator)
    ext$ = <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(s$, 4)
    <a href="IF.html" class="mw-redirect" title="IF"><span style="color:#87cefa;">IF</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(ext$) &gt; 4 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> ext$ = <a href="MID%24.html" title="MID$"><span style="color:#87cefa;">MID$</span></a>(ext$, 1, 4)
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
<a href="IF.html" class="mw-redirect" title="IF"><span style="color:#87cefa;">IF</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(getsavefilename$) &gt; 0 <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> <a href="RIGHT%24.html" title="RIGHT$"><span style="color:#87cefa;">RIGHT$</span></a>(getsavefilename$, 4) &lt;&gt; ext$ <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> getsavefilename$ = getsavefilename$ + ext$
$end if
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Jobert14 with Edits from Petr</span></center>
<dl><dd><i>Note:</i> The Open and Save Dialog boxes get user selections and do not actually open or create a file! Your program must do that.</dd></dl>
<center><b><a rel="nofollow" class="external text" href="http://msdn.microsoft.com/en-us/library/aa155724(v=office.10).aspx">Microsoft MSDN</a></b>
<p><br />
</p>
<b><a rel="nofollow" class="external text" href="http://msdn.microsoft.com/en-us/library/aa259317(v=vs.60).aspx">Common Dialog Flag Constants</a></b></center>
<dl><dd><dl><dd><dl><dd><dl><dd><dl><dd>In VB6, variable-length strings in user <a href="TYPE.html" title="TYPE">TYPEs</a> are actually pointer <a href="OFFSET.html" title="OFFSET">_OFFSETs</a> to those strings.</dd></dl></dd></dl></dd></dl></dd></dl></dd></dl>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<p><br />
</p>
<h2><span class="mw-headline" id="File_Times">File Times</span></h2>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> GENERIC_READ = -<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> GENERIC_WRITE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>40000000
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FILE_SHARE_READ = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FILE_SHARE_WRITE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> OPEN_EXISTING = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>3
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> INVALID_HANDLE_VALUE = -1

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "kernel32"
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> CreateFileA%&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpFileName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwDesiredAccess <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, _
<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwShareMode <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpSecurityAttributes <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, _
<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwCreationDisposition <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwFlagsAndAttributes <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, _
<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hTemplateFile <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> CloseHandle&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hObject <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetFileTime&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hFile <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpCreationTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpLastAccessTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpLastWriteTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SetFileTime&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hFile <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpCreationTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpLastAccessTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpLastWriteTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FileTimeToLocalFileTime&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpFileTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpLocalFileTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> LocalFileTimeToFileTime&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpLocalFileTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpFileTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FileTimeToSystemTime&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpFileTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpSystemTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SystemTimeToFileTime&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpSystemTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpFileTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetLastError&amp; ()
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> FILETIME
  dwLowDateTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  dwHighDateTime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>

<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> SYSTEMTIME
  wYear <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
  wMonth <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
  wDayOfWeek <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
  wDay <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
  wHour <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
  wMinute <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
  wSecond <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
  wMilliseconds <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> CreateDate <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> FILETIME
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ModifyDate <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> FILETIME
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> AccessDate <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> FILETIME

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> systime <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> SYSTEMTIME

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> FileName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> FileHandle <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>

FileName = "readme.txt" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0) '&lt;&lt;&lt;&lt;&lt;&lt; Existing file in QB64 folder. Use existing file path!

FileHandle = CreateFileA%&amp;(<a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(FileName), GENERIC_<a href="READ.html" title="READ"><span style="color:#87cefa;">READ</span></a>, FILE_SHARE_<a href="READ.html" title="READ"><span style="color:#87cefa;">READ</span></a> <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> FILE_SHARE_<a href="WRITE.html" title="WRITE"><span style="color:#87cefa;">WRITE</span></a>, 0, <a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a>_EXISTING, 0, 0)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> FileHandle &lt;&gt; INVALID_HANDLE_VALUE <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetFileTime&amp;(FileHandle, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(CreateDate), <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(ModifyDate), <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(AccessDate)) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(CreateDate.dwLowDateTime) + <a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(CreateDate.dwHighDateTime)
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(ModifyDate.dwLowDateTime) + <a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(ModifyDate.dwHighDateTime)
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(AccessDate.dwLowDateTime) + <a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(AccessDate.dwHighDateTime)
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> FileTimeToSystemTime&amp;(<a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(CreateDate), <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(systime)) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
      <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Creation time, in GMT, in decimal:"
      <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Year:"; systime.wYear
      <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Month:"; systime.wMonth, "("; <a href="MID%24.html" title="MID$"><span style="color:#87cefa;">MID$</span></a>("JanFebMarAprMayJunJulAugSepOctNovDec", (systime.wMonth * 3) - 2, 3); ")"
      <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "DayOfWeek:"; systime.wDayOfWeek, "("; <a href="MID%24.html" title="MID$"><span style="color:#87cefa;">MID$</span></a>("SunMonTueWedThuFriSat", (systime.wDayOfWeek * 3) + 1, 3); ")"
      <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Day"; systime.wDay
      <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Hour"; systime.wHour
      <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Minute"; systime.wMinute
      <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Second"; systime.wSecond
      <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Milliseconds"; systime.wMilliseconds
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
      <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "FileTimeToSystemTime failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError&amp;))
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "GetFileTime failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError&amp;))
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> CloseHandle&amp;(FileHandle) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "CloseHandle failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError&amp;))
    <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "CreateFileA failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError&amp;))
  <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Michael Calkins</span></center>
<center>Use your own existing file name and path in this procedure.</center>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<p><br />
</p>
<h2><span class="mw-headline" id="Focus">Focus</span></h2>
<dl><dd><b>Sets Focus on program with <i>SetForegroundWindow</i> after maximizing a minimized program when Shift+A is pressed.</b> (See <a href="Windows_Libraries.html#Top_Most_Window" title="Windows Libraries">Top Most Window</a>)</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;">
'Uses GetKeyState Win API to monitor a Key state.
'This demo will maximize the window and focus on program when Shift+A is pressed.

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindowA%&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> ClassName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, WindowName$) 'find process handle by title
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetKeyState% (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nVirtKey <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>) 'Windows virtual key presses
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> ShowWindow&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nCmdShow <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>) 'maximize process
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetForegroundWindow%&amp; 'find currently focused process handle
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SetForegroundWindow&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>) 'set foreground window process(focus)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

title$ = "Cheapo Hotkey (Shift+A)" 'title of program window
<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> title$ 'set program title
hwnd%&amp; = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindowA(0, title$ + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)) 'find this program's process handle

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Minimize window, click another then Press Shift+A to bring it back up."

'=== below minimizes it for you
<a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 4
x&amp; = ShowWindow&amp;(hwnd%&amp;, 2)
'===========================

<a href="DO.html" class="mw-redirect" title="DO"><span style="color:#87cefa;">DO</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetKeyState(16) &lt; 0 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> GetKeyState(<a href="ASC.html" title="ASC"><span style="color:#87cefa;">ASC</span></a>("A")) &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> '&lt;==== Shift+A
    FGwin%&amp; = GetForegroundWindow%&amp; 'get current process in focus
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Program Handle:"; hwnd%&amp;; "Focus handle:"; FGwin%&amp;

    y&amp; = ShowWindow&amp;(hwnd%&amp;, 1) 'maximize minimized program

    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> FGwin%&amp; &lt;&gt; hwnd%&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> z&amp; = SetForegroundWindow&amp;(hwnd%&amp;) 'set focus when necessary

    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "That is all. Return values:"; x&amp;; y&amp;; z&amp;
    
    'PUT PROGRAM CODE OR SUB CALLS HERE! 
    '=== below minimizes it for you again after code is done
    '<a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 4
    'x&amp; = ShowWindow&amp;(hwnd%&amp;, 2)
    '===========================    
    <a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 5: <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> 'delay allows user to not minimize the window
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

  <a href="LIMIT.html" title="LIMIT"><span style="color:#87cefa;">_LIMIT</span></a> 30 'save CPU usage while waiting for key press

<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <i> </i>
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Adapted by Ted Weissgerber from code by Dav</span></center>
<center>The <i><a href="Windows_Libraries.html#Window_Focus" title="Windows Libraries">GetForegroundWindow</a></i> function finds the process currently in focus. See: <a href="Windows_Libraries.html#Hot_Keys_.28maximize.29" title="Windows Libraries">Hot Keys for Windows Virtual Keys</a></center>
<p><br />
</p>
<dl><dd><b>Always brings unfocused or minimized program to the top with focus when Shift+A hotkey combination is pressed.</b></dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'===========
'HOTKEYS.BAS
'===========
'Windows Hotkey example.
'This demo sets Shift+A hotkey to maximize the program window when minimized.
'Returns focus to the program.
'Coded by Dav JULY/2012


<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE CUSTOMTYPE LIBRARY</span></a>
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindow&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> ClassName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, WindowName$)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> ShowWindow&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nCmdShow <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>
<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SendMessageA&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> wMsg <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> wParam <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lParam <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> DefWindowProcA&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> wMsg <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> wParam <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lParam <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> "My Focus Program"
hwnd = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindow(0, "My Focus Program" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)) 'get Windows program ID by title

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> WM_SETHOTKEY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>32
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> WM_SHOWWINDOW = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>18
'SendMessage function key combination values
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HK_SHIFT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>100 'NOTE: Send Message values are different than HotKey
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HK_CTRL = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>200  'All other keys are the same as the HotKey values.
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HK_ALT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>400

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press Shift+A to maximize or bring this window to top..."
<a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 3

'=== Tell windows what hotkey you want to use.
hot&amp; = SendMessageA&amp;(hwnd, WM_SETHOTKEY, HK_SHIFT + ASC("A"), 0) 'use uppercase second key 
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> hot&amp;;
'=== See if hotkey set ok...
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> hot&amp; &lt;&gt; 1 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Hotkey not set." + "Error: "; hot&amp;
  <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

'===  minimize program with this
'a&amp; = ShowWindow&amp;(hwnd, 6)

'=== Below tells Windows what to do when hotkey is pressed.
'===(it maximizes the program window and returns focus over and over).
top&amp; = DefWindowProcA&amp;(hwnd, WM_SHOWWINDOW, 0, 0)

<a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LIMIT.html" title="LIMIT"><span style="color:#87cefa;">_LIMIT</span></a> 1
  'do your program stuff here....
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> hot&amp;; top&amp;;
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a> = <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(27) 
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Adapted from code by Dav</span></center>
<dl><dd><b>Note:</b> The <i>SetHotKey</i> message tells the designated Windows program ID when to do <i>DefWondowProcA</i> to focus the window.</dd></dl>
<center><b>This can also focus on other program IDs! See also: <a href="Windows_Libraries.html#Hot_Keys_.28maximize.29" title="Windows Libraries">Hot Keys for Windows Virtual Keys</a></b></center>
<p><br />
</p>
<center>Note: Minimized programs will always lose focus when minimized unless clicked in taskbar.</center>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<p><br />
</p>
<h2><span class="mw-headline" id="Folder_Dialog_Box">Folder Dialog Box</span></h2>
<dl><dd>The SHBrowseForFolder function receives information about the folder selected by the user in Windows XP to 7.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i> 
<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE CUSTOMTYPE LIBRARY</span></a>
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindow&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> ClassName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, WindowName$)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> "Super Window"
hwnd&amp; = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindow(0, "Super Window" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0))

<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> BROWSEINFO  'typedef struct _browseinfo 'Microsoft MSDN
  hwndOwner <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '              '  HWND 
  pidlRoot <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '             '  PCIDLIST_ABSOLUTE
  pszDisplayName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '      '  LPTSTR 
  lpszTitle <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '           '  LPCTSTR       
  ulFlags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>        '  UINT   
  lpfn <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '                '  BFFCALLBACK  
  lParam <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> '              '  LPARAM  
  iImage <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '                 '  int  
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>  'BROWSEINFO, *PBROWSEINFO, *LPBROWSEINFO;

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "shell32"
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SHBrowseForFolder%&amp; (x <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> BROWSEINFO) 'Microsoft MSDN
  <a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> SHGetPathFromIDList (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpItem <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> szDir <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>) 'Microsoft MSDN
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> b <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> BROWSEINFO
b.hwndOwner = hwnd
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> s <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> * 1024
b.pszDisplayName = <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(s$)
a$ = "Choose a folder!!!" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
b.lpszTitle = <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(a$)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> o <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
o = SHBrowseForFolder(b)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> o <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(s$, <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(s$, <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)) - 1)
    <a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> s2 <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> * 1024
    SHGetPathFromIDList o, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(s2$)
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(s2$, <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(s2$, <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)) - 1)
<a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Cancel?"
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a> <i> </i> 
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code by Galleon</span></center>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Font_Dialog_Box">Font Dialog Box</span></h2>
<center>This dialog box does not return the actual font file name. Refer to the <a href="Windows_Libraries.html#Registered_Fonts" title="Windows Libraries">Registered Fonts File</a> procedure below this one.</center>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
' Constants assigned to Flags. A LONG numerical suffix defines those constants as LONG
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_APPLY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>200&amp; '             Displays Apply button
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_ANSIONLY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>400&amp; '          list ANSI fonts only
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_BOTH = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>3&amp; '                list both Screen and Printer fonts
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_EFFECTS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>100&amp;  '          Display Underline and Strike Through boxes
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_ENABLEHOOK = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>8&amp; '          set hook to custom template
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_ENABLETEMPLATE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10&amp; '     enable custom template
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_ENABLETEMPLATEHANDLE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20&amp; 
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_FIXEDPITCHONLY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4000&amp;  '  list only fixed-pitch fonts
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_FORCEFONTEXIST = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10000&amp; '  indicate error when font not listed is chosen
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_INACTIVEFONTS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2000000&amp; ' display hidden fonts in Win 7 only
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_INITTOLOGFONTSTRUCT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>40&amp; 'use the structure pointed to by the lpLogFont member
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_LIMITSIZE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2000&amp; '        select font sizes only within nSizeMin and nSizeMax members
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_NOOEMFONTS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>800&amp; '        should not allow vector font selections
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_NOFACESEL = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000&amp; '       prevent displaying initial selection in font name combo box.
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_NOSCRIPTSEL = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>800000&amp; '    Disables the Script combo box
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_NOSIMULATIONS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1000&amp; '    Disables selection of font simulations
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_NOSIZESEL = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>200000&amp;  '     Disables Point Size selection
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_NOSTYLESEL = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>100000&amp; '     Disables Style selection
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_NOVECTORFONTS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>800&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_NOVERTFONTS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1000000&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_OEMTEXT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_PRINTERFONTS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2&amp; '        list fonts only supported by printer associated with the device
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_SCALABLEONLY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20000&amp; '    select only vector fonts, scalable printer fonts, and TrueType fonts
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_SCREENFONTS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1&amp;  '        lists only the screen fonts supported by system 
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_SCRIPTSONLY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>400&amp; '       lists all non-OEM, Symbol and ANSI sets only
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_SELECTSCRIPT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>400000&amp;  '  can only use set specified in the Scripts combo box
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_SHOWHELP = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4&amp;  '           displays Help button reference
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_TTONLY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>40000&amp;  '         True Type only
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_USESTYLE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80&amp; '           copies style data for the user's selection to lpszStyle buffer
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CF_WYSIWYG = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>8000&amp; '          only list fonts available on both the printer and display
' Font Types returned by nFontType
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> BOLD_FONTTYPE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>100&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> ITALIC_FONTTYPE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>200&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> PRINTER_FONTTYPE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4000&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REGULAR_FONTTYPE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>400&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SCREEN_FONTTYPE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2000&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SIMULATED_FONTTYPE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>8000&amp;
' Font Weights assigned to lfWeight
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FW_DONTCARE = 0
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FW_THIN = 100
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FW_ULTRALIGHT = 200
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FW_LIGHT = 300
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FW_REGULAR = 400
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FW_MEDIUM = 500
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FW_SEMIBOLD = 600
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FW_BOLD = 700
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FW_ULTRABOLD = 800
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FW_HEAVY = 900

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> DEFAULT_CHARSET = 1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> LF_DEFAULT = 0
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> FF_ROMAN = 16
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> LF_FACESIZE = 32
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> GMEM_MOVEABLE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> GMEM_ZEROINIT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>40
'-------------------------------------------------------------------------------------------

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindowA%&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> ClassName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> WindowName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "comdlg32"
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> ChooseFontA&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpcf <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> CommDlgExtendedError&amp; () '                'dialog box error checking procedure
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> CHOOSEFONT
  lStructSize <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  hwndOwner <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
  HDC <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
  lpLogFont <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
  iPointSize <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  Flags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  rgbColors <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  lCustData <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
  lpfnHook <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
  lpTemplateName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
  hInstance <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
  lpszStyle <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
  nFontType <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> '  if used as Unsigned Integer add Integer padder below
  'padder <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a> ' use only when nFontType is designated as Unsigned Integer
  nSizeMin <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  nSizeMax <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>

<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> LOGFONT
  lfHeight <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  lfWidth <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  lfEscapement <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  lfOrientation <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  lfWeight <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  lfItalic <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a> '    not 0 when user selected
  lfUnderline <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a> ' not 0 when user selected
  lfStrikeOut <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a> ' not 0 when user selected
  lfCharSet <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>
  lfOutPrecision <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>
  lfClipPrecision <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>
  lfQuality <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>
  lfPitchAndFamily <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>
  lfFaceName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> * 32 'contains name listed in dialog
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> hWnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> 'must <a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> or hWnd won't work
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> Title <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> 'keeps Dialog with program window

<a href="SCREEN.html" title="SCREEN"><span style="color:#87cefa;">SCREEN</span></a> <a href="NEWIMAGE.html" title="NEWIMAGE"><span style="color:#87cefa;">_NEWIMAGE</span></a>(640, 480, 12) '32 bit, 16 or 256 color screen modes
Title$ = "Choose Font Dialog"
<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> Title$ 'set Title of program
<a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 1
hWnd = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindowA%&amp;(0, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(Title)) 'get window handle

Font$ = ShowFont$(hWnd) '           call Dialog Box and get the font selection
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> Font$, <a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(FontColor&amp;), FontType$; FontEff$, PointSize&amp; 'other values <a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> by function
<a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> FontColor&amp;: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Font Color Selected"
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> ShowFont$ (hWnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> cf <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> CHOOSEFONT
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> lfont <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> LOGFONT
<a href="SHARED.html" title="SHARED"><span style="color:#87cefa;">SHARED</span></a> FontColor&amp;, FontType$, FontEff$, PointSize <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> 'shared with main program
lfont.lfHeight = LF_DEFAULT ' determine default height '       set dailog box defaults
lfont.lfWidth = LF_DEFAULT ' determine default width
lfont.lfEscapement = LF_DEFAULT ' angle between baseline and escapement vector
lfont.lfOrientation = LF_DEFAULT ' angle between baseline and orientation vector
lfont.lfWeight = FW_REGULAR ' normal weight i.e. not bold
lfont.lfCharSet = DEFAULT_CHARSET ' use default character set
lfont.lfOutPrecision = LF_DEFAULT ' default precision mapping
lfont.lfClipPrecision = LF_DEFAULT ' default clipping precision
lfont.lfQuality = LF_DEFAULT ' default quality setting
lfont.lfPitchAndFamily = LF_DEFAULT <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> FF_ROMAN ' default pitch, proportional with serifs
lfont.lfFaceName = "Times New Roman" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0) ' string must be null-terminated
cf.lStructSize = <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(cf) ' size of structure
cf.hwndOwner = hWnd ' window opening the dialog box
'cf.HDC = Printer.hDC ' device context of default printer (using VB's mechanism)
cf.lpLogFont = <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(lfont)
cf.iPointSize = 120 ' 12 point font (in units of 1/10 point)
cf.Flags = CF_BOTH <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> CF_EFFECTS <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> CF_<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a>CEFONTEXIST <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> CF_INITTOLOGFONTSTRUCT <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> CF_LIMITSIZE
cf.rgbColors = <a href="RGB.html" title="RGB"><span style="color:#87cefa;">_RGB</span></a>(0, 0, 0) ' black
cf.nFontType = REGULAR_FONTTYPE ' regular font type i.e. not bold or anything
cf.nSizeMin = 10 ' minimum point size
cf.nSizeMax = 72 ' maximum point size

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> ChooseFontA&amp;(<a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(cf)) &lt;&gt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> '    'Initiate Dialog and Read user selections
  ShowFont = <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(lfont.lfFaceName, <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(lfont.lfFaceName, <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)) - 1)
  'returns closest color attribute or 32 bit value and swaps red and blue color values
  FontColor&amp; = <a href="RGB.html" title="RGB"><span style="color:#87cefa;">_RGB</span></a>(<a href="BLUE32.html" title="BLUE32"><span style="color:#87cefa;">_BLUE32</span></a>(cf.rgbColors), <a href="GREEN32.html" title="GREEN32"><span style="color:#87cefa;">_GREEN32</span></a>(cf.rgbColors), <a href="RED32.html" title="RED32"><span style="color:#87cefa;">_RED32</span></a>(cf.rgbColors))
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> cf.nFontType <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> BOLD_FONTTYPE <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> FontType$ = "Bold"
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> cf.nFontType <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> ITALIC_FONTTYPE <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> FontType$ = FontType$ + "Italic"
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> cf.nFontType <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> REGULAR_FONTTYPE <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> FontType$ = "Regular"
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> lfont.lfUnderline <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> FontEff$ = "Underline"
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> lfont.lfStrikeOut <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> FontEff$ = FontStyle$ + "Strikeout"
  PointSize = cf.iPointSize \ 10
<a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> CommDlgExtendedError&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "ChooseFontA failed. Error: 0x"; <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(CommDlgExtendedError&amp;))
  <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Entry was cancelled!"
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code by Michael Calkins and Ted Weissgerber</span></center>
<center><b>Warning! This dialog box may error for no apparent reason! See <a rel="nofollow" class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms646916(v=vs.85).aspx">CommDlgExtendedError</a> for more info!</b></center>
<p><br />
</p>
<dl><dd><i>Snippet:</i> Shows how to compare a Font Dialog Box request with <a href="STRING.html" title="STRING">STRING</a> file data created by the <a href="Windows_Libraries.html#Registered_Fonts" title="Windows Libraries">Registry Font Library</a> below:</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: courier; background-color: lightgrey; color: black;">' procedure assumes that all fonts have been loaded into an array as below:
RegFont$(1) = "Times New Roman (TrueType) = TIMES.TTF" 'array simulates registry data from file
RegFont$(2) = "Times New Roman Bold (TrueType) = TIMESBD.TTF"  
RegFont$(3) = "Times New Roman Bold Italic (TrueType) = TIMESBI.TTF"
RegFont$(4) = "Times New Roman Italic (TrueType) = TIMESI.TTF"
Font$ = "Times New Roman Bold Italic" 'font name returned by Font Dialog box
File$ = ""

<a href="FOR...html" title="FOR...NEXT"><span style="color:blue;">FOR</span></a> n = 1 <a href="TO.html" title="TO"><span style="color:blue;">TO</span></a> 4 'numFiles% 'actual number of font file registry records
<a href="IF...html" title="IF...THEN"><span style="color:blue;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:blue;">INSTR</span></a>$(RegFont$(n), Font$) <a href="THEN.html" title="THEN"><span style="color:blue;">THEN</span></a> 'check for match of Dialog Box font name "Times New Roman"
  FontFile$ = <a href="MID%24.html" title="MID$"><span style="color:blue;">MID$</span></a>(RegFont$(n), <a href="INSTR.html" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "=") + 2)   'get each file name value
  <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:blue;">SELECT CASE</span></a> FontType$   'check for user requested font type to get file name
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:blue;">CASE</span></a> "Bold"
    <a href="IF...html" title="IF...THEN"><span style="color:blue;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Bold") <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:blue;">AND</span></a> <a href="INSTR.html" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Italic") = 0 <a href="THEN.html" title="THEN"><span style="color:blue;">THEN</span></a> File$ = FontFile$
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:blue;">CASE</span></a> "Italic"
    <a href="IF...html" title="IF...THEN"><span style="color:blue;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Italic") <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:blue;">AND</span></a> <a href="INSTR.html" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Bold") = 0 <a href="THEN.html" title="THEN"><span style="color:blue;">THEN</span></a> File$ = FontFile$
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:blue;">CASE</span></a> "BoldItalic"
    <a href="IF...html" title="IF...THEN"><span style="color:blue;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Bold") <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:blue;">AND</span></a> <a href="INSTR.html" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Italic") <a href="THEN.html" title="THEN"><span style="color:blue;">THEN</span></a> File$ = FontFile$
  <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:blue;">CASE ELSE</span></a> 'regular font as default
    <a href="IF...html" title="IF...THEN"><span style="color:blue;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Bold") = 0 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:blue;">AND</span></a> <a href="INSTR.html" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Italic") = 0 <a href="THEN.html" title="THEN"><span style="color:blue;">THEN</span></a> File$ = FontFile$
  <a href="END_SELECT.html" title="END SELECT"><span style="color:blue;">END SELECT</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:blue;">END IF</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:blue;">IF</span></a> <a href="LEN.html" title="LEN"><span style="color:blue;">LEN</span></a>(File$) <a href="THEN.html" title="THEN"><span style="color:blue;">THEN</span></a> <a href="EXIT_FOR.html" title="EXIT FOR"><span style="color:blue;">EXIT FOR</span></a>  'quit searching
<a href="NEXT.html" title="NEXT"><span style="color:blue;">NEXT</span></a> <i> </i>
</p>
<dl><dd><i>Note:</i> The Font Dialog name will not normally have descriptions such as Regular, Bold, Italics or (TrueType) so it ignores them.</dd></dl>
<p><br />
</p>
<center><b><a rel="nofollow" class="external text" href="http://www.functionx.com/win32/Lesson14.htm">GDI Tools - Font Guidlines</a></b></center>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Registered_Fonts">Registered Fonts</span></h2>
<dl><dd>The Registry lists the Font Names and associated TTF file names that are needed with the <a href="Windows_Libraries.html#Font_Dialog_Box" title="Windows Libraries">Font Dialog Box</a> in a program.</dd>
<dd>The following program uses Registry functions from <i>advapi32.dll</i> to read the list of registered fonts and put them into a file.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
' winreg.h
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HKEY_CLASSES_ROOT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000000~&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HKEY_CURRENT_USER = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000001~&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HKEY_LOCAL_MACHINE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000002~&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HKEY_USERS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000003~&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HKEY_PERFORMANCE_DATA = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000004~&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HKEY_CURRENT_CONFIG = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000005~&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HKEY_DYN_DATA = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000006~&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_OPTION_VOLATILE = 1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_OPTION_NON_VOLATILE = 0
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_CREATED_NEW_KEY = 1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_OPENED_EXISTING_KEY = 2

' <b><a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/ms724884(v=VS.85).aspx">http://msdn.microsoft.com/en-us/library/ms724884(v=VS.85).aspx</a></b>
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_NONE = 0
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_SZ = 1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_EXPAND_SZ = 2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_BINARY = 3
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_DWORD_LITTLE_ENDIAN = 4  '   value is defined REG_DWORD in Windows header files
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_DWORD = 4 '                  32-bit number
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_DWORD_BIG_ENDIAN = 5 '       some UNIX systems support big-endian architectures
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_LINK = 6
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_MULTI_SZ = 7
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_RESOURCE_LIST = 8
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_FULL_RESOURCE_DESCRIPTOR = 9
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_RESOURCE_REQUIREMENTS_LIST = 10
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_QWORD_LITTLE_ENDIAN = 11  '  64-bit number in little-endian format
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_QWORD = 11 '                 64-bit number
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_NOTIFY_CHANGE_NAME = 1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_NOTIFY_CHANGE_ATTRIBUTES = 2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_NOTIFY_CHANGE_LAST_SET = 4
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> REG_NOTIFY_CHANGE_SECURITY = 8

' <b><a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/ms724878(v=VS.85).aspx">http://msdn.microsoft.com/en-us/library/ms724878(v=VS.85).aspx</a></b>
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEY_ALL_ACCESS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>F003F&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEY_CREATE_LINK = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0020&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEY_CREATE_SUB_KEY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0004&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEY_ENUMERATE_SUB_KEYS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0008&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEY_EXECUTE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20019&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEY_NOTIFY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0010&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEY_QUERY_VALUE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0001&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEY_READ = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20019&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEY_SET_VALUE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0002&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEY_WOW64_32KEY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0200&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEY_WOW64_64KEY = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0100&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEY_WRITE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20006&amp;

' winerror.h
' <b><a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/ms681382(v=VS.85).aspx">http://msdn.microsoft.com/en-us/library/ms681382(v=VS.85).aspx</a></b>
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> ERROR_SUCCESS = 0
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> ERROR_FILE_NOT_FOUND = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> ERROR_INVALID_HANDLE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>6&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> ERROR_MORE_DATA = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>EA&amp;
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> ERROR_NO_MORE_ITEMS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>103&amp;
'---------------------------------------------------------------------------------------------
' REGSAM is an ACCESS_MASK (winreg.h), which is a DWORD (winnt.h)

'Note: All of these functions, except RegCloseKey, have both ANSI (ending in A)
'and Unicode (ending in W) versions. I am not aware of any reason why both 
'versions could not be used in the same program. To add the Unicode version, 
'duplicate the function declaration, but change the ending A to W. Be sure that
'you know how to use the <a href="Unicode.html" title="Unicode"><span style="color:#87cefa;">Unicode</span></a> version! ANSI versions tested, sort of:

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "advapi32"

  ' <b><a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/ms724897(v=VS.85).aspx">http://msdn.microsoft.com/en-us/library/ms724897(v=VS.85).aspx</a></b>
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> RegOpenKeyExA&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hKey <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpSubKey <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> ulOptions <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> samDesired <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> phkResult <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)

  ' <b><a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/ms724837(v=VS.85).aspx">http://msdn.microsoft.com/en-us/library/ms724837(v=VS.85).aspx</a></b>
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> RegCloseKey&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hKey <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)

  ' <b><a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/ms724865(v=VS.85).aspx">http://msdn.microsoft.com/en-us/library/ms724865(v=VS.85).aspx</a></b>
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> RegEnumValueA&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hKey <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwIndex <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpValueName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>,_
 <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpcchValueName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpReserved <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpType <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpData <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>,_
 <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpcbData <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)

<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> hKey <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> Ky <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> SubKey <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> Value <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> bData <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dwType <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numBytes <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> numTchars <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> l <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> dwIndex <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

<a href="OPEN.html" title="OPEN"><span style="color:#87cefa;">OPEN</span></a> "F0NTList.INF" <a href="FOR.html" class="mw-redirect" title="FOR"><span style="color:#87cefa;">FOR</span></a> <a href="OUTPUT.html" class="mw-redirect" title="OUTPUT"><span style="color:#87cefa;">OUTPUT</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> #1  'create a new file for font data
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "This key lists the registered fonts available to all users:"
Ky = HKEY_LOCAL_MACHINE
SubKey = "SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
Value = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(261) 'ANSI Value name limit 260 chars + 1 null
bData = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7FFF) 'arbitrary

l = RegOpenKeyExA(Ky, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(SubKey), 0, KEY_READ, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(hKey))
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> l <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "RegOpenKeyExA failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(l))
<a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> whatKey$(Ky) + "\" + SubKey
  dwIndex = 0
  DO
    <a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> .1
    numBytes = <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(bData)
    numTchars = <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(Value)
    l = RegEnumValueA(hKey, dwIndex, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(Value), <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(numTchars), 0, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(dwType), <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(bData), <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(numBytes))
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> l <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
      <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> l &lt;&gt; ERROR_NO_MORE_ITEMS <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
        <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "RegEnumValueA failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(l))
      <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
      <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
      <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> whatType(dwType) + " " + <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(Value, numTchars) + " = " + formatData(dwType, numBytes, bData)
      <a href="PRINT_(file_statement).html" title="PRINT (file statement)"><span style="color:#87cefa;">PRINT</span></a> #1, <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(Value, numTchars) + " = " + formatData(dwType, numBytes, bData)
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    dwIndex = dwIndex + 1
  <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
  <a href="CLOSE.html" title="CLOSE"><span style="color:#87cefa;">CLOSE</span></a> #1
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> dwIndex; "Values."
  l = RegCloseKey(hKey)
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> l <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "RegCloseKey failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(l))
    <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> whatType$ (dwType <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> dwType
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_SZ: whatType = "REG_SZ"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_EXPAND_SZ: whatType = "REG_EXPAND_SZ"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_BINARY: whatType = "REG_BINARY"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_DWORD: whatType = "REG_DWORD"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_DWORD_BIG_ENDIAN: whatType = "REG_DWORD_BIG_ENDIAN"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_LINK: whatType = "REG_LINK"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_MULTI_SZ: whatType = "REG_MULTI_SZ"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_RESOURCE_LIST: whatType = "REG_RESOURCE_LIST"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_FULL_RESOURCE_DESCRIPTOR: whatType = "REG_FULL_RESOURCE_DESCRIPTOR"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_RESOURCE_REQUIREMENTS_LIST: whatType = "REG_RESOURCE_REQUIREMENTS_LIST"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_QWORD: whatType = "REG_QWORD"
  <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: whatType = "unknown"
<a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> whatKey$ (hKey <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
<a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> hKey
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> HKEY_CLASSES_ROOT: whatKey = "HKEY_CLASSES_ROOT"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> HKEY_CURRENT_USER: whatKey = "HKEY_CURRENT_USER"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> HKEY_LOCAL_MACHINE: whatKey = "HKEY_LOCAL_MACHINE"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> HKEY_USERS: whatKey = "HKEY_USERS"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> HKEY_PERFORMANCE_DATA: whatKey = "HKEY_PERFORMANCE_DATA"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> HKEY_CURRENT_CONFIG: whatKey = "HKEY_CURRENT_CONFIG"
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> HKEY_DYN_DATA: whatKey = "HKEY_DYN_DATA"
<a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> formatData$ (dwType <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, numBytes <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, bData <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ul <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> b <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>
<a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> dwType
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_SZ, REG_EXPAND_SZ, REG_MULTI_SZ
    formatData = <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(bData, numBytes - 1)
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> REG_DWORD
    t = <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(<a href="CVL.html" title="CVL"><span style="color:#87cefa;">CVL</span></a>(<a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(bData, 4))))
    formatData = "0x" + <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(8 - <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(t), <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30) + t
  <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> numBytes <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
      b = <a href="ASC.html" title="ASC"><span style="color:#87cefa;">ASC</span></a>(<a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(bData, 1))
      <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> b &lt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
        t = t + "0" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(b))
      <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
        t = t + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(b))
      <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> ul = 2 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> numBytes
      b = <a href="ASC.html" title="ASC"><span style="color:#87cefa;">ASC</span></a>(<a href="MID%24.html" title="MID$"><span style="color:#87cefa;">MID$</span></a>(bData, ul, 1))
      <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> b &lt; <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
        t = t + " 0" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(b))
      <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
        t = t + " " + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(b))
      <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
    <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
    formatData = t
<a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Michael Calkins</span></center>
<dl><dd><i>Note:</i> The names used in a Font Dialog Box and the actual file names are saved to the <i>F0NTList.INF</i>(name uses zero) file to be compared with user entries. To check for <i>Bold</i> and <i>Italics</i> or combined types of font requests see <a href="Windows_Libraries.html#Font_Dialog_Box" title="Windows Libraries">Font Dialog Box Library</a> above.</dd></dl>
<center><b>Note: The above procedure only reads the Registry. <span style="color:red">Edit or alter the Registry at your own peril!</span></b></center>
<p><br />
</p>
<center><a href="Windows_Registry_Access.html" title="Windows Registry Access">Windows Registry Libraries</a></center>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<p><br />
</p>
<h2><span class="mw-headline" id="Game_Pad">Game Pad</span></h2>
<dl><dd>Function <i>joyGetPosEx</i> allows for more buttons and dual analog multiple sticks</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: courier; background-color: lightgrey; color: black;"> <i> </i>
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:blue;">DECLARE DYNAMIC LIBRARY</span></a> "winmm"
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> joyGetNumDevs% () ' Number of joysticks supported on system
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> joyGetPosEx&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:blue;">BYVAL</span></a> uJoyID <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, joyref <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="TYPE.html" title="TYPE"><span style="color:blue;">TYPE</span></a> JOYINFOEX
    dwSize <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    dwFlags <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    dwXpos <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    dwYpos <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    dwZpos <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    dwRpos <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    dwUpos <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    dwVpos <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    dwButtons <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    dwButtonNumber <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    dwPOV <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    dwReserved1 <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    dwReserved2 <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
<a href="END.html" title="END"><span style="color:blue;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:blue;">TYPE</span></a>

<a href="DIM.html" title="DIM"><span style="color:blue;">DIM</span></a> Joy1 <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> JOYINFOEX
Joy1.dwSize = <a href="LEN.html" title="LEN"><span style="color:blue;">LEN</span></a>(Joy1)

DO
    x&amp; = joyGetPosEx(0, Joy1.dwSize)

    <a href="LOCATE.html" title="LOCATE"><span style="color:blue;">LOCATE</span></a> 1, 1:
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwSize
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwFlags
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwXpos
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwYpos
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwZpos
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwRpos
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwUpos
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwVpos

<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> <a href="INKEY%24.html" title="INKEY$"><span style="color:blue;">INKEY$</span></a> &lt;&gt; "" <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Unseenmachine</span></center>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: courier; background-color: lightgrey; color: black;"> <i> </i>
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:blue;">DECLARE DYNAMIC LIBRARY</span></a> "winmm"
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> joyGetNumDevs% () ' Number of joysticks supported on system
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> joyGetPos&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:blue;">BYVAL</span></a> uJoyID <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, joyref <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:blue;">END DECLARE</span></a>

<a href="TYPE.html" title="TYPE"><span style="color:blue;">TYPE</span></a> JOYINFO
    wXpos <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    wYpos <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    wZpos <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    wButtons <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
<a href="END.html" title="END"><span style="color:blue;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:blue;">TYPE</span></a>

<a href="TYPE.html" title="TYPE"><span style="color:blue;">TYPE</span></a> PadCalibration
    IsAnalog <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
    XMin <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    YMin <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    XMax <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    YMax <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    XNorm <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    YNorm <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:blue;">LONG</span></a>
    Button1 <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
    Button2 <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
    Button3 <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
    Button4 <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
    Button5 <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
    Button6 <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
<a href="END.html" title="END"><span style="color:blue;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:blue;">TYPE</span></a>

<a href="DIM.html" title="DIM"><span style="color:blue;">DIM</span></a> MyJoyCal <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> PadCalibration, MyJoy <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> JOYINFO


'// Simple calibration.

<a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Press button 1 (A on XBox | X on PS3) "
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons &gt; 0
MyJoyCal.Button1 = MyJoy.wButtons
<a href="SLEEP.html" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Press button 2 (B on XBox | Circle on PS3) "
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons &lt;&gt; 0
MyJoyCal.Button2 = MyJoy.wButtons
<a href="SLEEP.html" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Press button 3 (X on XBox | Square on PS3) "
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons &lt;&gt; 0
MyJoyCal.Button3 = MyJoy.wButtons
<a href="SLEEP.html" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Press button 4 (Y on XBox | Triangle on PS3) "
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons &lt;&gt; 0
MyJoyCal.Button4 = MyJoy.wButtons
<a href="SLEEP.html" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Press button 5 (R1) "
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons &lt;&gt; 0
MyJoyCal.Button5 = MyJoy.wButtons
<a href="SLEEP.html" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Press button 6 (L1) "
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons &lt;&gt; 0
MyJoyCal.Button6 = MyJoy.wButtons
<a href="SLEEP.html" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Leave the joystick in its central position and press button 1"
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons = MyJoyCal.Button1
MyJoyCal.XNorm = MyJoy.wXpos
<a href="SLEEP.html" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Push the joystick as far left as possible and press button 1"
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons = MyJoyCal.Button1
MyJoyCal.XMin = MyJoy.wXpos
<a href="SLEEP.html" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Push the joystick as far right as possible and press button 1"
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons = MyJoyCal.Button1
MyJoyCal.XMax = MyJoy.wXpos
<a href="SLEEP.html" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Push the joystick as far up as possible and press button 1"
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons = MyJoyCal.Button1
MyJoyCal.YMin = MyJoy.wXpos
<a href="SLEEP.html" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Push the joystick as far down as possible and press button 1"
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons = MyJoyCal.Button1
MyJoyCal.YMax = MyJoy.wXpos
<a href="SLEEP.html" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="CLS.html" title="CLS"><span style="color:blue;">CLS</span></a>

'//How to get the gamepads status.

DO
    a% = StickXPos(0, MyJoy, MyJoyCal)
    b% = StickYPos(0, MyJoy, MyJoyCal)
    c% = StickZPos(0, MyJoy, MyJoyCal)
    d% = JoyButton1(0, MyJoy, MyJoyCal)
    e% = JoyButton2(0, MyJoy, MyJoyCal)
    f% = JoyButton3(0, MyJoy, MyJoyCal)
    g% = JoyButton4(0, MyJoy, MyJoyCal)
    h% = JoyButton5(0, MyJoy, MyJoyCal)
    i% = JoyButton6(0, MyJoy, MyJoyCal)

    <a href="LOCATE.html" title="LOCATE"><span style="color:blue;">LOCATE</span></a> 1, 1: <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "X axis&#160;: ", MyJoy.wXpos
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Y axis&#160;: ", MyJoy.wYpos
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Z axis&#160;: ", MyJoy.wZpos
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Button 1&#160;: ", d%
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Button 2&#160;: ", e%
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Button 3&#160;: ", f%
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Button 4&#160;: ", g%
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Button 5&#160;: ", h%
    <a href="PRINT.html" title="PRINT"><span style="color:blue;">PRINT</span></a> "Button 6&#160;: ", i%

<a href="LOOP.html" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:blue;">UNTIL</span></a> <a href="INKEY%24.html" title="INKEY$"><span style="color:blue;">INKEY$</span></a> &lt;&gt; ""


'// Functions

<a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> StickXPos (Index <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
StickXPos = Joyref.wXpos
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> StickYPos (Index <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
StickYPos = Joyref.wYpos
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> StickZPos (Index <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
StickZPos = Joyref.wZpos
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButtons (Index <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
JoyButtons = Joyref.wButtons
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButton1 (Index <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
<a href="IF...html" title="IF...THEN"><span style="color:blue;">IF</span></a> Joyref.wButtons = JoyCal.Button1 <a href="THEN.html" title="THEN"><span style="color:blue;">THEN</span></a>
    JoyButton1 = -1
<a href="ELSE.html" title="ELSE"><span style="color:blue;">ELSE</span></a>
    JoyButton1 = 0
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:blue;">END IF</span></a>
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButton2 (Index <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
<a href="IF...html" title="IF...THEN"><span style="color:blue;">IF</span></a> Joyref.wButtons = JoyCal.Button2 <a href="THEN.html" title="THEN"><span style="color:blue;">THEN</span></a>
    JoyButton2 = -1
<a href="ELSE.html" title="ELSE"><span style="color:blue;">ELSE</span></a>
    JoyButton2 = 0
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:blue;">END IF</span></a>
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButton3 (Index <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
<a href="IF...html" title="IF...THEN"><span style="color:blue;">IF</span></a> Joyref.wButtons = JoyCal.Button3 <a href="THEN.html" title="THEN"><span style="color:blue;">THEN</span></a>
    JoyButton3 = -1
<a href="ELSE.html" title="ELSE"><span style="color:blue;">ELSE</span></a>
    JoyButton3 = 0
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:blue;">END IF</span></a>
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButton4 (Index <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
<a href="IF...html" title="IF...THEN"><span style="color:blue;">IF</span></a> Joyref.wButtons = JoyCal.Button4 <a href="THEN.html" title="THEN"><span style="color:blue;">THEN</span></a>
    JoyButton4 = -1
<a href="ELSE.html" title="ELSE"><span style="color:blue;">ELSE</span></a>
    JoyButton4 = 0
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:blue;">END IF</span></a>
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButton5 (Index <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
<a href="IF...html" title="IF...THEN"><span style="color:blue;">IF</span></a> Joyref.wButtons = JoyCal.Button5 <a href="THEN.html" title="THEN"><span style="color:blue;">THEN</span></a>
    JoyButton5 = -1
<a href="ELSE.html" title="ELSE"><span style="color:blue;">ELSE</span></a>
    JoyButton5 = 0
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:blue;">END IF</span></a>
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButton6 (Index <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="AS.html" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
<a href="IF...html" title="IF...THEN"><span style="color:blue;">IF</span></a> Joyref.wButtons = JoyCal.Button6 <a href="THEN.html" title="THEN"><span style="color:blue;">THEN</span></a>
    JoyButton6 = -1
<a href="ELSE.html" title="ELSE"><span style="color:blue;">ELSE</span></a>
    JoyButton6 = 0
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:blue;">END IF</span></a>
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a> <i> </i>
</p>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span id="Hot_Keys_(maximize)"></span><span class="mw-headline" id="Hot_Keys_.28maximize.29">Hot Keys (maximize)</span></h2>
<dl><dd><b>Maximizing a minimized program window not in focus using Shift + A as read by the Windows <i>GetKeyState</i> function.</b></dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'=================
'CHEAPO-HOTKEY.BAS
'=================
'Uses GetKeyState Win API to monitor a Key state.
'This demo will maximize the window when Shift+A is pressed at any time.

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32" 
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindowA&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> ClassName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, WindowName$) 'handle by title
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetKeyState% (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nVirtKey <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>) 'reads Windows key presses independently 
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> ShowWindow&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nCmdShow <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>) 'minimize or maximize
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

title$ = "Cheapo Hotkey (Shift+A)" 'string variable avoids title typo's
<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> title$
hwnd&amp; = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindowA(0, title$ + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0))

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Minimize this window, then Press Shift+A to bring it back up."

'=== below minimizes it for you
'<a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 4
'x&amp; = ShowWindow&amp;(hwnd&amp;, 2)
'===========================

DO
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetKeyState(16) &lt; 0 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> GetKeyState(<a href="ASC.html" title="ASC"><span style="color:#87cefa;">ASC</span></a>("A")) &lt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> '&lt;==== Shift+A
      y&amp; = ShowWindow&amp;(hwnd&amp;, 1)
      <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "That is all. Hoped it worked."; x&amp;; y&amp;
      <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

  <a href="LIMIT.html" title="LIMIT"><span style="color:#87cefa;">_LIMIT</span></a> 30 'Don't be a hog
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <i> </i>
</p> <center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Dav</span></center>
<dl><dd><b>Note:</b> Virtual Hot keys can be used when a QB64 program is <b>not in focus</b> too! See <b><a href="Windows_Libraries.html#Focus" title="Windows Libraries">Focus</a></b> to bring a QB64 program into focus.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:10px; white-space: pre; font-family: courier; background-color: white; color: darkgreen;">'                                  <b>Virtual KeyState Codes</b>
'
'<b> Esc  F1  F2  F3  F4  F5  F6  F7  F8  F9  F10  F11 F12   Sys ScL Pause</b>                  
' 27   112 113 114 115 116 117 118 119 120 121  122 123   44  145 19
'<b> `~  1!  2@  3#  4$  5%  6^  7&amp;  8* 9(  0) -_  =+  BkS   Ins Hme PUp   NumL  /   *    -</b> 
' 192 49  50  51  52  53  54  55  56  57 48 189 187  8    45  36  33    144  111  106 109
'<b> Tab Q   W   E   R   T   Y   U   I   O   P  [{  ]}  \|   Del End PDn   7Hme 8/  9PU  +</b>
'  9  81  87  69  82  84  89  85  73  79  80 219 221 120  46  35  34    103  104  105 107
'<b> CapL  A   S   D   F   G   H   J   K   L   ;:  '" Enter                4/-  5   6/- E</b>
'  20   65  83  68  70  71  72  74  75  76 186 222  13                  100  101  102  <b>n</b>                                                                                                                          
'<b> Shift  Z   X   C   V   B   N   M   ,&lt;  .&gt;  /?    Shift               1End 2/  3PD  t</b>
' 16/160 90  88  67  86  66  78  77 188  190 191   16/161      38       97   98   99   <b>e</b>                                                                                       
'<b> Ctrl   Win   Alt       Spacebar      Alt Win Menu Ctrl   -     -   0Ins     .Del  r</b>
' 17/162 91  18/164        32        18/165 92  93 17/163  37  40  39   96        110  13
'
'     Num Lock On values shown. Off values same as functions and arrows, 5 = code 12.
'
'  <b>Mouse click returns: LB = 1, RB = 2, MB = 4, etc. <a rel="nofollow" class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx">Special keys</a> may also work.</b>
</p> 
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">NOTE: The above commented table can be copied and pasted directly into the QB64 IDE</span></center>
<p><br />
</p>
<dl><dd><b>Invisible key and mouse logger that does not require program focus. Press ESCape key to view the logged activity. </b></dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="%24CONSOLE.html" title="$CONSOLE"><span style="color:#87cefa;">$CONSOLE</span></a>
<a href="DEST.html" title="DEST"><span style="color:#87cefa;">_DEST</span></a> <a href="CONSOLE.html" title="CONSOLE"><span style="color:#87cefa;">_CONSOLE</span></a> ' for demonstration only
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "The actual program is hiding. Type some stuff!"
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press ESC to quit logging keys and see results.":
<a href="DEST.html" title="DEST"><span style="color:#87cefa;">_DEST</span></a> 0 
'====================== End Demo Console Code ===============================
<a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>&#160;: <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> <a href="SCREENEXISTS.html" title="SCREENEXISTS"><span style="color:#87cefa;">_SCREENEXISTS</span></a> 'to prevent unexpected freezing
<a href="SCREENHIDE.html" title="SCREENHIDE"><span style="color:#87cefa;">_SCREENHIDE</span></a> 'makes the program invisible to the user. Escape key displays log!

<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a>  'function is already used by QB64 so "User32" is not required
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetAsyncKeyState% (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> vkey <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> theitem$(1000)
 
<a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LIMIT.html" title="LIMIT"><span style="color:#87cefa;">_LIMIT</span></a> 100
  <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> thekey = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5A
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetAsyncKeyState(thekey) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
      theitem$(a) = theitem$(a) + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(thekey)
      <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>
      <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> GetAsyncKeyState(thekey) = 0
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetAsyncKeyState(1) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    a = a + 1
    theitem$(a) = "{MOUSE LEFT}"
    <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>
    <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> GetAsyncKeyState(1) = 0
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetAsyncKeyState(2) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    a = a + 1
    theitem$(a) = "{MOUSE RIGHT}"
    <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>
    <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> GetAsyncKeyState(2) = 0
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetAsyncKeyState(4) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    a = a + 1
    theitem$(a) = "{MOUSE MIDDLE}"
    <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>
    <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> GetAsyncKeyState(4) = 0
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetAsyncKeyState(8) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    theitem$(a) = theitem$(a) + "{BS}"
    <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>
    <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> GetAsyncKeyState(8) = 0
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetAsyncKeyState(9) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    theitem$(a) = theitem$(a) + "{TAB}"
    <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>
    <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> GetAsyncKeyState(9) = 0
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetAsyncKeyState(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>D) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    a = a + 1
    theitem$(a) = "{ENTER}"
    <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>
    <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> GetAsyncKeyState(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>D) = 0
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetAsyncKeyState(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>14) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    theitem$(a) = theitem$(a) + "{CAPS <a href="LOCK.html" title="LOCK"><span style="color:#87cefa;">LOCK</span></a>}"
    <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>
    <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> GetAsyncKeyState(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>14) = 0
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetAsyncKeyState(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    theitem$(a) = theitem$(a) + " "
    <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>
    <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> GetAsyncKeyState(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20) = 0
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> GetAsyncKeyState(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1B) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    theitem$(a) = theitem$(a) + "{ESC}"
    <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a> 'ESC key exits loop and prints logged key presses
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>

<a href="SCREENSHOW.html" title="SCREENSHOW"><span style="color:#87cefa;">_SCREENSHOW</span></a> 'makes program visible with ESC key press
<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> b = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> a
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> theitem$(b)
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> b <a href="MOD.html" title="MOD"><span style="color:#87cefa;">MOD</span></a> 20 = 19 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 12: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "press any key": <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>: <a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a> <i> </i>
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code by Cyperium</span></center>
<dl><dd><i>Note:</i> The program will run invisibly without a program icon appearing in the task bar until the ESC key is pressed and the log will be displayed.</dd></dl>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Keyboard_Lock_Settings">Keyboard Lock Settings</span></h2>
<p>Change Cap Lock, Scroll Lock and Number Lock settings and respective lights or onscreen indicators.
</p>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'public domain, 2012 april, michael calkins
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> INPUT_KEYBOARD = 1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEYEVENTF_KEYDOWN = 0
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEYEVENTF_KEYUP = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> VK_CAPITAL = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>14
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> VK_NUMLOCK = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>90
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> VK_SCROLL = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>91

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> scCapital = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>3A
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> scNumlock = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>45
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> scScroll = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>46

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "kernel32"
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetLastError~&amp; ()
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SendInput~&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nInputs~&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> pInputs%&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> cbSize&amp;)
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetMessageExtraInfo%&amp; ()
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> KeyInputStruc
 type <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
 wVk <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
 wScan <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>
 dwFlags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
 time <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
 dwExtraInfo <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
 pad0 <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> 'to accomodate the size of a MOUSEINPUT
 pad1 <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> ki(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> 1) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> KeyInputStruc '2 index array will be zero initialized

ki(0).type = INPUT_KEYBOARD
ki(1).type = INPUT_KEYBOARD
ki(0).dwFlags = KEYEVENTF_KEYDOWN
ki(1).dwFlags = KEYEVENTF_KEYUP
ki(0).dwExtraInfo = GetMessageExtraInfo 'read function value
ki(1).dwExtraInfo = ki(0).dwExtraInfo   'assign same value 

<a href="RANDOMIZE.html" title="RANDOMIZE"><span style="color:#87cefa;">RANDOMIZE</span></a> <a href="TIMER.html" title="TIMER"><span style="color:#87cefa;">TIMER</span></a>
<a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a> = <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1B)
 <a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 2
 <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> <a href="INT.html" title="INT"><span style="color:#87cefa;">INT</span></a>(<a href="RND.html" title="RND"><span style="color:#87cefa;">RND</span></a> * 3)
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 0
   ki(0).wVk = VK_NUMLOCK
   ki(1).wVk = VK_NUMLOCK
   ki(0).wScan = scNumlock
   ki(1).wScan = scNumlock
   <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Num lock..."
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 1
   ki(0).wVk = VK_CAPITAL
   ki(1).wVk = VK_CAPITAL
   ki(0).wScan = scCapital
   ki(1).wScan = scCapital
   <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Caps lock..."
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 2
   ki(0).wVk = VK_SCROLL
   ki(1).wVk = VK_SCROLL
   ki(0).wScan = scScroll
   ki(1).wScan = scScroll
   <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Scroll lock..."
 <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
 l = SendInput(2, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(ki(0)), <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(ki(0))) '2 tells function to read two indices(0 and 1)
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> l &lt;&gt; 2 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> l
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError))
 <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code by Michael Calkins</span></center>
<dl><dd><i>Note:</i> In QB64 the number pad lock does not affect the <a href="INP.html" title="INP">INP</a>(&amp;H60) release code returns of the <a href="Extended_keys.html" title="Extended keys">extended keys</a> like it did in QBasic.</dd></dl>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Message_Box">Message Box</span></h2>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'Message Box Constant values as defined by Microsoft (MBType)
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_OK&amp; = 0                'OK button only
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_OKCANCEL&amp; = 1          'OK &amp; Cancel 
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_ABORTRETRYIGNORE&amp; = 2  'Abort, Retry &amp; Ignore
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_YESNOCANCEL&amp; = 3       'Yes, No &amp; Cancel
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_YESNO&amp; = 4             'Yes &amp; No
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_RETRYCANCEL&amp; = 5       'Retry &amp; Cancel
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_CANCELTRYCONTINUE&amp; = 6 'Cancel, Try Again &amp; Continue
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_ICONSTOP&amp; = 16         'Error stop sign icon
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_ICONQUESTION&amp; = 32     'Question-mark icon
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_ICONEXCLAMATION&amp; = 48  'Exclamation-point icon
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_ICONINFORMATION&amp; = 64  'Letter i in a circle icon
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_DEFBUTTON1&amp; = 0        '1st button default(left)
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_DEFBUTTON2&amp; = 256      '2nd button default
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_DEFBUTTON3&amp; = 512      '3rd button default(right)
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_APPLMODAL&amp; = 0         'Message box applies to application only
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_SYSTEMMODAL&amp; = 4096    'Message box on top of all other windows
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_SETFOCUS&amp; = 65536      'Set message box as focus
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDOK&amp; = 1                 'OK button pressed
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDCANCEL&amp; = 2             'Cancel button pressed
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDABORT&amp; = 3              'Abort button pressed
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDRETRY&amp; = 4              'Retry button pressed
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDIGNORE&amp; = 5             'Ignore button pressed
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDYES&amp; = 6                'Yes button pressed
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDNO&amp; = 7                 'No button pressed
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDTRYAGAIN&amp; = 10          'Try again button pressed
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDCONTINUE&amp; = 1           'Continue button pressed
'----------------------------------------------------------------------------------------

<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a> 
<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> MessageBox&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> Zer0 <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, Message <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, Title <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> MBType <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

DO
  msg&amp; = 0: icon&amp; = 0: DB&amp; = 0
  <a href="INPUT.html" title="INPUT"><span style="color:#87cefa;">INPUT</span></a> "Enter Message Box type(0 to 6 other Quits): ", BOX&amp;
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> BOX&amp; &lt; 0 <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> BOX&amp; &gt; 6 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="EXIT_DO.html" title="EXIT DO"><span style="color:#87cefa;">EXIT DO</span></a>

  <a href="INPUT.html" title="INPUT"><span style="color:#87cefa;">INPUT</span></a> "Enter Icon&amp;(0=none, 1=stop, 2=?, 3=!, 4=info): ", Icon&amp;
  
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> BOX&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="INPUT_(file_mode).html" class="mw-redirect" title="INPUT (file mode)"><span style="color:#87cefa;">INPUT</span></a> "Enter Default Button(1st, 2nd or 3rd): ", DB&amp;
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> DB&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> DB&amp; = DB&amp; - 1     'adjust value to 0, 1, or 2
  msg&amp; = MsgBox&amp;("Box Title", "Box text message", BOX&amp;, Icon&amp;, DB&amp;, 4096) 'on top of all windows

  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Button ="; msg&amp;
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> MsgBox&amp; (Title$, Message$, BoxType&amp;, Icon&amp;, DBtn&amp;, Mode&amp;)
<a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> Icon&amp;
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 1: Icon&amp; = MB_ICONSTOP&amp;          'warning X-sign icon
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 2: Icon&amp; = MB_ICONQUESTION&amp;      'question-mark icon
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 3: Icon&amp; = MB_ICONEXCLAMATION&amp;   'exclamation-point icon
  <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 4: Icon&amp; = MB_ICONINFORMATION&amp;   'lowercase letter i in circle
  <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: Icon&amp; = 0 'no icon
<a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> BoxType&amp; &gt; 0 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> DBtn&amp; &gt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> 'set default button as 2nd(256) or 3rd(512)
  <a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> BoxType&amp;    
    <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 2, 3, 6
     <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> DBtn&amp; = 2 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> Icon&amp; = Icon&amp; + MB_DEFBUTTON3&amp; <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> Icon&amp; = Icon&amp; + MB_DEFBUTTON2&amp; '3 button
    <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: Icon&amp; = Icon&amp; + MB_DEFBUTTON2&amp; '2nd button default
  <a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
Focus&amp; = MB_SetFocus&amp;
MsgBox&amp; = MessageBox&amp;(0, Message$, Title$, BoxType&amp; + Icon&amp; + Mode&amp; + Focus&amp;) 'focus on button
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a> <i> </i>
</p>
<dl><dd><b>Note:</b> The demo above can show all of the possible message box options. The actual code necessary is quite simple.</dd></dl>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<p><br />
</p>
<h2><span class="mw-headline" id="Mouse_Area">Mouse Area</span></h2>
<dl><dd>Program limits the mouse to a box portion of the Windows desktop using the Rectangle <a href="TYPE.html" title="TYPE">TYPE</a> to define the mouse area.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> Rectangle
  left <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  top <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  right <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
  bottom <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> Rec <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> Rectangle


<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "User32"
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> ClipCursor%% (Rect <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> Rectangle) 'sets mouse box work area on desktop
  <a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> SetCursorPos (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> x <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> y <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>) 'move cursor position
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="SCREEN.html" title="SCREEN"><span style="color:#87cefa;">SCREEN</span></a> <a href="NEWIMAGE.html" title="NEWIMAGE"><span style="color:#87cefa;">_NEWIMAGE</span></a>(320, 200, 32)
SetCursorPos 40, 36  'move cursor to left side of desktop

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press a key and the mouse is boxed in!"
K$ = <a href="INPUT%24.html" title="INPUT$"><span style="color:#87cefa;">INPUT$</span></a>(1)

Rec.left = 600
Rec.top = 400
Rec.bottom = 700
Rec.right = 800
work%% = ClipCursor(Rec)

<a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> work%%
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Click the mouse and window to quit!"
DO
  m = <a href="MOUSEINPUT.html" title="MOUSEINPUT"><span style="color:#87cefa;">_MOUSEINPUT</span></a>

<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> <a href="MOUSEBUTTON.html" title="MOUSEBUTTON"><span style="color:#87cefa;">_MOUSEBUTTON</span></a>(2) <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> <a href="MOUSEBUTTON.html" title="MOUSEBUTTON"><span style="color:#87cefa;">_MOUSEBUTTON</span></a>(1)
SetCursorPos 40, 36 'attempts to move mouse to left

<a href="SYSTEM.html" title="SYSTEM"><span style="color:#87cefa;">SYSTEM</span></a> <i> </i>
</p>
<dl><dd><i>Note:</i> The left and top positions must be less than the bottom and right pixel position values. Click mouse to exit box area. Click program window to quit.</dd></dl>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Open_another_Program">Open another Program</span></h2>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;">
'Uses Kernel32 WinAPI to execute a program in a QB64 program.  Coded by Dav

<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a>
  Function WinExec (lpCmdLine AS <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nCmdShow AS <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

Winmode% = 1

'0 = Hides the window and activates another window.
'1 = Activates and displays a normal sized window. 
'2 = Activates the window and minimized to taskbar.
'3 = Activates the window and displays it as a maximized window.

'NOTE: If you do 0 (hide), you'll have to Kill the process using your TaskManager!!!

'=== Open notepad and load samples.txt in the QB64 directory

Filename$ = "notepad.exe samples.txt" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)

'NOTE: EXE filename must be a NULL terminates..<a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)...

Result = WinExec(Filename$, Winmode%)

'=== Show results ...

<a href="SELECT_CASE.html" title="SELECT CASE"><span style="color:#87cefa;">SELECT CASE</span></a> Result
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 0: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "System out of memory or resources."
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 2: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "The specified file was not found."
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 3: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "The specified path was not found."
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE</span></a> 11: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "The file is invalid (non-Win32 .EXE or error in .EXE image)."
   <a href="CASE.html" class="mw-redirect" title="CASE"><span style="color:#87cefa;">CASE IS</span></a> &gt; 31: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Program opened normally."
   <a href="CASE_ELSE.html" class="mw-redirect" title="CASE ELSE"><span style="color:#87cefa;">CASE ELSE</span></a>: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Unknown error: "; Result
<a href="END_SELECT.html" title="END SELECT"><span style="color:#87cefa;">END SELECT</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code by Dav</span></center>
<dl><dd><i>Note:</i> The Library file can only run valid Windows executable programs. Not DOS console EXE programs!</dd></dl>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Play_WAV_Sounds">Play WAV Sounds</span></h2>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SND_SYNC = 0 'Windows controlled
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SND_ASYNC = 1 'user controlled
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SND_NODEFAULT = 2 'only plays sound file requested
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SND_LOOP = 8 'loops the sound. Use ASYNC also to stop later
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SND_NOSTOP = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10 'does not allow a sound to be stopped
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SND_NOWAIT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2000 'will not play sound if driver is busy
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SND_PURGE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>40 'stop any sound playing 

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "winmm"
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> PlaySound% <a href="ALIAS.html" class="mw-redirect" title="ALIAS"><span style="color:#87cefa;">ALIAS</span></a> PlaySoundA (lpszName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hModule <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwFlags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="LINE_INPUT.html" title="LINE INPUT"><span style="color:#87cefa;">LINE INPUT</span></a> "Enter WAV sound file name: ", FileName$
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Play asynchronously?(Y/N) ";
K$ = <a href="UCASE%24.html" title="UCASE$"><span style="color:#87cefa;">UCASE$</span></a>(<a href="INPUT%24.html" title="INPUT$"><span style="color:#87cefa;">INPUT$</span></a>(1))
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> K$
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> K$ = "Y" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> Synch = SND_ASYNC <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> Synch = SND_SYNC

retval% = PlaySound(FileName$, 0, Synch) <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code by Ted Weissgerber</span></center>
<dl><dd><i>Note:</i> ASYNC allows the program to stop the sound by sending a null file name. Flag constants can be added so loop and ASYNC would total 9.</dd></dl>
<p><br />
</p>
<center><b><a rel="nofollow" class="external text" href="http://msdn.microsoft.com/en-us/library/ms712636">WINMM.DLL Functions</a></b></center>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<p><br />
</p>
<h2><span class="mw-headline" id="Run_One_Instance">Run One Instance</span></h2>
<p>Program catches another instance of the program descriptor label running and closes it
</p>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> ERROR_ALREADY_EXISTS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>B7

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "kernel32"
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> CreateMutexA%&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpMutexAttributes%&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> bInitialOwner&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpName%&amp;)
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetLastError~&amp; ()
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>

t = "Global\Some name unique to your program" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
' see: <a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/ms682411(v=vs.85)">http://msdn.microsoft.com/en-us/library/ms682411%28v=vs.85%29</a>

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> 0 = CreateMutexA(0, 0, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(t)) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "CreateMutexA failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError))
 <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> ERROR_ALREADY_EXISTS = GetLastError <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Sorry. There can be only one."
 <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a> 2
 <a href="SYSTEM.html" title="SYSTEM"><span style="color:#87cefa;">SYSTEM</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "But the most wonderful thing about tiggers is I'm the only one."
<a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a> = <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1B)
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="SYSTEM.html" title="SYSTEM"><span style="color:#87cefa;">SYSTEM</span></a>
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Michael Calkins</span></center>
<dl><dd><i>Explanation:</i> The same identification string is used in both instances of the running program. Compile example, run the EXE and try to compile and run another instance. 'Sorry. There can be only one.' will be printed to the screen and then it will close.</dd></dl>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Send_Keys">Send Keys</span></h2>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'============
'SENDKEYS.BAS
'============
'A kind of SENDKEYS clone for QB64. Sends keystrokes to active application.
'Coded for QB64 by Dav, JAN/2013


<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
    <a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> SENDKEYS <a href="ALIAS.html" class="mw-redirect" title="ALIAS"><span style="color:#87cefa;">ALIAS</span></a> keybd_event (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> bVk <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> bScan <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwFlags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwExtraInfo <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> KEYEVENTF_KEYUP = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> VK_SNAPSHOT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2C 'PrtScn key
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> VK_MENU = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>12 'Alt key
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> VK_SHIFT = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10 'Shift key
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> VK_LWIN = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5B

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> ""
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "SENDKEYS clone example.  Press ENTER to begin..."
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>

<a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a> &lt;&gt; <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(13): <a href="WEND.html" class="mw-redirect" title="WEND"><span style="color:#87cefa;">WEND</span></a>

'=== Capture Active window to Clipoard as image (Like Alt+PrtSc)
SENDKEYS VK_MENU, 0, 0, 0
SENDKEYS VK_SNAPSHOT, 0, 0, 0
SENDKEYS VK_SNAPSHOT, 0, KEYEVENTF_KEYUP, 0
SENDKEYS VK_MENU, 0, KEYEVENTF_KEYUP, 0

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "SENDKEYS just sent a Alt+PrtSc keyboard press."
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "A screen-cap of this EXE <a href="WINDOW.html" title="WINDOW"><span style="color:#87cefa;">WINDOW</span></a> was just sent to your clipboard."
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Go ahead, check it now, then come back here and press ENTER..."

<a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a> &lt;&gt; <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(13): <a href="WEND.html" class="mw-redirect" title="WEND"><span style="color:#87cefa;">WEND</span></a>

'=== Capture Desktop screen to Clipoard as image (Like Shift+PrtSc)
SENDKEYS VK_SHIFT, 0, 0, 0
SENDKEYS VK_SNAPSHOT, 0, 0, 0
SENDKEYS VK_SNAPSHOT, 0, KEYEVENTF_KEYUP, 0
SENDKEYS VK_SHIFT, 0, KEYEVENTF_KEYUP, 0

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Now SENDKEYS just sent a Shift+PrtSc keyboard press."
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "A screen-cap of your DESKTOP was just sent to your clipboard."
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Go ahead, check it now, then come back here and press ENTER..."
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>

<a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a> &lt;&gt; <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(13): <a href="WEND.html" class="mw-redirect" title="WEND"><span style="color:#87cefa;">WEND</span></a>

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Now 'Notepad.exe' will open and SENDKEYS will send text to it."
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press ENTER to do that now, then close notepad, come back here,"
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "and press ENTER to continue..."

<a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a> &lt;&gt; <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(13): <a href="WEND.html" class="mw-redirect" title="WEND"><span style="color:#87cefa;">WEND</span></a>

<a href="SHELL.html" title="SHELL"><span style="color:#87cefa;">SHELL</span></a> <a href="DONTWAIT.html" title="DONTWAIT"><span style="color:#87cefa;">_DONTWAIT</span></a> "notepad.exe"

<a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a> 1 'give time to make notepad the active window...

'=== Say Hi...
SENDKEYS <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>48, 0, 0, 0: SENDKEYS <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>48, 0, KEYEVENTF_KEYUP, 0 'H
SENDKEYS <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>49, 0, 0, 0: SENDKEYS <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>49, 0, KEYEVENTF_KEYUP, 0 'i

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Now press ENTER for SENDKEYS to Minimize all your windows..."
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>

<a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a> &lt;&gt; <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(13): <a href="WEND.html" class="mw-redirect" title="WEND"><span style="color:#87cefa;">WEND</span></a>

'=== Minimize windows shortcut
SENDKEYS VK_LWIN, 0, 0, 0
SENDKEYS <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4D, 0, 0, 0
SENDKEYS VK_LWIN, 0, KEYEVENTF_KEYUP, 0

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "That's all. have a nice day."

<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Dav</span></center>
<p style="padding: 1em; line-height:100%; margin-left:10px; white-space: pre; font-family: courier; background-color: white; color: darkgreen;">'                                  <b>Virtual KeyState Codes</b>
'
'<b> Esc  F1  F2  F3  F4  F5  F6  F7  F8  F9  F10  F11 F12   Sys ScL Pause</b>                  
' 27   112 113 114 115 116 117 118 119 120 121  122 123   44  145 19
'<b> `~  1!  2@  3#  4$  5%  6^  7&amp;  8* 9(  0) -_  =+  BkS   Ins Hme PUp   NumL  /   *    -</b> 
' 192 49  50  51  52  53  54  55  56  57 48 189 187  8    45  36  33    144  111  106 109
'<b> Tab Q   W   E   R   T   Y   U   I   O   P  [{  ]}  \|   Del End PDn   7Hme 8/  9PU  +</b>
'  9  81  87  69  82  84  89  85  73  79  80 219 221 120  46  35  34    103  104  105 107
'<b> CapL  A   S   D   F   G   H   J   K   L   ;:  '" Enter                4/-  5   6/- E</b>
'  20   65  83  68  70  71  72  74  75  76 186 222  13                  100  101  102  <b>n</b>                                                                                                                          
'<b> Shift  Z   X   C   V   B   N   M   ,&lt;  .&gt;  /?    Shift               1End 2/  3PD  t</b>
' 16/160 90  88  67  86  66  78  77 188  190 191   16/161      38       97   98   99   <b>e</b>                                                                                       
'<b> Ctrl   Win   Alt       Spacebar      Alt Win Menu Ctrl   -     -   0Ins     .Del  r</b>
' 17/162 91  18/164        32        18/165 92  93 17/163  37  40  39   96        110  13
'
'     Num Lock On values shown. Off values same as functions and arrows, 5 = code 12.
'
'  <b>Mouse click returns: LB = 1, RB = 2, MB = 4, etc. <a rel="nofollow" class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx">Special keys</a> may also work.</b>
</p> 
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">NOTE: The above commented table can be copied and pasted directly into the QB64 IDE</span></center>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="System_Metrics">System Metrics</span></h2>
<dl><dd>Returns the dimensions of the current user's desktop. Can be used to get various Windows settings.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXSCREEN = 0 'Width of user desktop
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYSCREEN = 1 'Height of user desktop
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXFULLSCREEN = 16 ' Width of window client area
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYFULLSCREEN = 17 ' Height of window client area
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYMENU = 15 ' Height of menu
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYCAPTION = 4 ' Height of caption or title
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXFRAME = 32 ' Width of window frame
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYFRAME = 33 ' Height of window frame
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXHSCROLL = 21 ' Width of arrow bitmap on horizontal scroll bar
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYHSCROLL = 3 ' Height of arrow bitmap on horizontal scroll bar
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXVSCROLL = 2 ' Width of arrow bitmap on vertical scroll bar
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYVSCROLL = 20 ' Height of arrow bitmap on vertical scroll bar
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXSIZE = 30 ' Width of bitmaps in title bar
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYSIZE = 31 ' Height of bitmaps in title bar
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXCURSOR = 13 ' Width of cursor
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYCURSOR = 14 ' Height of cursor
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXBORDER = 5 ' Width of window frame that cannot be sized
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYBORDER = 6 ' Height of window frame that cannot be sized
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXDOUBLECLICK = 36 ' Width of rectangle around the location of the first click.
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYDOUBLECLICK = 37 ' Height of rectangle around the location of the first click.
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXDLGFRAME = 7 ' Width of dialog frame window
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYDLGFRAME = 8 ' Height of dialog frame window
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXICON = 11 ' Width of icon
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYICON = 12 ' Height of icon
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXICONSPACING = 38 ' Width of rectangles the system uses to position tiled icons
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYICONSPACING = 39 ' Height of rectangles the system uses to position tiled icons
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXMIN = 28 ' Minimum width of window
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYMIN = 29 ' Minimum height of window
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXMINTRACK = 34 ' Minimum tracking width of window
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYMINTRACK = 35 ' Minimum tracking height of window
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CXHTHUMB = 10 ' Width of scroll box (thumb) on horizontal scroll bar
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_CYVTHUMB = 9 ' Width of scroll box (thumb) on vertical scroll bar
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_DBCSENABLED = 42 ' Returns a non-zero if the current Windows version uses double-byte characters, otherwise zero
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_DEBUG = 22 ' Returns non-zero if the Windows version is a debugging version
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_MENUDROPALIGNMENT = 40 'Alignment of pop-up menus.
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_MOUSEPRESENT = 19 ' Non-zero if mouse hardware is installed
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_PENWINDOWS = 41 ' Handle of Pen Windows dynamic link library if Pen Windows is installed
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SM_SWAPBUTTON = 23 ' Non-zero if the left and right mouse buttons are swapped

<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a>
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetSystemMetrics&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> n <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> trimstr$(GetSystemMetrics(SM_CXSCREEN)); "x"; trimstr$(GetSystemMetrics(SM_CYSCREEN))

s&amp; = <a href="SCREENIMAGE.html" title="SCREENIMAGE"><span style="color:#87cefa;">_SCREENIMAGE</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="WIDTH_(function).html" title="WIDTH (function)"><span style="color:#87cefa;">_WIDTH</span></a>(s&amp;); "X"; <a href="HEIGHT.html" title="HEIGHT"><span style="color:#87cefa;">_HEIGHT</span></a>(s&amp;)

<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> 3

<a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> trimstr$ (whatever)
trimstr = <a href="LTRIM%24.html" title="LTRIM$"><span style="color:#87cefa;">LTRIM$</span></a>(<a href="RTRIM%24.html" title="RTRIM$"><span style="color:#87cefa;">RTRIM$</span></a>(<a href="STR%24.html" title="STR$"><span style="color:#87cefa;">STR$</span></a>(whatever)))
<a href="END_FUNCTION.html" title="END FUNCTION"><span style="color:#87cefa;">END FUNCTION</span></a> <i> </i>
</p>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Top_Most_Window">Top Most Window</span></h2>
<dl><dd>This Windows only procedure will make the program window always stay on top of other windows, but not always in focus. (See <a href="Windows_Libraries.html#Focus" title="Windows Libraries">Windows Focus</a>)</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'public domain

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_NOSIZE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0001      'ignores cx and cy size parameters
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_NOMOVE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0002      'ignores x and y position parameters
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_NOZORDER = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0004    'keeps z order and ignores hWndInsertAfter parameter
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_NOREDRAW = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0008    'does not redraw window changes
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_NOACTIVATE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0010  'does not activate window
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_FRAMECHANGED = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0020
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_SHOWWINDOW = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0040  
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_HIDEWINDOW = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0080
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_NOCOPYBITS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0100
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_NOOWNERZORDER = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0200
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_NOSENDCHANGING = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0400
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_DRAWFRAME = SWP_FRAMECHANGED
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_NOREPOSITION = SWP_NOOWNERZORDER
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_DEFERERASE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2000
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_ASYNCWINDOWPOS = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>4000
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HWND_TOP = 0        'window at top of z order no focus
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HWND_BOTTOM = 1     'window at bottom of z order no focus
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HWND_TOPMOST = -1   'window above all others no focus unless active
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HWND_NOTOPMOST = -2 'window below active no focus

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindowA%&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpClassName%&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpWindowName%&amp;)
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SetWindowPos&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hWnd%&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hWndInsertAfter%&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> X&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> Y&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> cx&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> cy&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> uFlags~&amp;)
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetForegroundWindow%&amp;
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "kernel32"
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetLastError~&amp; ()
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> hWnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>

<a href="RANDOMIZE.html" title="RANDOMIZE"><span style="color:#87cefa;">RANDOMIZE</span></a> <a href="TIMER.html" title="TIMER"><span style="color:#87cefa;">TIMER</span></a>
t = <a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(<a href="RND.html" title="RND"><span style="color:#87cefa;">RND</span></a> * <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1000000) 'random title for FindWindowA
<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> t
t = t + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
hWnd = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindowA(0, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(t))
<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> "This Window will always be on Top" 'any title

<a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 4 'delay allows user to click focus on other windows

'set as topmost window and move without sizing or activation
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> 0 = SetWindowPos(hWnd, HWND_TOPMOST, 200, 200, 0, 0, SWP_NOSIZE <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> SWP_NOACTIVATE) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "SetWindowPos failed. 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError))
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

x%&amp; = GetForegroundWindow%&amp; 'find currently focused process handle

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Program handle:"; hWnd; "Focus handle:"; x%&amp;
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> hWnd &lt;&gt; x%&amp; <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="SCREENCLICK.html" title="SCREENCLICK"><span style="color:#87cefa;">_SCREENCLICK</span></a> 240, 240 'add 40 to x and y to focus on positioned window

<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Adapted from code by Michael Calkins</span></center>
<dl><dd><i>Explanation:</i> When other windows are clicked on, this program window will stay on top. Click it to return focus.
<dl><dd><i>SetWindowPos</i> can also move the window's TLC corner position and re-size the window when not flagged.</dd>
<dd>When the window is moved to a position, <a href="SCREENCLICK.html" title="SCREENCLICK">_SCREENCLICK</a> can be used to focus on the program window.</dd></dl></dd></dl>
<center><b><i><a href="Windows_Libraries.html#Focus" title="Windows Libraries">SetForegroundWindow</a></i> will not work with the <i>SetWindowPos</i>!</b></center>
<p><br />
</p>
<center><a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/ms633545(v=vs.85)">http://msdn.microsoft.com/en-us/library/ms633545%28v=vs.85%29</a></center>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Video_File_Player">Video File Player</span></h2>
<p>Video player for MPG or AVI video files: 
</p>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"><a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "WINMM"
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> mciSendStringA% (lpstrCommand <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, lpstrReturnString <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> uReturnLength <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwndCallback <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>)
    ' mciSendStringA function plays media files and returns the following:
    ' 0 = command sucessful
    ' - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    ' lpstrCommand is the MCI command string (and optional flags) to send.
    ' lpstrReturnString is a string that holds any return information.
    ' uReturnLength is the length of the lpstrReturnString string passed.
    ' <a href="NOT.html" title="NOT"><span style="color:#87cefa;">NOT</span></a>E: If lpstrCommand given doesn't retun a value then lpstrReturnString
    '       can be empty and uReturnLength can be set to 0.
    ' hwndCallback contains a callback window handle (only if the Notify flag used in lpstrCommand)
    '====================================================================
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> mciGetErrorStringA% (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwError <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>, lpstrBuffer <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> uLength <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>)
    ' mciGetErrorStringA returns error info if the mciSendStringA failed.
    ' dwError is the return value from the mciSendString function.
    ' lpstrBuffer string holds the error information returned by the function.
    ' uLength is the length of the lpstrBuffer string buffer.
    '====================================================================
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE CUSTOMTYPE LIBRARY</span></a>
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindow&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> ClassName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, WindowName$)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>


handle&amp; = <a href="NEWIMAGE.html" title="NEWIMAGE"><span style="color:#87cefa;">_NEWIMAGE</span></a>(800, 600, 256)
<a href="SCREEN.html" title="SCREEN"><span style="color:#87cefa;">SCREEN</span></a> handle&amp;


<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> "QB64 Video"
hwnd&amp; = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindow(0, "QB64 Video" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0))

ReturnString$ = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(255)
ErrorString$ = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(255)
filename$ = "c:\DavPiano.mpg" '&lt;========== video file to play

a% = mciSendStringA%("open " + filename$ + " style popup", ReturnString$, <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(ReturnString$), 0)

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> a% <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    x% = mciGetErrorStringA%(a%, ErrorString$, <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(ErrorString$))
    <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> ErrorString$
    <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
    a2% = mciSendStringA%("window " + filename$ + " handle " + <a href="STR%24.html" title="STR$"><span style="color:#87cefa;">STR$</span></a>(hwnd&amp;), ReturnString$, <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(ReturnString$), 0)
    b% = mciSendStringA%("play " + filename$, "", 0, 0)
    <a href="SCREENMOVE.html" title="SCREENMOVE"><span style="color:#87cefa;">_SCREENMOVE</span></a> <a href="SCREENMOVE.html" title="SCREENMOVE"><span style="color:#87cefa;">_MIDDLE</span></a>
    '=== Play video...
    <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LIMIT.html" title="LIMIT"><span style="color:#87cefa;">_LIMIT</span></a> 30: <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a> &lt;&gt; ""

    x% = mciSendStringA%("stop " + filename$, "", 0, 0)
    x% = mciSendStringA%("close " + filename$, "", 0, 0)
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Dav</span></center>
<p><br />
</p><p><br />
</p>
<h2><span class="mw-headline" id="Web_Page_Download">Web Page Download</span></h2>
<dl><dd>Downloads the contents of a web page as an HTML or text file. Text can be edited for page information.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "urlmon"
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> URLDownloadToFileA% (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> pCaller <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, szURL <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, szFileName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwReserved <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpfnCB <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

'=== URL to grab (page or a file)
URL$ = "http://www.qbasicnews.com/dav/"
'=== File to save URL as
URLfile$ = "DavsIndex.html"

'=== Download it.  Returns 0 if succeeded
a% = URLDownloadToFileA%(0, URL$, URLfile$, 0, 0)

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Grabbing&#160;: "; URL$: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Saving as: "; URLfile$
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Sleeping 7 secs to do the deed..."
<a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a> 7
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> a% <i> </i>
</p> <center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Dav</span></center>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Windows_API">Windows API</span></h2>
<dl><dd>Program finds the window handle by the <a href="TITLE.html" title="TITLE">title</a> and then does various things with the window using that handle <a href="OFFSET.html" title="OFFSET">_OFFSET</a> value.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HWND_BOTTOM = 1     'places the window at the bottom of the Z order
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HWND_TOP = 0        'places the window at the top of the Z order
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HWND_TOPMOST = -1   'places the window above all non-topmost windows
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HWND_NOTOPMOST = -2 'places the window behind all topmost windows 

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindowA%&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> class <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, Title <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> CloseWindow%% (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> OpenIcon%% (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SetWindowTextA%% (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, NewTitle <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetWindowThreadProcessId&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpdwProcessId <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SetWindowPos%% (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd%&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hWndInsertAfter <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> X <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> Y <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> cx <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> cy <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> uFlags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> "Windows Test"
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a> hwnd
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a> ret
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a> PID

'// Get the window handle (as an offset)
hwnd = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindowA(0, "Windows Test" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0))
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Handle:"; hwnd
<a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 3

'// Minimize the window - places program on the task bar
ret = CloseWindow(hwnd)
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Minimize"; ret
<a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 3 '// wait a few seconds

'// Restore the window
ret = OpenIcon(hwnd)
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Restore"; ret
<a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 3

'// Sets window priority as TOPMOST and moves the window position column 200, row 0 
ret = SetWindowPos(hwnd, HWND_TOPMOST, 200, 0, 0, 0, 0)
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Position"; ret
<a href="DELAY.html" title="DELAY"><span style="color:#87cefa;">_DELAY</span></a> 3

'// Change the title of window header to new name
ret = SetWindowTextA(hwnd, "Windows API Test")
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Title"; ret

'// Get and display the process id for the window using new title name
PID = GetWindowThreadProcessId(hwnd, 0)
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Process ID:"; PID
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Adapted from header code by Cyperium and Unseenmachine</span></center>
<dl><dd><i>Note:</i> <i>SetWindowPos&amp;</i> function sets the pixel location on the desktop and the window dimensions. It can also set the window's Z order priority.</dd></dl>
<center><b>The window handle value and process ID never change! Even when the title is changed.</b></center>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Window_Focus">Window Focus</span></h2>
<p>Windows API routine can tell a program when it has lost focus by the user clicking on a different program window or the desktop.
</p>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetForegroundWindow%&amp; ()
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindowA%&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpClassName%&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpWindowName%&amp;)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> title <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> hWnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>

title = "Whatever you actually want the title to be"
<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> title
title = title + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0) 'always add character zero to FindWindowA string parameter
hWnd = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindowA(0, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(title))

<a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>)
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> hWnd = GetForegroundWindow <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "foreground" <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "not foreground"
    <a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a> 1
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Adapted from code by Michael Calkins</span></center>
<dl><dd><i>Note:</i> <a href="CHR%24.html" title="CHR$">CHR$</a>(0) could actually be added to the original title string and it wouldn't hurt anything. Compared values are <a href="OFFSET.html" title="OFFSET">_OFFSETs</a>.</dd></dl>
<center><b>See <a href="Windows_Libraries.html#Focus" title="Windows Libraries">SetForegroundWindow to set Focus</a> on program.</b></center>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Windows_Menu">Windows Menu</span></h2>
<center><b>Creates a menu bar in the program window with a name that can be clicked on to execute a procedure.</b></center>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="DEFLNG.html" title="DEFLNG"><span style="color:#87cefa;">DEFLNG</span></a> A-Z

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MIIM_STATE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MIIM_ID = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MIIM_TYPE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MFT_SEPARATOR = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>800
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MFT_STRING = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MFS_ENABLED = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>0
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MFS_CHECKED = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>8

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HWND_TOPMOST = -1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> HWND_NOTOPMOST = -2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_NOMOVE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SWP_NOSIZE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1
'-----------------------------------------------------------------------------------

<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> MENUITEMINFO
    cbSize <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    fMask <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    fType <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    fState <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    wID <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    hSubMenu <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    hbmpChecked <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    hbmpUnchecked <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
    dwItemData <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
    dwTypeData <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
    cch <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>

<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a>
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindow&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> ClassName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, WindowName$) ' To get hWnd handle
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> CreateMenu&amp; ()
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> DrawMenuBar (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hWnd&amp;)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SetMenu&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hWnd&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hMenu&amp;)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> InsertMenuItemA&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hMenu&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> uItem&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> fByPosition&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpmii <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetMenuItemCount&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hMenu&amp;)
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetMenuItemInfoA&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hMenu&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> uItem&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> fByPosition&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpmii <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> hWnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> hMenu <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> MenuItem <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> MENUITEMINFO, BlankMenuItem <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> MENUITEMINFO
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> TypeData <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> * 1000

<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> "Menu bar API demo"
hWnd = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindow(0, "Menu bar API demo" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0))

hMenu = CreateMenu: BlankMenuItem.cbSize = <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(BlankMenuItem)

<a href="COLOR.html" title="COLOR"><span style="color:#87cefa;">COLOR</span></a> 7, 1: <a href="CLS.html" title="CLS"><span style="color:#87cefa;">CLS</span></a>

'Add a separator bar
count = GetMenuItemCount(hMenu): <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "MenuItemCount:"; count
MenuItem = BlankMenuItem
MenuItem.fMask = MIIM_ID <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> MIIM_<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>
MenuItem.fType = MFT_SEPARATOR
MenuItem.wID = count
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> InsertMenuItemA(hMenu, count, 1, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(MenuItem)) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Successfully added menu item!" <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Failed to add menu item!": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>

'Add a button
MenuItem = BlankMenuItem
count = GetMenuItemCount(hMenu): <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "MenuItemCount:"; count
MenuItem.fMask = MIIM_STATE <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> MIIM_ID <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> MIIM_TYPE
MenuItem.fType = MFT_STRING
MenuItem.fState = MFS_ENABLED
MenuItem.wID = count
TypeData = "&amp;Fire Laser!" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
MenuItem.dwTypeData = <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(TypeData)
MenuItem.cch = <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(MenuItem.dwTypeData)
MyButton = MenuItem.wID
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> InsertMenuItemA(hMenu, count, 1, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(MenuItem)) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Successfully added menu item!" <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Failed to add menu item!": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> SetMenu(hWnd, hMenu) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Successfully set menu!": <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Menu handle is:"; hMenu <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Failed to set menu!": <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>

<a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a>: <a href="LIMIT.html" title="LIMIT"><span style="color:#87cefa;">_LIMIT</span></a> 70
    prev_state = new_state
    ok = GetMenuItemInfoA(hMenu, MyButton, 1, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(MenuItem))
    new_state = MenuItem.fState <a href="AND.html" title="AND"><span style="color:#87cefa;">AND</span></a> 128
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> prev_state = 0 <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> new_state &lt;&gt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Ouch! ";
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a> = "" <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code by Galleon</span></center>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Windows_Notification">Windows Notification</span></h2>
<p>The following code creates a pop-up notification balloon in the Windows task bar or from the Windows 10 side bar.
</p>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;">

'public domain, 2012 feb, michael calkins

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> NIM_ADD = 0
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> NIM_MODIFY = 1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> NIM_DELETE = 2

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> NIF_ICON = 2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> NIF_TIP = 4
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> NIF_INFO = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> NIIF_NONE = 0
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> NIIF_INFO = 1
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> NIIF_WARNING = 2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> NIIF_ERROR = 3
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> NIIF_USER = 4

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDI_APPLICATION = 32512
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDI_HAND = 32513
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDI_QUESTION = 32514
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDI_EXCLAMATION = 32515
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> IDI_ASTERISK = 32516

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "kernel32"
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetLastError~&amp; ()
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindowA%&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpClassName%&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpWindowName%&amp;)
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> LoadIconA%&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hInstance%&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpIconName%&amp;)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "shell32"
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> Shell_NotifyIconA&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwMessage~&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpdata%&amp;)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a> <a href="NOT.html" title="NOT"><span style="color:#87cefa;">NOT</span></a>IFYICONDATA
 cbSize <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
 hWnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
 uID <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
 uFlags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
 uCallbackMessage <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
 hIcon <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
 szTip <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> * 128
 dwState <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
 dwStateMask <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
 szInfo <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> * 256
 uTimeout <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
 szInfoTitle <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a> * 64
 dwInfoFlags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <a href="TYPE.html" title="TYPE"><span style="color:#87cefa;">TYPE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> hWnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> hIcon <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> t <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> notifydata <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> NOTIFYICONDATA
notifydata.cbSize = <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(notifydata)

t = "qb64 notification test"
<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> t
t = t + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
hWnd = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindowA(0, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(t)) 'find window ID
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> hWnd = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "FindWindowA failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError))
 <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

hIcon = LoadIconA(0, IDI_ASTERISK)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> hIcon = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "LoadIconA failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError))
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
'first notification
notifydata.hWnd = hWnd
notifydata.uID = 0
notifydata.uFlags = NIF_ICON <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> NIF_TIP <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> NIF_INFO
notifydata.hIcon = hIcon
notifydata.szTip = "Connect charger!" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0) 'tool tip
notifydata.szInfo = "Recharge" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0) 'information
notifydata.uTimeout = 10000 'milliseconds
notifydata.szInfoTitle = "Low Battery" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0) 'balloon title FALSE LOW BATTERY warning 
notifydata.dwInfoFlags = NIIF_INFO

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> 0 = Shell_NotifyIconA(NIM_ADD, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(notifydata)) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Shell_NotifyIconA failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError))
 <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press any key to modify it."
<a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>: <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>): <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>

hIcon = LoadIconA(0, IDI_HAND)
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> hIcon = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "LoadIconA failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError))
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
'second notification
notifydata.uFlags = NIF_ICON <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> NIF_TIP <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> NIF_INFO
notifydata.hIcon = hIcon
notifydata.szTip = "hahaha" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
notifydata.szInfo = ":-)" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
notifydata.uTimeout = 10000 'milliseconds
notifydata.szInfoTitle = "Howdy." + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)
notifydata.dwInfoFlags = NIIF_WARNING

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> 0 = Shell_NotifyIconA(NIM_MODIFY, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(notifydata)) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Shell_NotifyIconA failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError))
 <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>


<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press any key to delete the notification icon."
<a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a>: <a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(<a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>): <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> 0 = Shell_NotifyIconA(NIM_DELETE, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(notifydata)) <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Shell_NotifyIconA failed. Error: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(GetLastError))
 <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Adapted from code by Michael Calkins</span></center>
<center><b>NOTE: The program emulates a FALSE Low Battery warning!</b></center>
<p><br />
</p>
<dl><dd><i>MSDN References:</i></dd></dl>
<center><a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499%28v=vs.85%29.aspx</a>
<p><a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms648072(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/ms648072%28v=vs.85%29.aspx</a>
</p><p><a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb762159(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/bb762159%28v=vs.85%29.aspx</a>
</p>
<a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb773352(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/bb773352%28v=vs.85%29.aspx</a> </center>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Windows_Ports">Windows Ports</span></h2>
<dl><dd>The following library uses QueryDosDeviceA to find the COM or LPT ports on a Windows computer only.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'this example uses QueryDosDeviceA to enumerate COM ports.
'public domain, sept 2011, michael calkins

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "kernel32"
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> QueryDosDeviceA~&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpDeviceName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> lpTargetPath <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> ucchMax <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetLastError~&amp; ()
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> sizeofbuffer <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> buffer <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> i <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> x <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> n <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
sizeofbuffer = 1024
buffer = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(sizeofbuffer)

DO
 x = 0
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> QueryDosDeviceA~&amp;(0, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(buffer), sizeofbuffer) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
  x = GetLastError~&amp;
  <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> x = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7A <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
   sizeofbuffer = sizeofbuffer + 1024
   buffer = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(sizeofbuffer)
  <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
   <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Error: 0x"; <a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(x)
   <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
  <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
 <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> x = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7A

i = 1
n = 0
<a href="DO...html" title="DO...LOOP"><span style="color:#87cefa;">DO</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> <a href="ASC.html" title="ASC"><span style="color:#87cefa;">ASC</span></a>(<a href="MID%24.html" title="MID$"><span style="color:#87cefa;">MID$</span></a>(buffer, i, 1))
 x = <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(i, buffer, <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0))
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="MID%24.html" title="MID$"><span style="color:#87cefa;">MID$</span></a>(buffer, i, x - i)
 <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="MID%24.html" title="MID$"><span style="color:#87cefa;">MID$</span></a>(buffer, i, 3) = "COM" <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> 'change to "LPT" for parallel ports
  <a href="REDIM.html" title="REDIM"><span style="color:#87cefa;">REDIM</span></a> <a href="PRESERVE.html" title="PRESERVE"><span style="color:#87cefa;">_PRESERVE</span></a> comports(0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> (n * 2) + 1) <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
  comports(n * 2) = <a href="MID%24.html" title="MID$"><span style="color:#87cefa;">MID$</span></a>(buffer, i, (x - i) + 1)
  n = n + 1
 <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
 i = x + 1
<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a>

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a>
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> n; "COM ports:"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> n <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
 <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> i = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> n - 1
  DO
   x = 0
   <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> QueryDosDeviceA~&amp;(<a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(comports(i * 2)), <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(buffer), sizeofbuffer) = 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
    x = GetLastError~&amp;
    <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> x = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7A <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>
     sizeofbuffer = sizeofbuffer + 1024
     buffer = <a href="SPACE%24.html" title="SPACE$"><span style="color:#87cefa;">SPACE$</span></a>(sizeofbuffer)
    <a href="ELSE.html" title="ELSE"><span style="color:#87cefa;">ELSE</span></a>
     <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Error: 0x"; <a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(x)
     <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
    <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
   <a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>
  <a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="WHILE.html" title="WHILE"><span style="color:#87cefa;">WHILE</span></a> x = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>7A
  comports((i * 2) + 1) = <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(buffer, <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(buffer, <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)) - 1)
  comports(i * 2) = <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(comports(i * 2), <a href="LEN.html" title="LEN"><span style="color:#87cefa;">LEN</span></a>(comports(i * 2)) - 1)
  <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>22); comports(i * 2); <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>22); " is mapped to: "; <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>22); comports((i * 2) + 1); <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>22)
 <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

buffer = ""

<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Michael Calkins</span></center>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<p><br />
</p>
<h2><span class="mw-headline" id="Windows_Sounds">Windows Sounds</span></h2>
<dl><dd>MessageBeep plays Windows alert sound files located in the <i>C:\windows\media</i> folder. Some may not be set!</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_OK = 0 'beep
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_ICONERROR = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_ICONQUESTION = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>20
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_ICONWARNING = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>30
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MB_ICONASTERISK = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>40

<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a>
  <a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> MessageBeep (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> alert <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "OK"
MessageBeep MB_OK

<a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a> 2
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Error"
MessageBeep MB_ICONERROR

<a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a> 2
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "?"
MessageBeep MB_ICONQUESTION

<a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a> 2
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Warning"
MessageBeep MB_ICONWARNING

<a href="SLEEP.html" title="SLEEP"><span style="color:#87cefa;">SLEEP</span></a> 2
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Asterisk"
MessageBeep MB_ICONASTERISK
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code by Ted Weissgerber</span></center>
<dl><dd><i>Note:</i> The sounds can be set in <i>Control Panel: Sounds and Audio Devices/Sounds</i> settings tab if not already assigned.</dd></dl>
<p><br />
</p>
<dl><dd>PlaySound plays Windows System sounds on most PC's:</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;">'SDL-SPECIFIC CHANGES! GL only needs DECLARE LIBRARY without DLL name 

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "Winmm"
    <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> PlaySound (pszSound <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hmod <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> fdwSound <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="INTEGER.html" title="INTEGER"><span style="color:#87cefa;">INTEGER</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SND_<a href="ALIAS.html" class="mw-redirect" title="ALIAS"><span style="color:#87cefa;">ALIAS</span></a> = 65536
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SND_ASYNC = 1

x = PlaySound("SystemExclamation" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0), 0, SND_<a href="ALIAS.html" class="mw-redirect" title="ALIAS"><span style="color:#87cefa;">ALIAS</span></a> + SND_ASYNC)
</p>
<dl><dd>Use "SystemDefault", "SystemExclamation", "SystemExit", "SystemHand", "SystemQuestion", "SystemStart" or "SystemWelcome"</dd></dl>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Window_Transparency">Window Transparency</span></h2>
<dl><dd>Program changes transparency of the window. Plus key increases visibility while minus key can make it completely invisible.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="DEFINT.html" title="DEFINT"><span style="color:#87cefa;">DEFINT</span></a> A-Z

' Declare windows API functions
<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
   <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SetLayeredWindowAttributes&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> crKey <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> bAlpha <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="UNSIGNED.html" title="UNSIGNED"><span style="color:#87cefa;">_UNSIGNED</span></a> <a href="BYTE.html" title="BYTE"><span style="color:#87cefa;">_BYTE</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwFlags <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
   <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetWindowLong&amp; <a href="ALIAS.html" class="mw-redirect" title="ALIAS"><span style="color:#87cefa;">ALIAS</span></a> "GetWindowLongA" (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nIndex <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
   <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SetWindowLong&amp; <a href="ALIAS.html" class="mw-redirect" title="ALIAS"><span style="color:#87cefa;">ALIAS</span></a> "SetWindowLongA" (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nIndex <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwNewLong <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

' Needed for acquiring the hWnd of the window
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a>
   <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> FindWindow&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> ClassName <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="OFFSET.html" title="OFFSET"><span style="color:#87cefa;">_OFFSET</span></a>, WindowName$) ' To get hWnd handle
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>


<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> MyHwnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

' Get hWnd value
<a href="TITLE.html" title="TITLE"><span style="color:#87cefa;">_TITLE</span></a> "Translucent window test"
MyHwnd = <a href="WINDOWHANDLE.html" title="WINDOWHANDLE"><span style="color:#87cefa;">_WINDOWHANDLE</span></a> 'FindWindow(0, "Translucent window test" + <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0))


' Set screen and draw a simple fractal which looks cooler than a black translucent window
<a href="SCREEN.html" title="SCREEN"><span style="color:#87cefa;">SCREEN</span></a> <a href="NEWIMAGE.html" title="NEWIMAGE"><span style="color:#87cefa;">_NEWIMAGE</span></a>(640, 480, 32)

<a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> Py = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> 479
   <a href="FOR...html" title="FOR...NEXT"><span style="color:#87cefa;">FOR</span></a> Px = 0 <a href="TO.html" title="TO"><span style="color:#87cefa;">TO</span></a> 639
      <a href="PSET.html" title="PSET"><span style="color:#87cefa;">PSET</span></a> (Px, Py), <a href="RGB32.html" title="RGB32"><span style="color:#87cefa;">_RGB32</span></a>((Px <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> Py) <a href="MOD.html" title="MOD"><span style="color:#87cefa;">MOD</span></a> 256, (Px + Py) <a href="MOD.html" title="MOD"><span style="color:#87cefa;">MOD</span></a> 256, Py <a href="MOD.html" title="MOD"><span style="color:#87cefa;">MOD</span></a> 256)
   <a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a> Px
<a href="NEXT.html" title="NEXT"><span style="color:#87cefa;">NEXT</span></a> Py


' Main loop
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Press +/- to change opacity"

Level = 127
SetWindowOpacity MyHwnd, Level
DO
   Press$ = <a href="INKEY%24.html" title="INKEY$"><span style="color:#87cefa;">INKEY$</span></a>
   <a href="LOCATE.html" title="LOCATE"><span style="color:#87cefa;">LOCATE</span></a> 2, 1: <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Opacity:"; Level

   ' Change window opacity whenever +/- are pressed
   <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> Press$ = "+" <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> Level &lt; 255 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> Level = Level + 1: SetWindowOpacity MyHwnd, Level
   <a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> Press$ = "-" <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> Level &gt; 0 <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> Level = Level - 1: SetWindowOpacity MyHwnd, Level

   <a href="LIMIT.html" title="LIMIT"><span style="color:#87cefa;">_LIMIT</span></a> 60

<a href="LOOP.html" title="LOOP"><span style="color:#87cefa;">LOOP</span></a> <a href="UNTIL.html" title="UNTIL"><span style="color:#87cefa;">UNTIL</span></a> Press$ = <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(27)
<a href="SYSTEM.html" title="SYSTEM"><span style="color:#87cefa;">SYSTEM</span></a>


'====================================================================\
<a href="SUB.html" title="SUB"><span style="color:#87cefa;">SUB</span></a> SetWindowOpacity (hWnd <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>, Level)
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> Msg <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> G = -20
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> LWA_ALPHA = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>2
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> WS_EX_LAYERED = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80000

Msg = GetWindowLong(hWnd, G)
Msg = Msg <a href="OR_(boolean).html" title="OR (boolean)"><span style="color:#87cefa;">OR</span></a> WS_EX_LAYERED
Crap = SetWindowLong(hWnd, G, Msg)
Crap = SetLayeredWindowAttributes(hWnd, 0, Level, LWA_ALPHA)

<a href="END_SUB.html" class="mw-redirect" title="END SUB"><span style="color:#87cefa;">END SUB</span></a> <i> </i>
</p><center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code by Jobert</span></center>
<p><br />
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Windows_User">Windows User</span></h2>
<dl><dd>Finds the current user's <i>My Documents</i> folder as a <a href="STRING.html" title="STRING">STRING</a> value. Other environmental constants are listed below code.</dd></dl>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
'public domain

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> MAX_PATH = 260             'maximum length of path string
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> CSIDL_PERSONAL = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>5       'User's My Documents path. See environmental constants below
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> SHGFP_TYPE_CURRENT = 0

<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> S_OK = 0                   'environmental value found
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> S_FALSE = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>1              'folder does not exist
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> E_FAILED = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80004005&amp;     'folder does not exist
<a href="CONST.html" title="CONST"><span style="color:#87cefa;">CONST</span></a> E_INVALIDARG = <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>80070057&amp; 'invalid argument parameter

<a href="DECLARE_DYNAMIC_LIBRARY.html" title="DECLARE DYNAMIC LIBRARY"><span style="color:#87cefa;">DECLARE DYNAMIC LIBRARY</span></a> "shell32"
 <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> SHGetFolderPathA&amp; (<a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hwndOwner%&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> nFolder&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> hToken%&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> dwFlags~&amp;, <a href="BYVAL.html" class="mw-redirect" title="BYVAL"><span style="color:#87cefa;">BYVAL</span></a> pszPath%&amp;)
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> path <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="STRING.html" title="STRING"><span style="color:#87cefa;">STRING</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> hr <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>
<a href="DIM.html" title="DIM"><span style="color:#87cefa;">DIM</span></a> n <a href="AS.html" title="AS"><span style="color:#87cefa;">AS</span></a> <a href="LONG.html" title="LONG"><span style="color:#87cefa;">LONG</span></a>

path = <a href="STRING%24.html" title="STRING$"><span style="color:#87cefa;">STRING$</span></a>(MAX_PATH, 0) 'enlarge the string to MAX_PATH

hr = SHGetFolderPathA(0, CSIDL_PERSONAL, 0, SHGFP_TYPE_CURRENT, <a href="OFFSET_(function).html" title="OFFSET (function)"><span style="color:#87cefa;">_OFFSET</span></a>(path))
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> hr <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a>                           
 <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "hresult: 0x" + <a href="LCASE%24.html" title="LCASE$"><span style="color:#87cefa;">LCASE$</span></a>(<a href="HEX%24.html" title="HEX$"><span style="color:#87cefa;">HEX$</span></a>(hr)) 'function returns non-zero error code
 <a href="END.html" title="END"><span style="color:#87cefa;">END</span></a>
<a href="END_IF.html" class="mw-redirect" title="END IF"><span style="color:#87cefa;">END IF</span></a>

n = <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(path, <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(0)) 'find terminating null

path = <a href="LEFT%24.html" title="LEFT$"><span style="color:#87cefa;">LEFT$</span></a>(path, n - 1) 'shrink the string (probably creates a temp string)
<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>22); path; <a href="CHR%24.html" title="CHR$"><span style="color:#87cefa;">CHR$</span></a>(<a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>22)
<a href="END.html" title="END"><span style="color:#87cefa;">END</span></a> <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Michael Calkins</span></center>
<dl><dd><i>Note:</i> When the SHGetFolderPathA&amp; function returns a non-zero value, the 0x hexadecimal error number is printed instead.</dd></dl>
<center><b><a rel="nofollow" class="external text" href="http://msdn.microsoft.com/en-us/library/bb776911(v=vs.85)">Vista and newer versions of Windows can also use SHGetKnownFolderPath and similar Constant values</a></b></center>
<p style="padding: 1em; line-height:100%; margin-left:10px; white-space: pre; font-family: courier; background-color: white; color: darkgreen;">                              <b>Windows CSIDL Environmental <a href="LONG.html" title="LONG">LONG</a> Constants</b>

 CONST CSIDL_DESKTOP = &amp;H0                  '&lt;user name&gt;\desktop
 CONST CSIDL_INTERNET = &amp;H1                 'Internet Explorer(icon on desktop)
 CONST CSIDL_PROGRAMS = &amp;H2                 '&lt;user name&gt;\Start Menu\Programs
 CONST CSIDL_CONTROLS = &amp;H3                 'My Computer\Control Panel icon group
 CONST CSIDL_PRINTERS = &amp;H4                 'My Computer\Printers (installed)
 CONST CSIDL_PERSONAL = &amp;H5                 '&lt;user name&gt;\My Documents
 CONST CSIDL_FAVORITES = &amp;H6                '&lt;user name&gt;\Favorites
 CONST CSIDL_STARTUP = &amp;H7                  '&lt;user name&gt;\Start Menu\Programs\Startup
 CONST CSIDL_RECENT = &amp;H8                   '&lt;user name&gt;\Recent
 CONST CSIDL_SENDTO = &amp;H9                   '&lt;user name&gt;\SendTo
 CONST CSIDL_BITBUCKET = &amp;HA                '&lt;user desktop&gt;\Recycle Bin
 CONST CSIDL_STARTMENU = &amp;HB                '&lt;user name&gt;\Start Menu
 CONST CSIDL_MYDOCUMENTS = &amp;HC              'logical "My Documents" desktop icon 
 CONST CSIDL_MYMUSIC = &amp;HD                  '&lt;user name&gt;\My Documents\My Music folder
 CONST CSIDL_MYVIDEO = &amp;HE                  '&lt;user name&gt;\My Documents\My Videos folder
 CONST CSIDL_DESKTOPDIRECTORY = &amp;H10        '&lt;user name&gt;\Desktop
 CONST CSIDL_DRIVES = &amp;H11                  'My Computer
 CONST CSIDL_NETWORK = &amp;H12                 'Network Neighborhood (My Network Places)
 CONST CSIDL_NETHOOD = &amp;H13                 '&lt;user name&gt;\nethood
 CONST CSIDL_FONTS = &amp;H14                   'windows\fonts
 CONST CSIDL_TEMPLATES = &amp;H15               'templates
 CONST CSIDL_COMMON_STARTMENU = &amp;H16        'All Users\Start Menu
 CONST CSIDL_COMMON_PROGRAMS = &amp;H17         'All Users\Start Menu\Programs
 CONST CSIDL_COMMON_STARTUP = &amp;H18          'All Users\Startup
 CONST CSIDL_COMMON_DESKTOPDIRECTORY = &amp;H19 'All Users\Startup
 CONST CSIDL_APPDATA = &amp;H1A                 '&lt;user name&gt;\Application Data
 CONST CSIDL_PRINTHOOD = &amp;H1B               '&lt;user name&gt;\PrintHood
 CONST CSIDL_LOCAL_APPDATA = &amp;H1C           '&lt;user name&gt;\Local Settings\Application Data
 CONST CSIDL_ALTSTARTUP = &amp;H1D              'non-localized startup(Vista only)
 CONST CSIDL_COMMON_ALTSTARTUP = &amp;H1E       'common startup
 CONST CSIDL_COMMON_FAVORITES = &amp;H1F        'common startup
 CONST CSIDL_INTERNET_CACHE = &amp;H20          'common startup
 CONST CSIDL_COOKIES = &amp;H21                 'common startup
 CONST CSIDL_HISTORY = &amp;H22                 'common startup
 CONST CSIDL_COMMON_APPDATA = &amp;H23          'All Users\Application Data
 CONST CSIDL_WINDOWS = &amp;H24                 'GetWindowsDirectory()
 CONST CSIDL_SYSTEM = &amp;H25                  'GetSystemDirectory()
 CONST CSIDL_PROGRAM_FILES = &amp;H26           'C:\Program Files
 CONST CSIDL_MYPICTURES = &amp;H27              '&lt;user name&gt;\My Documents\My Pictures 
 CONST CSIDL_PROFILE = &amp;H28                 'USERPROFILE
 CONST CSIDL_SYSTEMX86 = &amp;H29               'x86 C:\Windows\System32 or <a href="SysWOW64.html" title="SysWOW64">SysWOW64</a>(64 bit PC)
 CONST CSIDL_PROGRAM_FILESX86 = &amp;H2A        'x86 C:\Program Files on RISC
 CONST CSIDL_PROGRAM_FILES_COMMON = &amp;H2B    'C:\Program Files\Common
 CONST CSIDL_PROGRAM_FILES_COMMONX86 = &amp;H2C 'x86 Program Files\Common on RISC
 CONST CSIDL_COMMON_TEMPLATES = &amp;H2D        'All Users\Templates
 CONST CSIDL_COMMON_DOCUMENTS = &amp;H2E        'All Users\Documents
 CONST CSIDL_COMMON_ADMINTOOLS = &amp;H2F       'All Users\Start Menu\Programs\Administrative Tools
 CONST CSIDL_ADMINTOOLS = &amp;H30              '&lt;user name&gt;\Start Menu\Programs\Administrative Tools
 CONST CSIDL_CONNECTIONS = &amp;H31             'Network and Dial-up Connections
 CONST CSIDL_COMMON_MUSIC = &amp;H35            'All Users\My Music
 CONST CSIDL_COMMON_PICTURES = &amp;H36         'All Users\My Pictures
 CONST CSIDL_COMMON_VIDEO = &amp;H37            'All Users\My Video
 CONST CSIDL_RESOURCES = &amp;H38               'Resource Directory
 CONST CSIDL_RESOURCES_LOCALIZED = &amp;H39     'Localized Resource Directory
 CONST CSIDL_COMMON_OEM_LINKS = &amp;H3A        'Links to All Users OEM specific apps
 CONST CSIDL_CDBURN_AREA = &amp;H3B             'USERPROFILE\Local Settings\Application Data\Microsoft\CD Burning
 
                 'See: <a rel="nofollow" class="external free" href="http://msdn.microsoft.com/en-us/library/bb762181(v=vs.85)">http://msdn.microsoft.com/en-us/library/bb762181%28v=vs.85%29</a> <i> </i>
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<p><br />
</p>
<h2><span class="mw-headline" id="Windows_Version">Windows Version</span></h2>
<center><b>Note that QB64 will not run on Windows 95 to ME computers currently!</b></center>
<p style="padding: 1em; line-height:100%; margin-left:5px; white-space: pre; font-family: Courier, monospace; background-color: darkblue; color: lightgrey; word-wrap: break-word;"> <i> </i>
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">DECLARE LIBRARY</span></a>
  <a href="FUNCTION.html" title="FUNCTION"><span style="color:#87cefa;">FUNCTION</span></a> GetVersion ()
<a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY"><span style="color:#87cefa;">END DECLARE</span></a>

'Just grab the "build" number...
b$ = <a href="LTRIM%24.html" title="LTRIM$"><span style="color:#87cefa;">LTRIM$</span></a>(<a href="RTRIM%24.html" title="RTRIM$"><span style="color:#87cefa;">RTRIM$</span></a>(<a href="STR%24.html" title="STR$"><span style="color:#87cefa;">STR$</span></a>((GetVersion <a href="AND_(boolean).html" title="AND (boolean)"><span style="color:#87cefa;">AND</span></a> <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>FFFF0000) \ <a href="%26H.html" title="&amp;H"><span style="color:#87cefa;">&amp;H</span></a>10000)))


<a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "The Windows version is: ";

<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "095") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows 95"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "1111") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows 95"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "1381") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows NT"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "1998") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows 98"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "2222") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows 98 SE"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "3000") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows ME"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "2195") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows 2000"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "2600") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows XP"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "3790") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows Server 2003"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "6000") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows Vista/Server"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "6001") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows Vista/Server"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "6002") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows Vista/Server"
<a href="IF...html" title="IF...THEN"><span style="color:#87cefa;">IF</span></a> <a href="INSTR.html" title="INSTR"><span style="color:#87cefa;">INSTR</span></a>(1, b$, "7600") <a href="THEN.html" title="THEN"><span style="color:#87cefa;">THEN</span></a> <a href="PRINT.html" title="PRINT"><span style="color:#87cefa;">PRINT</span></a> "Windows 7" <i> </i>
</p>
<center><span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">Code courtesy of Dav</span></center>
<p><b>NOTE</b>: Microsoft depreciated GetVersion() for Windows 8 and higher - <a rel="nofollow" class="external free" href="https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-getversion">https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-getversion</a>
</p>
<p style="text-align: center">(<a href="#toc">Return to Table of Contents</a>)</p>
<h2><span class="mw-headline" id="Reference">Reference</span></h2>
<center> <b>Note: C++ Header files should be placed in the QB64 folder and are not required after a program is compiled.</b></center>
<p><br />
</p>
<center><b><span style="color:magenta">Your code contribution using the Windows Libraries could end up here!</span></b></center>
<p><br />
<i>See also:</i>
</p>
<ul><li><a href="WINDOWHANDLE.html" title="WINDOWHANDLE">_WINDOWHANDLE</a></li>
<li><a href="Windows_Environment.html" title="Windows Environment">Windows Environment</a></li>
<li><a href="DECLARE_LIBRARY.html" title="DECLARE LIBRARY">DECLARE LIBRARY</a>, <a href="BYVAL.html" class="mw-redirect" title="BYVAL">BYVAL</a>, <a href="ALIAS.html" class="mw-redirect" title="ALIAS">ALIAS</a></li>
<li><a href="OFFSET.html" title="OFFSET">_OFFSET</a>, <a href="OFFSET_(function).html" title="OFFSET (function)">_OFFSET (function)</a> <span style="color:gray">(lp, ptr and p names)</span></li>
<li><a href="DLL_Libraries.html" title="DLL Libraries">DLL Libraries</a>, <a href="C_Libraries.html" title="C Libraries">C Libraries</a></li>
<li><a href="Libraries.html#C.2B.2B_Variable_Types" title="Libraries">C++ Variable Types</a></li>
<li><a href="Windows_Printer_Settings.html" title="Windows Printer Settings">Windows Printer Settings</a></li></ul>
<p><br />
</p>
<hr />
<center><i>Navigation:</i>
<dl><dd><a href="Keyword_Reference_-_Alphabetical.html" title="Keyword Reference - Alphabetical">Keyword Reference - Alphabetical</a></dd>
<dd><a href="Keyword_Reference_-_By_usage.html" title="Keyword Reference - By usage">Keyword Reference - By Usage</a></dd>
<dd><a href="Main_Page.html" title="Main Page">Main Wiki Page</a></dd></dl></center>
<!-- 
NewPP limit report
Cached time: 20210707011034
Cache expiry: 86400
Dynamic content: false
Complications: []
CPU time usage: 2.177 seconds
Real time usage: 4.782 seconds
Preprocessor visited node count: 31020/1000000
Postexpand include size: 187670/2097152 bytes
Template argument size: 36006/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip postexpand size: 32/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 1262.327      1 -total
 43.06%  543.602   3044 Template:Cl
  3.12%   39.398    313 Template:Cb
  1.75%   22.040      3 Template:Text
  1.32%   16.619      3 Template:TextEnd
  0.91%   11.502     35 Template:Small
  0.81%   10.256      4 Template:TextStart
  0.34%    4.244      1 Template:PageNavigation
  0.33%    4.172      4 Template:WhiteStart
  0.28%    3.590     39 Template:CodeEnd
-->

<!-- Saved in parser cache with key i4224360_mw2-mw_:pcache:idhash:756-0!canonical and timestamp 20210707011029 and revision id 23678
 -->
</div></div><div class="printfooter">Retrieved from "<a dir="ltr" href="index0c49-2.html?title=Windows_Libraries&amp;oldid=23678">http://www.qb64.org/wiki/index.php?title=Windows_Libraries&amp;oldid=23678</a>"</div>
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-personal" class="vector-menu" aria-labelledby="p-personal-label" role="navigation" 
	 >
	<h3 id="p-personal-label">
		<span>Personal tools</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="vector-menu-content-list"><li id="pt-login"><a href="index6d59.html?title=Special:UserLogin&amp;returnto=Windows+Libraries" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li></ul>
		
	</div>
</nav>


		<div id="left-navigation">
			<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-namespaces" class="vector-menu vector-menu-tabs vectorTabs" aria-labelledby="p-namespaces-label" role="navigation" 
	 >
	<h3 id="p-namespaces-label">
		<span>Namespaces</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="vector-menu-content-list"><li id="ca-nstab-main" class="selected"><a href="Windows_Libraries.html" title="View the content page [c]" accesskey="c">Page</a></li><li id="ca-talk" class="new"><a href="Talk_Windows_Libraries.html?title=Talk:Windows_Libraries&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></li></ul>
		
	</div>
</nav>


			<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-variants" class="vector-menu-empty emptyPortlet vector-menu vector-menu-dropdown vectorMenu" aria-labelledby="p-variants-label" role="navigation" 
	 >
	<input type="checkbox" class="vector-menu-checkbox vectorMenuCheckbox" aria-labelledby="p-variants-label" />
	<h3 id="p-variants-label">
		<span>Variants</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="menu vector-menu-content-list"></ul>
		
	</div>
</nav>


		</div>
		<div id="right-navigation">
			<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-views" class="vector-menu vector-menu-tabs vectorTabs" aria-labelledby="p-views-label" role="navigation" 
	 >
	<h3 id="p-views-label">
		<span>Views</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="vector-menu-content-list"><li id="ca-view" class="collapsible selected"><a href="Windows_Libraries.html">Read</a></li><li id="ca-viewsource" class="collapsible"><a href="index3596.html?title=Windows_Libraries&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li id="ca-history" class="collapsible"><a href="index0429.html?title=Windows_Libraries&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></li></ul>
		
	</div>
</nav>


			<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-cactions" class="vector-menu-empty emptyPortlet vector-menu vector-menu-dropdown vectorMenu" aria-labelledby="p-cactions-label" role="navigation" 
	 >
	<input type="checkbox" class="vector-menu-checkbox vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
	<h3 id="p-cactions-label">
		<span>More</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="menu vector-menu-content-list"></ul>
		
	</div>
</nav>


			<div id="p-search" role="search">
	<h3 >
		<label for="searchInput">Search</label>
	</h3>
	<form action="https://www.qb64.org/wiki/index.php" id="searchform">
		<div id="simpleSearch">
			<input type="search" name="search" placeholder="Search QB64 Wiki" title="Search QB64 Wiki [f]" accesskey="f" id="searchInput"/>
			<input type="hidden" name="title" value="Special:Search">
			<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/>
			<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>
		</div>
	</form>
</div>

		</div>
	</div>
	
<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a  title="Visit the main page" class="mw-wiki-logo" href="Main_Page.html"></a>
	</div>
	<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-navigation" class="vector-menu vector-menu-portal portal portal-first" aria-labelledby="p-navigation-label" role="navigation" 
	 >
	<h3 id="p-navigation-label">
		<span>Navigation</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="vector-menu-content-list"><li id="n-mainpage-description"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main page</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="SNDCOPY.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help-mediawiki"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents">Help about MediaWiki</a></li></ul>
		
	</div>
</nav>


	<!-- Please do not use role attribute as CSS selector, it is deprecated. -->
<nav id="p-tb" class="vector-menu vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation" 
	 >
	<h3 id="p-tb-label">
		<span>Tools</span>
	</h3>
	<!-- Please do not use the .body class, it is deprecated. -->
	<div class="body vector-menu-content">
		<!-- Please do not use the .menu class, it is deprecated. -->
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Windows_Libraries.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Windows_Libraries.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="index0c49-2.html?title=Windows_Libraries&amp;oldid=23678" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="index6e99.html?title=Windows_Libraries&amp;action=info" title="More information about this page">Page information</a></li></ul>
		
	</div>
</nav>


	
</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info" >
		<li id="footer-info-lastmod"> This page was last edited on 3 April 2021, at 19:50.</li>
	</ul>
	<ul id="footer-places" >
		<li id="footer-places-privacy"><a href="My_wiki_Privacy_policy.html" title="My wiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="My_wiki_About.html" title="My wiki:About">About QB64 Wiki</a></li>
		<li id="footer-places-disclaimer"><a href="My_wiki_General_disclaimer.html" title="My wiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
	</ul>
	<div style="clear: both;"></div>
</footer>



<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"2.177","walltime":"4.782","ppvisitednodes":{"value":31020,"limit":1000000},"postexpandincludesize":{"value":187670,"limit":2097152},"templateargumentsize":{"value":36006,"limit":2097152},"expansiondepth":{"value":3,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":32,"limit":5000000},"timingprofile":["100.00% 1262.327      1 -total"," 43.06%  543.602   3044 Template:Cl","  3.12%   39.398    313 Template:Cb","  1.75%   22.040      3 Template:Text","  1.32%   16.619      3 Template:TextEnd","  0.91%   11.502     35 Template:Small","  0.81%   10.256      4 Template:TextStart","  0.34%    4.244      1 Template:PageNavigation","  0.33%    4.172      4 Template:WhiteStart","  0.28%    3.590     39 Template:CodeEnd"]},"cachereport":{"timestamp":"20210707011034","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":1205});});</script></body>
<!-- Mirrored from www.qb64.org/wiki/Windows_Libraries by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 07 Aug 2021 12:43:11 GMT -->
</html>
